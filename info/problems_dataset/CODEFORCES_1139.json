{
    "name": "1139_C. Edgy Trees",
    "source": "CODEFORCES",
    "description": "You are given a tree (a connected undirected graph without cycles) of n vertices. Each of the n - 1 edges of the tree is colored in either black or red.\n\nYou are also given an integer k. Consider sequences of k vertices. Let's call a sequence [a_1, a_2, \u2026, a_k] good if it satisfies the following criterion:\n\n  * We will walk a path (possibly visiting same edge/vertex multiple times) on the tree, starting from a_1 and ending at a_k. \n  * Start at a_1, then go to a_2 using the shortest path between a_1 and a_2, then go to a_3 in a similar way, and so on, until you travel the shortest path between a_{k-1} and a_k.\n  * If you walked over at least one black edge during this process, then the sequence is good. \n\n<image>\n\nConsider the tree on the picture. If k=3 then the following sequences are good: [1, 4, 7], [5, 5, 3] and [2, 3, 7]. The following sequences are not good: [1, 4, 6], [5, 5, 5], [3, 7, 3].\n\nThere are n^k sequences of vertices, count how many of them are good. Since this number can be quite large, print it modulo 10^9+7.\n\nInput\n\nThe first line contains two integers n and k (2 \u2264 n \u2264 10^5, 2 \u2264 k \u2264 100), the size of the tree and the length of the vertex sequence.\n\nEach of the next n - 1 lines contains three integers u_i, v_i and x_i (1 \u2264 u_i, v_i \u2264 n, x_i \u2208 \\{0, 1\\}), where u_i and v_i denote the endpoints of the corresponding edge and x_i is the color of this edge (0 denotes red edge and 1 denotes black edge).\n\nOutput\n\nPrint the number of good sequences modulo 10^9 + 7.\n\nExamples\n\nInput\n\n\n4 4\n1 2 1\n2 3 1\n3 4 1\n\n\nOutput\n\n\n252\n\nInput\n\n\n4 6\n1 2 0\n1 3 0\n1 4 0\n\n\nOutput\n\n\n0\n\nInput\n\n\n3 5\n1 2 1\n2 3 0\n\n\nOutput\n\n\n210\n\nNote\n\nIn the first example, all sequences (4^4) of length 4 except the following are good: \n\n  * [1, 1, 1, 1]\n  * [2, 2, 2, 2]\n  * [3, 3, 3, 3]\n  * [4, 4, 4, 4] \n\n\n\nIn the second example, all edges are red, hence there aren't any good sequences.",
    "difficulty": "C",
    "tags": [
        "dfs and similar",
        "dsu",
        "graphs",
        "math",
        "trees"
    ],
    "rating": 1500,
    "public_test": [
        {
            "input": "4 4\n1 2 1\n2 3 1\n3 4 1\n",
            "output": "                                                             252\n"
        },
        {
            "input": "4 6\n1 2 0\n1 3 0\n1 4 0\n",
            "output": "                                                               0\n"
        },
        {
            "input": "3 5\n1 2 1\n2 3 0\n",
            "output": "                                                             210\n"
        }
    ],
    "generated_test": [
        {
            "input": "4 25\n2 4 1\n2 3 0\n1 4 0\n",
            "output": "831852467\n"
        },
        {
            "input": "7 12\n4 5 0\n2 7 1\n7 6 1\n1 5 0\n2 3 0\n1 6 0\n",
            "output": "824505797\n"
        },
        {
            "input": "2 1\n1 2 1\n",
            "output": "0\n"
        },
        {
            "input": "4 49\n2 4 1\n2 3 0\n1 4 0\n",
            "output": "595131499\n"
        },
        {
            "input": "4 49\n2 1 1\n2 3 0\n1 4 1\n",
            "output": "544612159\n"
        },
        {
            "input": "7 12\n4 6 0\n3 7 1\n7 6 1\n2 5 0\n2 3 0\n1 6 0\n",
            "output": "840224227\n"
        },
        {
            "input": "4 49\n2 1 0\n2 3 0\n1 4 1\n",
            "output": "257391393\n"
        },
        {
            "input": "4 19\n2 4 1\n2 3 1\n1 4 0\n",
            "output": "877380736\n"
        },
        {
            "input": "4 6\n1 2 1\n1 3 0\n1 4 0\n",
            "output": "3366\n"
        },
        {
            "input": "3 5\n1 2 1\n2 3 1\n",
            "output": "240\n"
        },
        {
            "input": "4 25\n2 4 1\n2 3 0\n1 3 0\n",
            "output": "610357816\n"
        },
        {
            "input": "3 5\n1 2 0\n2 3 1\n",
            "output": "210\n"
        },
        {
            "input": "7 12\n4 5 0\n2 1 1\n7 6 1\n1 5 1\n2 3 0\n1 6 0\n",
            "output": "841274821\n"
        },
        {
            "input": "7 13\n4 6 0\n5 7 1\n7 6 1\n2 5 0\n2 3 0\n1 6 0\n",
            "output": "885821088\n"
        },
        {
            "input": "3 10\n1 2 0\n2 3 1\n",
            "output": "58024\n"
        },
        {
            "input": "7 20\n4 5 0\n2 7 1\n7 6 1\n2 5 0\n2 3 0\n1 6 0\n",
            "output": "226397486\n"
        },
        {
            "input": "19 20\n8 10 1\n17 15 1\n14 5 0\n6 14 0\n7 15 1\n19 8 1\n12 14 0\n2 18 0\n13 3 0\n17 1 1\n4 2 1\n11 3 0\n4 6 0\n6 9 0\n7 11 1\n16 4 1\n5 13 1\n16 19 0\n",
            "output": "929091185\n"
        },
        {
            "input": "2 4\n1 2 1\n2 3 1\n3 4 1\n",
            "output": "14\n"
        },
        {
            "input": "3 4\n1 2 1\n2 3 0\n",
            "output": "64\n"
        },
        {
            "input": "7 12\n4 5 0\n2 7 1\n7 6 1\n1 5 0\n2 3 1\n1 6 0\n",
            "output": "824509891\n"
        },
        {
            "input": "4 6\n1 2 1\n2 3 0\n1 4 0\n",
            "output": "3968\n"
        },
        {
            "input": "7 12\n4 5 0\n2 1 1\n7 6 0\n1 5 1\n2 3 0\n1 6 0\n",
            "output": "840747477\n"
        },
        {
            "input": "2 5\n1 2 1\n2 3 1\n3 4 1\n",
            "output": "30\n"
        },
        {
            "input": "7 12\n4 6 1\n2 7 1\n7 6 1\n2 5 0\n2 3 0\n1 6 0\n",
            "output": "840751571\n"
        },
        {
            "input": "4 20\n2 4 1\n4 3 1\n1 4 0\n",
            "output": "510571505\n"
        },
        {
            "input": "4 5\n1 2 1\n2 3 0\n1 4 0\n",
            "output": "960\n"
        },
        {
            "input": "7 20\n4 2 0\n2 7 1\n7 6 1\n2 5 1\n2 3 0\n1 6 0\n",
            "output": "251233188\n"
        },
        {
            "input": "4 5\n1 2 1\n2 3 0\n1 4 1\n",
            "output": "990\n"
        },
        {
            "input": "7 20\n4 2 0\n2 7 1\n7 6 1\n2 5 1\n2 3 1\n1 6 0\n",
            "output": "736968991\n"
        },
        {
            "input": "4 36\n2 4 1\n2 3 0\n1 4 0\n",
            "output": "641112499\n"
        },
        {
            "input": "13 3\n9 13 1\n4 3 1\n11 9 0\n8 13 0\n10 9 0\n2 7 0\n4 8 1\n11 5 0\n10 12 0\n12 1 1\n5 7 0\n6 8 1\n",
            "output": "1842\n"
        },
        {
            "input": "3 8\n1 2 1\n2 3 0\n",
            "output": "6304\n"
        },
        {
            "input": "4 42\n2 4 1\n2 3 0\n1 4 0\n",
            "output": "853297555\n"
        },
        {
            "input": "4 67\n2 4 1\n2 3 0\n1 4 0\n",
            "output": "578961544\n"
        },
        {
            "input": "7 19\n4 6 0\n3 7 1\n7 6 1\n2 5 0\n2 3 0\n1 6 0\n",
            "output": "781057964\n"
        },
        {
            "input": "3 10\n1 2 1\n2 3 1\n",
            "output": "59046\n"
        },
        {
            "input": "3 2\n1 2 0\n1 3 1\n",
            "output": "4\n"
        },
        {
            "input": "19 20\n8 10 1\n17 15 1\n14 5 0\n6 14 0\n7 15 1\n19 8 1\n12 14 0\n2 18 0\n13 3 0\n17 1 1\n4 2 1\n11 3 0\n4 6 0\n6 9 0\n7 11 1\n16 4 0\n5 13 1\n16 19 0\n",
            "output": "808213127\n"
        },
        {
            "input": "7 12\n4 6 1\n2 7 1\n7 6 1\n2 5 0\n2 3 1\n1 6 0\n",
            "output": "841278915\n"
        },
        {
            "input": "4 20\n2 4 1\n4 3 1\n1 4 1\n",
            "output": "511620079\n"
        },
        {
            "input": "4 5\n1 2 0\n2 3 0\n1 4 1\n",
            "output": "780\n"
        },
        {
            "input": "7 20\n4 2 1\n2 7 1\n7 6 1\n2 5 1\n2 3 1\n1 6 0\n",
            "output": "738017565\n"
        },
        {
            "input": "7 34\n4 2 0\n4 7 0\n7 6 1\n2 5 1\n2 3 1\n1 6 0\n",
            "output": "262911102\n"
        },
        {
            "input": "3 15\n1 2 1\n2 3 0\n",
            "output": "14316138\n"
        },
        {
            "input": "4 42\n2 4 1\n2 3 0\n1 3 0\n",
            "output": "366817536\n"
        },
        {
            "input": "7 12\n4 5 0\n2 1 1\n7 6 1\n1 5 0\n2 3 1\n1 6 1\n",
            "output": "840755665\n"
        },
        {
            "input": "7 26\n7 2 0\n4 7 0\n3 6 1\n2 5 1\n2 3 1\n1 6 0\n",
            "output": "459482703\n"
        },
        {
            "input": "3 5\n1 2 0\n2 3 0\n",
            "output": "0\n"
        },
        {
            "input": "7 12\n4 6 0\n2 7 1\n7 6 1\n1 5 0\n2 3 0\n1 6 0\n",
            "output": "824505797\n"
        },
        {
            "input": "4 49\n2 1 1\n2 3 0\n1 4 0\n",
            "output": "595131499\n"
        },
        {
            "input": "7 12\n4 6 0\n3 7 1\n7 6 1\n1 5 0\n2 3 0\n1 6 0\n",
            "output": "824505797\n"
        },
        {
            "input": "2 1\n1 2 0\n",
            "output": "0\n"
        },
        {
            "input": "7 12\n4 5 0\n2 1 1\n7 6 1\n1 5 0\n2 3 0\n1 6 0\n",
            "output": "824505797\n"
        },
        {
            "input": "7 12\n4 6 0\n5 7 1\n7 6 1\n2 5 0\n2 3 0\n1 6 0\n",
            "output": "840224227\n"
        },
        {
            "input": "7 13\n4 6 0\n5 7 1\n7 6 1\n2 5 0\n2 3 0\n1 4 0\n",
            "output": "885821088\n"
        },
        {
            "input": "3 10\n1 2 0\n1 3 1\n",
            "output": "58024\n"
        },
        {
            "input": "2 39\n2 1 0\n",
            "output": "0\n"
        },
        {
            "input": "7 12\n4 6 0\n2 7 1\n7 6 1\n2 5 0\n2 3 0\n1 6 0\n",
            "output": "840224227\n"
        },
        {
            "input": "4 19\n2 4 1\n4 3 1\n1 4 0\n",
            "output": "877380736\n"
        },
        {
            "input": "7 12\n4 6 0\n5 7 1\n7 1 1\n2 5 0\n2 3 0\n1 6 0\n",
            "output": "840224227\n"
        },
        {
            "input": "7 13\n4 6 0\n5 4 1\n7 6 1\n2 5 0\n2 3 0\n1 4 0\n",
            "output": "885821088\n"
        },
        {
            "input": "7 20\n4 2 0\n2 7 1\n7 6 1\n2 5 0\n2 3 0\n1 6 0\n",
            "output": "226397486\n"
        },
        {
            "input": "2 5\n1 2 1\n2 3 1\n3 1 1\n",
            "output": "30\n"
        },
        {
            "input": "7 12\n4 6 1\n2 7 1\n7 4 1\n2 5 0\n2 3 0\n1 6 0\n",
            "output": "840751571\n"
        },
        {
            "input": "7 12\n4 6 1\n2 7 0\n7 4 1\n2 5 0\n2 3 0\n1 6 0\n",
            "output": "824505797\n"
        },
        {
            "input": "7 20\n4 2 0\n4 7 1\n7 6 1\n2 5 1\n2 3 1\n1 6 0\n",
            "output": "736968991\n"
        },
        {
            "input": "7 20\n4 2 0\n4 7 0\n7 6 1\n2 5 1\n2 3 1\n1 6 0\n",
            "output": "251233188\n"
        },
        {
            "input": "7 20\n4 2 0\n4 7 0\n3 6 1\n2 5 1\n2 3 1\n1 6 0\n",
            "output": "251233188\n"
        },
        {
            "input": "3 10\n1 2 0\n2 3 0\n",
            "output": "0\n"
        },
        {
            "input": "4 49\n2 1 0\n2 3 0\n1 4 0\n",
            "output": "0\n"
        },
        {
            "input": "4 25\n3 4 1\n2 3 0\n1 3 0\n",
            "output": "610357816\n"
        },
        {
            "input": "7 12\n4 5 0\n2 1 1\n7 6 1\n1 5 0\n2 3 0\n1 6 1\n",
            "output": "840751571\n"
        },
        {
            "input": "7 12\n4 5 0\n2 7 1\n7 6 1\n1 5 0\n2 3 1\n1 2 0\n",
            "output": "824509891\n"
        },
        {
            "input": "7 12\n4 6 0\n2 7 1\n7 6 1\n2 5 1\n2 3 0\n1 6 0\n",
            "output": "840751571\n"
        },
        {
            "input": "7 20\n4 2 0\n2 7 1\n7 6 1\n3 5 0\n2 3 0\n1 6 0\n",
            "output": "226397486\n"
        },
        {
            "input": "2 5\n1 2 1\n2 0 1\n3 1 1\n",
            "output": "30\n"
        },
        {
            "input": "7 12\n4 6 1\n2 7 1\n7 4 1\n2 5 1\n2 3 0\n1 6 0\n",
            "output": "841278915\n"
        },
        {
            "input": "7 12\n4 6 1\n2 7 0\n7 6 1\n2 5 0\n2 3 0\n1 6 0\n",
            "output": "824505797\n"
        },
        {
            "input": "7 20\n4 2 0\n4 7 1\n7 6 1\n2 5 1\n2 3 1\n1 7 0\n",
            "output": "736968991\n"
        },
        {
            "input": "7 20\n7 2 0\n4 7 0\n3 6 1\n2 5 1\n2 3 1\n1 6 0\n",
            "output": "251233188\n"
        },
        {
            "input": "19 20\n8 10 1\n17 15 1\n14 5 0\n6 14 0\n7 15 1\n19 8 1\n12 14 0\n2 18 0\n13 3 0\n17 1 1\n4 2 1\n11 3 0\n4 6 0\n6 9 0\n7 11 1\n16 4 0\n5 13 1\n9 19 0\n",
            "output": "808213127\n"
        },
        {
            "input": "7 12\n4 6 1\n2 7 1\n7 6 1\n2 5 0\n2 3 1\n1 2 0\n",
            "output": "840755665\n"
        },
        {
            "input": "2 5\n1 2 1\n2 0 1\n3 2 1\n",
            "output": "30\n"
        },
        {
            "input": "7 12\n4 3 1\n2 7 1\n7 6 1\n2 5 0\n2 3 0\n1 6 0\n",
            "output": "840751571\n"
        },
        {
            "input": "2 5\n1 2 1\n1 0 1\n3 2 1\n",
            "output": "30\n"
        }
    ]
}