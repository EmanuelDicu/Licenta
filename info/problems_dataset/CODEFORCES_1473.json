{
    "name": "1473_G. Tiles",
    "source": "CODEFORCES",
    "description": "Consider a road consisting of several rows. Each row is divided into several rectangular tiles, and all tiles in the same row are equal. The first row contains exactly one rectangular tile. Look at the picture below which shows how the tiles are arranged.\n\nThe road is constructed as follows: \n\n  * the first row consists of 1 tile; \n  * then a_1 rows follow; each of these rows contains 1 tile greater than the previous row; \n  * then b_1 rows follow; each of these rows contains 1 tile less than the previous row; \n  * then a_2 rows follow; each of these rows contains 1 tile greater than the previous row; \n  * then b_2 rows follow; each of these rows contains 1 tile less than the previous row; \n  * ... \n  * then a_n rows follow; each of these rows contains 1 tile greater than the previous row; \n  * then b_n rows follow; each of these rows contains 1 tile less than the previous row. \n\n<image> An example of the road with n = 2, a_1 = 4, b_1 = 2, a_2 = 2, b_2 = 3. Rows are arranged from left to right. \n\nYou start from the only tile in the first row and want to reach the last row (any tile of it). From your current tile, you can move to any tile in the next row which touches your current tile.\n\nCalculate the number of different paths from the first row to the last row. Since it can be large, print it modulo 998244353.\n\nInput\n\nThe first line contains one integer n (1 \u2264 n \u2264 1000).\n\nThen n lines follow. The i-th of them contains two integers a_i and b_i (1 \u2264 a_i, b_i \u2264 10^5; |a_i - b_i| \u2264 5).\n\nAdditional constraint on the input: the sequence of a_i and b_i never results in a row with non-positive number of tiles.\n\nOutput\n\nPrint one integer \u2014 the number of paths from the first row to the last row, taken modulo 998244353.\n\nExamples\n\nInput\n\n\n2\n4 2\n2 3\n\n\nOutput\n\n\n850\n\n\nInput\n\n\n3\n4 1\n2 3\n3 1\n\n\nOutput\n\n\n10150\n\n\nInput\n\n\n8\n328 323\n867 868\n715 718\n721 722\n439 435\n868 870\n834 834\n797 796\n\n\nOutput\n\n\n759099319",
    "difficulty": "G",
    "tags": [
        "combinatorics",
        "dp",
        "fft",
        "math"
    ],
    "rating": 2800,
    "public_test": [
        {
            "input": "2\n4 2\n2 3\n",
            "output": "\n850\n"
        },
        {
            "input": "8\n328 323\n867 868\n715 718\n721 722\n439 435\n868 870\n834 834\n797 796\n",
            "output": "\n759099319\n"
        },
        {
            "input": "3\n4 1\n2 3\n3 1\n",
            "output": "\n10150\n"
        }
    ],
    "generated_test": [
        {
            "input": "2\n4 2\n2 2\n",
            "output": "610\n"
        },
        {
            "input": "3\n4 1\n2 3\n6 1\n",
            "output": "84070\n"
        },
        {
            "input": "3\n4 1\n2 3\n6 2\n",
            "output": "164770\n"
        },
        {
            "input": "3\n4 1\n2 4\n6 1\n",
            "output": "115570\n"
        },
        {
            "input": "3\n4 1\n2 3\n5 1\n",
            "output": "41830\n"
        },
        {
            "input": "2\n4 2\n4 2\n",
            "output": "2950\n"
        },
        {
            "input": "3\n4 1\n1 3\n6 1\n",
            "output": "31750\n"
        },
        {
            "input": "3\n4 1\n2 3\n1 2\n",
            "output": "3140\n"
        },
        {
            "input": "3\n4 1\n2 4\n6 2\n",
            "output": "223860\n"
        },
        {
            "input": "3\n4 1\n0 3\n5 1\n",
            "output": "4340\n"
        },
        {
            "input": "2\n5 2\n4 2\n",
            "output": "6804\n"
        },
        {
            "input": "3\n4 1\n1 3\n10 1\n",
            "output": "511750\n"
        },
        {
            "input": "3\n3 1\n2 3\n1 2\n",
            "output": "720\n"
        },
        {
            "input": "3\n4 1\n2 4\n1 2\n",
            "output": "2730\n"
        },
        {
            "input": "2\n5 2\n8 2\n",
            "output": "114156\n"
        },
        {
            "input": "3\n4 2\n1 3\n10 1\n",
            "output": "491040\n"
        },
        {
            "input": "2\n5 3\n8 2\n",
            "output": "184996\n"
        },
        {
            "input": "3\n4 1\n2 4\n1 0\n",
            "output": "1820\n"
        },
        {
            "input": "2\n4 2\n0 2\n",
            "output": "70\n"
        },
        {
            "input": "2\n4 2\n-1 2\n",
            "output": "0\n"
        },
        {
            "input": "3\n4 1\n3 3\n6 2\n",
            "output": "387660\n"
        },
        {
            "input": "3\n4 1\n2 4\n6 0\n",
            "output": "58240\n"
        },
        {
            "input": "3\n4 1\n2 3\n8 1\n",
            "output": "337510\n"
        },
        {
            "input": "3\n4 1\n1 3\n6 0\n",
            "output": "16000\n"
        },
        {
            "input": "3\n4 0\n2 3\n1 2\n",
            "output": "2436\n"
        },
        {
            "input": "3\n4 1\n1 3\n11 1\n",
            "output": "1023750\n"
        },
        {
            "input": "2\n5 2\n8 4\n",
            "output": "439712\n"
        },
        {
            "input": "3\n4 0\n2 4\n1 1\n",
            "output": "2268\n"
        },
        {
            "input": "2\n5 3\n12 2\n",
            "output": "2980068\n"
        },
        {
            "input": "3\n4 1\n3 4\n1 1\n",
            "output": "8260\n"
        },
        {
            "input": "3\n2 1\n2 3\n8 1\n",
            "output": "30600\n"
        },
        {
            "input": "3\n4 0\n2 3\n1 4\n",
            "output": "3360\n"
        },
        {
            "input": "2\n5 2\n8 6\n",
            "output": "1548820\n"
        },
        {
            "input": "3\n4 1\n3 5\n1 1\n",
            "output": "10080\n"
        },
        {
            "input": "3\n2 1\n3 3\n8 1\n",
            "output": "107310\n"
        },
        {
            "input": "2\n5 3\n8 6\n",
            "output": "2334332\n"
        },
        {
            "input": "3\n4 2\n3 5\n1 1\n",
            "output": "6160\n"
        },
        {
            "input": "3\n2 1\n3 3\n8 0\n",
            "output": "53760\n"
        },
        {
            "input": "3\n4 2\n3 5\n2 1\n",
            "output": "18480\n"
        },
        {
            "input": "2\n4 2\n2 4\n",
            "output": "850\n"
        },
        {
            "input": "2\n4 2\n1 2\n",
            "output": "240\n"
        },
        {
            "input": "3\n4 1\n1 3\n6 2\n",
            "output": "61500\n"
        },
        {
            "input": "3\n5 1\n2 4\n6 2\n",
            "output": "622472\n"
        },
        {
            "input": "3\n4 2\n2 3\n5 1\n",
            "output": "53550\n"
        },
        {
            "input": "3\n4 2\n1 3\n6 1\n",
            "output": "30240\n"
        },
        {
            "input": "3\n4 1\n2 3\n0 2\n",
            "output": "910\n"
        },
        {
            "input": "3\n4 1\n4 4\n6 2\n",
            "output": "1464420\n"
        },
        {
            "input": "2\n5 3\n4 2\n",
            "output": "10724\n"
        },
        {
            "input": "3\n4 1\n1 3\n10 2\n",
            "output": "1020500\n"
        },
        {
            "input": "3\n3 1\n2 3\n1 0\n",
            "output": "480\n"
        },
        {
            "input": "3\n4 1\n2 4\n2 2\n",
            "output": "9100\n"
        },
        {
            "input": "2\n5 3\n8 1\n",
            "output": "93072\n"
        },
        {
            "input": "3\n2 1\n3 3\n6 2\n",
            "output": "51660\n"
        },
        {
            "input": "3\n4 2\n2 4\n6 0\n",
            "output": "54400\n"
        },
        {
            "input": "3\n4 1\n2 3\n8 2\n",
            "output": "670830\n"
        },
        {
            "input": "3\n4 2\n1 3\n11 1\n",
            "output": "982560\n"
        },
        {
            "input": "2\n2 2\n8 4\n",
            "output": "20988\n"
        },
        {
            "input": "2\n5 2\n12 2\n",
            "output": "1834308\n"
        },
        {
            "input": "2\n4 3\n1 2\n",
            "output": "210\n"
        },
        {
            "input": "3\n4 0\n2 5\n6 0\n",
            "output": "59136\n"
        },
        {
            "input": "2\n5 2\n8 3\n",
            "output": "225652\n"
        },
        {
            "input": "3\n1 1\n3 3\n8 1\n",
            "output": "20400\n"
        },
        {
            "input": "3\n4 2\n3 4\n2 1\n",
            "output": "21560\n"
        },
        {
            "input": "3\n2 1\n3 3\n6 0\n",
            "output": "13440\n"
        },
        {
            "input": "3\n6 2\n3 5\n2 1\n",
            "output": "258720\n"
        },
        {
            "input": "2\n4 1\n1 2\n",
            "output": "180\n"
        },
        {
            "input": "3\n4 1\n1 2\n6 1\n",
            "output": "22930\n"
        },
        {
            "input": "3\n5 1\n2 4\n4 2\n",
            "output": "146768\n"
        },
        {
            "input": "3\n4 2\n2 3\n5 0\n",
            "output": "27200\n"
        },
        {
            "input": "3\n4 1\n4 7\n6 2\n",
            "output": "2984520\n"
        },
        {
            "input": "2\n5 3\n6 2\n",
            "output": "45444\n"
        },
        {
            "input": "3\n4 1\n2 3\n10 2\n",
            "output": "2697530\n"
        },
        {
            "input": "3\n2 1\n3 1\n6 2\n",
            "output": "22710\n"
        },
        {
            "input": "3\n4 1\n2 2\n8 2\n",
            "output": "417830\n"
        },
        {
            "input": "3\n4 2\n1 3\n6 0\n",
            "output": "15360\n"
        },
        {
            "input": "2\n2 2\n8 5\n",
            "output": "36036\n"
        },
        {
            "input": "3\n4 0\n1 5\n6 0\n",
            "output": "16128\n"
        },
        {
            "input": "3\n4 0\n4 3\n0 4\n",
            "output": "12870\n"
        },
        {
            "input": "3\n1 1\n3 3\n6 0\n",
            "output": "2560\n"
        },
        {
            "input": "2\n4 1\n2 2\n",
            "output": "410\n"
        },
        {
            "input": "3\n7 1\n4 7\n6 2\n",
            "output": "84334624\n"
        },
        {
            "input": "2\n5 2\n6 2\n",
            "output": "28224\n"
        },
        {
            "input": "3\n5 1\n2 3\n10 2\n",
            "output": "6429540\n"
        },
        {
            "input": "3\n4 2\n1 3\n8 0\n",
            "output": "61440\n"
        },
        {
            "input": "2\n4 3\n1 0\n",
            "output": "140\n"
        },
        {
            "input": "3\n4 2\n2 4\n4 0\n",
            "output": "13600\n"
        },
        {
            "input": "3\n7 1\n4 8\n6 2\n",
            "output": "129752128\n"
        },
        {
            "input": "2\n4 2\n6 2\n",
            "output": "12490\n"
        },
        {
            "input": "3\n7 0\n4 8\n6 2\n",
            "output": "84450288\n"
        },
        {
            "input": "2\n4 2\n6 3\n",
            "output": "23790\n"
        },
        {
            "input": "3\n7 0\n4 8\n12 2\n",
            "output": "510039299\n"
        },
        {
            "input": "2\n4 1\n6 3\n",
            "output": "14680\n"
        },
        {
            "input": "2\n4 1\n6 4\n",
            "output": "27610\n"
        },
        {
            "input": "2\n4 0\n6 4\n",
            "output": "15444\n"
        },
        {
            "input": "3\n4 2\n2 3\n3 1\n",
            "output": "12750\n"
        },
        {
            "input": "3\n4 1\n2 5\n6 1\n",
            "output": "114660\n"
        },
        {
            "input": "3\n2 1\n2 3\n6 2\n",
            "output": "14280\n"
        },
        {
            "input": "2\n4 1\n4 2\n",
            "output": "1830\n"
        },
        {
            "input": "3\n4 1\n0 3\n6 1\n",
            "output": "8820\n"
        },
        {
            "input": "3\n4 1\n3 4\n6 1\n",
            "output": "312060\n"
        },
        {
            "input": "3\n4 1\n1 4\n1 1\n",
            "output": "500\n"
        },
        {
            "input": "2\n5 5\n8 1\n",
            "output": "128520\n"
        },
        {
            "input": "2\n3 0\n0 2\n",
            "output": "20\n"
        },
        {
            "input": "3\n4 1\n2 4\n10 0\n",
            "output": "931840\n"
        },
        {
            "input": "3\n4 1\n1 3\n11 2\n",
            "output": "2044250\n"
        },
        {
            "input": "3\n4 2\n2 4\n1 1\n",
            "output": "1700\n"
        },
        {
            "input": "2\n5 3\n12 3\n",
            "output": "5947872\n"
        },
        {
            "input": "3\n4 1\n3 4\n2 1\n",
            "output": "18060\n"
        },
        {
            "input": "2\n8 2\n8 6\n",
            "output": "15493794\n"
        },
        {
            "input": "2\n4 3\n8 6\n",
            "output": "800800\n"
        },
        {
            "input": "3\n4 2\n4 5\n1 1\n",
            "output": "34020\n"
        },
        {
            "input": "3\n5 2\n3 5\n2 1\n",
            "output": "86436\n"
        },
        {
            "input": "3\n4 1\n0 3\n6 2\n",
            "output": "16660\n"
        },
        {
            "input": "3\n5 1\n2 5\n6 2\n",
            "output": "840336\n"
        },
        {
            "input": "3\n3 2\n2 3\n5 1\n",
            "output": "12400\n"
        },
        {
            "input": "3\n1 1\n4 4\n6 2\n",
            "output": "33320\n"
        },
        {
            "input": "3\n4 1\n1 3\n10 3\n",
            "output": "2021500\n"
        },
        {
            "input": "3\n2 1\n3 3\n11 2\n",
            "output": "1717170\n"
        },
        {
            "input": "3\n4 1\n2 4\n8 2\n",
            "output": "920920\n"
        },
        {
            "input": "2\n5 2\n11 2\n",
            "output": "916846\n"
        },
        {
            "input": "2\n5 1\n8 3\n",
            "output": "125772\n"
        },
        {
            "input": "3\n1 1\n4 3\n8 1\n",
            "output": "71540\n"
        },
        {
            "input": "3\n4 2\n3 4\n2 0\n",
            "output": "12320\n"
        },
        {
            "input": "3\n6 2\n3 5\n4 1\n",
            "output": "1102080\n"
        },
        {
            "input": "2\n4 1\n1 4\n",
            "output": "250\n"
        },
        {
            "input": "3\n4 1\n1 2\n12 1\n",
            "output": "1474450\n"
        },
        {
            "input": "3\n5 0\n2 4\n4 2\n",
            "output": "95832\n"
        },
        {
            "input": "2\n5 3\n6 4\n",
            "output": "157584\n"
        },
        {
            "input": "3\n2 1\n3 2\n6 2\n",
            "output": "37470\n"
        },
        {
            "input": "3\n4 1\n2 2\n8 4\n",
            "output": "1608360\n"
        },
        {
            "input": "3\n4 0\n4 3\n1 4\n",
            "output": "35640\n"
        },
        {
            "input": "2\n1 1\n2 2\n",
            "output": "12\n"
        },
        {
            "input": "3\n7 1\n4 7\n10 2\n",
            "output": "373637983\n"
        },
        {
            "input": "2\n5 2\n6 3\n",
            "output": "54642\n"
        },
        {
            "input": "3\n5 1\n0 3\n10 2\n",
            "output": "1028664\n"
        },
        {
            "input": "2\n3 3\n1 0\n",
            "output": "40\n"
        },
        {
            "input": "2\n4 0\n6 3\n",
            "output": "8008\n"
        },
        {
            "input": "2\n4 4\n2 2\n",
            "output": "420\n"
        },
        {
            "input": "3\n7 0\n4 8\n11 2\n",
            "output": "753066882\n"
        },
        {
            "input": "2\n4 1\n6 6\n",
            "output": "84370\n"
        },
        {
            "input": "2\n4 1\n5 4\n",
            "output": "12930\n"
        },
        {
            "input": "3\n4 2\n3 3\n3 1\n",
            "output": "34300\n"
        },
        {
            "input": "3\n4 1\n4 5\n6 1\n",
            "output": "1169220\n"
        },
        {
            "input": "3\n5 1\n0 3\n6 1\n",
            "output": "32004\n"
        },
        {
            "input": "3\n4 1\n2 4\n10 1\n",
            "output": "1862770\n"
        },
        {
            "input": "3\n4 1\n1 2\n11 2\n",
            "output": "1472880\n"
        },
        {
            "input": "2\n8 2\n9 6\n",
            "output": "31612872\n"
        },
        {
            "input": "3\n4 1\n4 5\n1 1\n",
            "output": "30900\n"
        },
        {
            "input": "3\n5 1\n3 5\n2 1\n",
            "output": "68964\n"
        },
        {
            "input": "2\n6 2\n2 4\n",
            "output": "9324\n"
        },
        {
            "input": "3\n5 1\n2 5\n6 1\n",
            "output": "433832\n"
        },
        {
            "input": "3\n3 2\n2 3\n6 1\n",
            "output": "25200\n"
        },
        {
            "input": "3\n4 0\n2 3\n0 2\n",
            "output": "924\n"
        },
        {
            "input": "3\n4 0\n1 3\n10 3\n",
            "output": "1478568\n"
        },
        {
            "input": "2\n5 1\n11 3\n",
            "output": "1014046\n"
        },
        {
            "input": "3\n6 2\n1 5\n4 1\n",
            "output": "102480\n"
        },
        {
            "input": "3\n2 1\n3 2\n6 4\n",
            "output": "130050\n"
        },
        {
            "input": "3\n6 1\n4 7\n10 2\n",
            "output": "554490552\n"
        },
        {
            "input": "2\n5 2\n9 3\n",
            "output": "454454\n"
        },
        {
            "input": "3\n5 1\n0 3\n10 1\n",
            "output": "515844\n"
        },
        {
            "input": "2\n3 3\n2 0\n",
            "output": "80\n"
        },
        {
            "input": "2\n1 1\n6 6\n",
            "output": "1848\n"
        },
        {
            "input": "2\n4 2\n3 4\n",
            "output": "3080\n"
        },
        {
            "input": "3\n4 1\n4 5\n3 1\n",
            "output": "141060\n"
        },
        {
            "input": "3\n4 1\n2 4\n8 1\n",
            "output": "465010\n"
        },
        {
            "input": "2\n2 2\n9 6\n",
            "output": "137280\n"
        },
        {
            "input": "2\n6 4\n2 4\n",
            "output": "11340\n"
        },
        {
            "input": "3\n3 2\n2 3\n6 0\n",
            "output": "12800\n"
        },
        {
            "input": "2\n1 1\n11 3\n",
            "output": "32344\n"
        },
        {
            "input": "3\n6 2\n1 5\n4 2\n",
            "output": "170800\n"
        },
        {
            "input": "2\n4 0\n2 4\n",
            "output": "672\n"
        },
        {
            "input": "3\n2 1\n2 2\n6 4\n",
            "output": "47520\n"
        },
        {
            "input": "2\n1 1\n9 6\n",
            "output": "45760\n"
        },
        {
            "input": "3\n4 1\n2 3\n2 1\n",
            "output": "4870\n"
        },
        {
            "input": "2\n6 3\n2 4\n",
            "output": "12348\n"
        },
        {
            "input": "3\n3 2\n2 3\n1 0\n",
            "output": "400\n"
        },
        {
            "input": "3\n2 1\n2 3\n6 4\n",
            "output": "40320\n"
        },
        {
            "input": "2\n1 1\n9 3\n",
            "output": "7876\n"
        },
        {
            "input": "3\n2 1\n2 0\n6 4\n",
            "output": "22308\n"
        },
        {
            "input": "3\n4 1\n2 3\n1 1\n",
            "output": "2230\n"
        },
        {
            "input": "2\n10 5\n2 4\n",
            "output": "1273272\n"
        },
        {
            "input": "3\n2 1\n2 0\n12 4\n",
            "output": "1565904\n"
        },
        {
            "input": "3\n4 2\n2 3\n1 1\n",
            "output": "2550\n"
        },
        {
            "input": "3\n2 1\n2 0\n9 4\n",
            "output": "192426\n"
        },
        {
            "input": "3\n4 2\n2 3\n2 1\n",
            "output": "5950\n"
        },
        {
            "input": "3\n2 1\n4 0\n9 4\n",
            "output": "780504\n"
        },
        {
            "input": "3\n4 2\n2 4\n2 1\n",
            "output": "5100\n"
        },
        {
            "input": "3\n2 1\n2 3\n3 1\n",
            "output": "840\n"
        },
        {
            "input": "2\n4 2\n2 1\n",
            "output": "370\n"
        },
        {
            "input": "3\n4 1\n2 3\n9 2\n",
            "output": "1346260\n"
        },
        {
            "input": "3\n4 1\n3 4\n4 1\n",
            "output": "76860\n"
        },
        {
            "input": "2\n4 2\n3 2\n",
            "output": "1380\n"
        },
        {
            "input": "3\n4 1\n1 3\n9 0\n",
            "output": "128000\n"
        },
        {
            "input": "3\n4 1\n0 3\n5 0\n",
            "output": "2240\n"
        },
        {
            "input": "2\n5 2\n4 3\n",
            "output": "12488\n"
        },
        {
            "input": "3\n3 1\n2 3\n2 2\n",
            "output": "2400\n"
        },
        {
            "input": "3\n4 1\n3 4\n1 2\n",
            "output": "11620\n"
        },
        {
            "input": "3\n6 2\n1 3\n10 1\n",
            "output": "5102048\n"
        },
        {
            "input": "2\n5 2\n0 2\n",
            "output": "252\n"
        },
        {
            "input": "3\n4 1\n2 4\n4 0\n",
            "output": "14560\n"
        }
    ]
}