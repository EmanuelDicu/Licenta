{
    "name": "1569_F. Palindromic Hamiltonian Path",
    "source": "CODEFORCES",
    "description": "You are given a simple undirected graph with n vertices, n is even. You are going to write a letter on each vertex. Each letter should be one of the first k letters of the Latin alphabet.\n\nA path in the graph is called Hamiltonian if it visits each vertex exactly once. A string is called palindromic if it reads the same from left to right and from right to left. A path in the graph is called palindromic if the letters on the vertices in it spell a palindromic string without changing the order.\n\nA string of length n is good if: \n\n  * each letter is one of the first k lowercase Latin letters; \n  * if you write the i-th letter of the string on the i-th vertex of the graph, there will exist a palindromic Hamiltonian path in the graph. \n\n\n\nNote that the path doesn't necesserily go through the vertices in order 1, 2, ..., n.\n\nCount the number of good strings.\n\nInput\n\nThe first line contains three integers n, m and k (2 \u2264 n \u2264 12; n is even; 0 \u2264 m \u2264 (n \u22c5 (n-1))/(2); 1 \u2264 k \u2264 12) \u2014 the number of vertices in the graph, the number of edges in the graph and the number of first letters of the Latin alphabet that can be used.\n\nEach of the next m lines contains two integers v and u (1 \u2264 v, u \u2264 n; v \u2260 u) \u2014 the edges of the graph. The graph doesn't contain multiple edges and self-loops.\n\nOutput\n\nPrint a single integer \u2014 number of good strings.\n\nExamples\n\nInput\n\n\n4 3 3\n1 2\n2 3\n3 4\n\n\nOutput\n\n\n9\n\n\nInput\n\n\n4 6 3\n1 2\n1 3\n1 4\n2 3\n2 4\n3 4\n\n\nOutput\n\n\n21\n\n\nInput\n\n\n12 19 12\n1 3\n2 6\n3 6\n3 7\n4 8\n8 5\n8 7\n9 4\n5 9\n10 1\n10 4\n10 6\n9 10\n11 1\n5 11\n7 11\n12 2\n12 5\n12 11\n\n\nOutput\n\n\n456165084",
    "difficulty": "F",
    "tags": [
        "brute force",
        "dfs and similar",
        "dp",
        "graphs",
        "hashing"
    ],
    "rating": 3000,
    "public_test": [
        {
            "input": "4 6 3\n1 2\n1 3\n1 4\n2 3\n2 4\n3 4\n",
            "output": "21\n"
        },
        {
            "input": "4 3 3\n1 2\n2 3\n3 4\n",
            "output": "9\n"
        },
        {
            "input": "12 19 12\n1 3\n2 6\n3 6\n3 7\n4 8\n8 5\n8 7\n9 4\n5 9\n10 1\n10 4\n10 6\n9 10\n11 1\n5 11\n7 11\n12 2\n12 5\n12 11\n",
            "output": "                                                       456165084"
        }
    ],
    "generated_test": [
        {
            "input": "8 6 3\n5 1\n5 4\n6 7\n4 3\n5 5\n3 2\n",
            "output": "0\n"
        },
        {
            "input": "8 26 3\n6 4\n2 8\n8 4\n4 4\n5 6\n5 2\n1 7\n8 1\n3 7\n4 1\n6 1\n5 4\n7 2\n4 7\n6 2\n7 8\n2 1\n5 3\n6 3\n1 3\n5 7\n7 6\n8 5\n2 3\n8 6\n4 2\n",
            "output": "1641\n"
        },
        {
            "input": "12 45 12\n1 2\n7 5\n5 4\n4 9\n1 12\n2 11\n6 11\n12 8\n10 5\n7 6\n6 3\n11 7\n9 8\n2 6\n12 5\n2 8\n4 3\n1 10\n7 3\n12 11\n3 10\n8 5\n9 6\n1 4\n10 12\n12 7\n1 7\n1 5\n5 3\n8 4\n11 1\n3 12\n10 11\n1 3\n10 4\n12 4\n10 2\n3 11\n6 12\n9 2\n2 5\n3 2\n6 1\n8 7\n8 1\n",
            "output": "12600272928\n"
        },
        {
            "input": "12 50 2\n3 7\n12 11\n12 1\n1 6\n10 5\n5 9\n4 11\n5 7\n3 1\n9 4\n6 9\n5 12\n8 4\n1 11\n12 6\n9 2\n6 2\n5 2\n4 7\n4 10\n11 9\n10 11\n7 12\n4 5\n9 10\n9 8\n11 7\n12 8\n2 8\n7 9\n8 1\n12 4\n2 11\n11 3\n6 7\n8 10\n2 7\n1 9\n3 4\n1 5\n10 2\n3 8\n6 3\n2 12\n10 1\n10 7\n8 6\n5 1\n2 4\n9 12\n",
            "output": "2048\n"
        },
        {
            "input": "6 10 2\n4 1\n4 5\n2 4\n2 1\n6 3\n2 3\n5 1\n5 2\n6 1\n6 2\n",
            "output": "32\n"
        },
        {
            "input": "8 28 12\n3 7\n3 8\n3 2\n2 6\n1 3\n7 6\n7 1\n2 8\n8 5\n5 3\n5 1\n4 1\n4 3\n8 4\n6 3\n2 1\n7 8\n6 5\n7 5\n2 4\n1 8\n4 7\n6 8\n2 4\n2 7\n5 2\n4 6\n1 6\n",
            "output": "1532928\n"
        },
        {
            "input": "12 63 12\n9 10\n3 12\n8 4\n5 2\n12 9\n8 3\n9 11\n11 3\n11 5\n1 10\n6 8\n12 4\n5 4\n6 4\n6 3\n1 8\n3 2\n8 2\n7 6\n9 1\n4 7\n1 6\n6 9\n10 3\n11 10\n5 8\n12 10\n9 8\n12 2\n5 1\n10 6\n8 7\n9 3\n7 10\n11 12\n1 2\n2 11\n2 6\n2 4\n9 5\n10 5\n2 4\n1 3\n12 6\n12 8\n7 11\n12 5\n2 7\n11 4\n2 10\n1 7\n7 3\n5 3\n9 7\n12 7\n1 4\n4 3\n4 10\n8 10\n12 1\n9 4\n8 11\n11 6\n",
            "output": "12665422848\n"
        },
        {
            "input": "12 49 12\n3 1\n2 3\n4 1\n2 4\n5 3\n4 5\n1 6\n6 4\n6 5\n7 1\n7 2\n3 7\n4 7\n7 5\n7 6\n2 8\n3 8\n5 8\n8 6\n1 9\n3 9\n4 9\n9 5\n9 6\n8 9\n1 10\n10 2\n10 3\n10 5\n6 10\n7 10\n10 8\n10 9\n11 1\n4 11\n3 11\n11 4\n5 11\n6 11\n9 11\n12 1\n2 12\n12 4\n5 12\n6 12\n7 12\n12 8\n9 12\n12 11\n",
            "output": "12662096448\n"
        },
        {
            "input": "6 14 4\n5 2\n6 5\n1 2\n4 1\n5 4\n4 3\n2 4\n1 5\n5 3\n1 6\n6 1\n1 3\n6 4\n3 2\n",
            "output": "544\n"
        },
        {
            "input": "10 36 2\n1 9\n3 5\n7 1\n10 1\n9 5\n10 2\n8 7\n9 3\n7 6\n10 4\n9 6\n8 4\n5 8\n2 8\n3 6\n1 5\n8 6\n6 2\n7 3\n2 4\n7 5\n1 2\n1 3\n10 5\n9 8\n5 6\n2 7\n4 9\n8 7\n8 10\n1 6\n7 10\n6 4\n1 4\n2 9\n7 9\n",
            "output": "512\n"
        },
        {
            "input": "12 59 5\n1 10\n9 4\n9 8\n9 1\n4 2\n8 10\n8 6\n3 8\n3 6\n10 6\n5 1\n9 3\n10 7\n4 1\n8 4\n6 11\n8 7\n4 11\n1 8\n8 5\n5 10\n9 6\n4 6\n1 2\n5 11\n9 11\n7 11\n7 12\n11 8\n5 3\n11 3\n12 4\n1 11\n11 12\n7 5\n1 6\n6 5\n2 7\n9 5\n12 8\n4 3\n4 5\n7 2\n12 6\n10 4\n9 7\n12 2\n2 9\n3 10\n6 7\n7 4\n12 1\n2 3\n12 3\n2 10\n2 5\n9 12\n10 9\n6 2\n",
            "output": "15424865\n"
        },
        {
            "input": "8 7 12\n4 1\n4 3\n2 5\n1 6\n7 2\n7 3\n8 6\n",
            "output": "20736\n"
        },
        {
            "input": "12 47 12\n1 10\n5 3\n3 6\n1 12\n5 11\n1 3\n9 12\n12 7\n12 3\n1 8\n9 7\n10 6\n10 12\n5 1\n8 6\n3 9\n5 9\n12 6\n11 8\n3 10\n7 1\n11 6\n8 7\n1 9\n8 6\n7 11\n9 10\n7 2\n9 11\n11 3\n11 1\n12 5\n6 7\n3 7\n8 3\n5 6\n1 6\n7 10\n9 8\n12 11\n6 9\n10 5\n4 1\n8 12\n10 8\n10 11\n7 5\n",
            "output": "220741632\n"
        },
        {
            "input": "12 35 12\n2 9\n2 10\n2 11\n3 12\n8 10\n5 4\n2 4\n8 3\n11 10\n10 5\n11 5\n4 8\n4 3\n6 11\n11 9\n10 3\n9 8\n9 3\n7 10\n2 8\n3 10\n7 3\n6 7\n2 5\n10 4\n8 11\n9 7\n4 11\n2 7\n9 10\n6 10\n3 11\n10 1\n2 3\n5 3\n",
            "output": "138246912\n"
        },
        {
            "input": "12 34 12\n3 2\n2 4\n5 3\n5 3\n4 5\n6 2\n3 6\n5 6\n7 1\n4 7\n5 7\n8 1\n8 4\n8 5\n9 1\n2 9\n4 9\n9 5\n2 10\n3 10\n4 10\n10 6\n10 7\n10 8\n11 3\n6 11\n11 7\n8 11\n9 11\n12 1\n4 12\n6 12\n10 12\n12 11\n",
            "output": "9935910876\n"
        },
        {
            "input": "12 40 12\n3 2\n4 1\n4 2\n3 4\n5 1\n3 5\n6 1\n3 6\n6 4\n7 3\n4 7\n5 7\n6 7\n8 3\n3 8\n4 8\n8 5\n8 7\n1 9\n9 2\n5 9\n7 9\n9 8\n1 10\n10 4\n7 10\n10 9\n11 1\n11 2\n6 11\n11 7\n11 8\n9 11\n10 11\n1 12\n3 12\n5 12\n12 6\n12 8\n12 10\n",
            "output": "12438633648\n"
        },
        {
            "input": "12 35 12\n7 4\n8 11\n8 4\n8 6\n5 12\n9 10\n5 10\n2 8\n8 7\n8 9\n7 5\n5 8\n11 1\n3 7\n3 11\n3 5\n9 7\n10 8\n3 6\n7 10\n1 8\n11 4\n3 1\n6 10\n10 11\n10 1\n11 9\n9 7\n5 4\n8 3\n6 11\n6 5\n6 4\n5 1\n9 3\n",
            "output": "187287552\n"
        },
        {
            "input": "12 39 12\n6 11\n10 6\n3 5\n4 11\n8 10\n7 9\n10 2\n7 11\n9 4\n7 4\n9 10\n8 12\n10 11\n5 12\n11 9\n2 1\n6 9\n3 4\n3 1\n2 11\n4 1\n7 5\n8 2\n12 4\n11 5\n6 4\n1 7\n5 9\n9 1\n6 1\n3 9\n2 12\n1 10\n4 2\n3 2\n6 5\n6 12\n8 5\n6 8\n",
            "output": "12334160928\n"
        },
        {
            "input": "12 26 12\n1 2\n1 8\n3 4\n5 1\n6 3\n6 5\n3 7\n5 7\n8 2\n8 4\n9 2\n3 9\n9 6\n9 7\n10 4\n5 10\n10 8\n10 9\n3 11\n11 5\n7 11\n10 11\n1 12\n12 2\n12 6\n12 8\n",
            "output": "3850238448\n"
        },
        {
            "input": "12 38 12\n2 1\n3 2\n4 2\n5 2\n5 3\n6 1\n2 6\n6 3\n6 4\n6 5\n1 7\n3 7\n1 8\n3 8\n4 8\n8 6\n7 8\n3 9\n9 4\n9 5\n7 9\n1 10\n4 10\n5 10\n10 7\n9 10\n11 1\n11 2\n2 4\n11 7\n9 11\n11 10\n12 2\n12 4\n5 12\n7 12\n8 12\n10 12\n",
            "output": "12309866328\n"
        },
        {
            "input": "12 20 12\n3 2\n4 3\n4 5\n6 2\n6 5\n1 7\n8 1\n8 6\n9 1\n3 9\n2 4\n5 10\n9 10\n11 4\n11 6\n11 7\n8 11\n1 12\n12 8\n10 12\n",
            "output": "543168264\n"
        },
        {
            "input": "12 37 12\n1 2\n3 1\n4 1\n2 4\n3 4\n5 3\n6 1\n6 2\n6 3\n6 5\n1 7\n7 4\n7 5\n2 8\n3 8\n8 6\n1 9\n3 9\n7 9\n8 9\n1 10\n10 2\n4 10\n5 10\n10 7\n9 10\n3 11\n11 4\n5 11\n8 11\n1 11\n12 3\n12 4\n5 12\n7 12\n12 10\n12 11\n",
            "output": "12000796248\n"
        },
        {
            "input": "12 34 12\n1 3\n3 2\n1 5\n4 2\n2 5\n4 5\n6 1\n6 3\n6 5\n1 7\n7 2\n7 5\n1 8\n8 2\n3 8\n8 4\n8 5\n7 8\n9 2\n9 4\n9 6\n10 1\n10 4\n6 10\n7 10\n11 2\n11 3\n5 11\n9 11\n12 3\n6 12\n7 12\n12 9\n11 12\n",
            "output": "11098251528\n"
        },
        {
            "input": "12 21 12\n4 3\n5 2\n5 3\n5 6\n1 7\n6 7\n5 8\n6 8\n7 8\n4 9\n1 10\n10 2\n10 4\n9 10\n11 1\n11 8\n11 9\n12 2\n12 3\n12 5\n6 12\n",
            "output": "841149552\n"
        },
        {
            "input": "12 42 12\n2 1\n1 3\n2 4\n4 3\n5 1\n3 5\n1 6\n6 2\n6 3\n5 6\n2 11\n7 3\n4 7\n7 6\n8 4\n5 8\n7 8\n2 9\n5 9\n6 9\n9 7\n9 8\n10 1\n10 2\n3 10\n4 10\n10 5\n10 7\n10 8\n11 2\n11 4\n5 11\n6 11\n11 9\n12 1\n12 2\n5 12\n6 12\n12 7\n12 8\n10 12\n12 11\n",
            "output": "12601734168\n"
        },
        {
            "input": "12 33 12\n4 1\n2 4\n4 3\n1 5\n5 3\n4 5\n1 6\n5 6\n7 1\n3 7\n7 4\n8 4\n6 8\n7 8\n9 1\n2 9\n9 3\n9 5\n10 1\n10 2\n8 10\n11 1\n2 11\n11 5\n6 11\n7 11\n9 11\n11 10\n12 2\n12 3\n12 4\n12 6\n12 10\n",
            "output": "10425535968\n"
        },
        {
            "input": "12 34 12\n1 3\n2 3\n1 4\n3 4\n5 3\n5 4\n6 2\n3 6\n7 5\n7 6\n3 8\n4 8\n7 8\n1 9\n9 4\n9 5\n6 9\n7 9\n9 8\n4 10\n10 6\n7 10\n8 10\n11 1\n11 2\n11 5\n11 6\n11 8\n12 1\n9 2\n12 7\n12 8\n12 9\n10 12\n",
            "output": "10589548608\n"
        },
        {
            "input": "12 34 12\n2 1\n3 1\n3 2\n4 1\n4 2\n5 4\n6 1\n6 4\n6 5\n7 2\n3 7\n1 8\n2 8\n8 4\n8 5\n1 9\n4 9\n9 6\n7 9\n3 10\n10 6\n7 10\n8 10\n10 9\n5 11\n6 11\n11 8\n2 12\n3 12\n12 5\n12 7\n12 9\n12 10\n12 11\n",
            "output": "10847414568\n"
        },
        {
            "input": "4 6 3\n1 2\n1 3\n1 4\n2 3\n1 4\n3 4\n",
            "output": "21\n"
        },
        {
            "input": "6 10 2\n4 1\n4 5\n2 4\n2 1\n6 3\n2 3\n5 1\n5 4\n6 1\n6 2\n",
            "output": "28\n"
        },
        {
            "input": "12 49 12\n3 1\n2 3\n4 1\n2 4\n5 3\n4 5\n1 6\n6 4\n6 5\n7 1\n7 2\n3 7\n4 7\n7 5\n7 6\n2 8\n3 8\n5 8\n8 6\n1 9\n3 9\n4 9\n9 5\n9 6\n8 9\n1 10\n10 2\n10 4\n10 5\n6 10\n7 10\n10 8\n10 9\n11 1\n4 11\n3 11\n11 4\n5 11\n6 11\n9 11\n12 1\n2 12\n12 4\n5 12\n6 12\n7 12\n12 8\n9 12\n12 11\n",
            "output": "12662761728\n"
        },
        {
            "input": "12 50 12\n2 1\n3 1\n3 2\n4 1\n4 2\n1 5\n5 3\n1 6\n2 6\n6 3\n6 5\n2 7\n3 7\n7 4\n7 5\n1 8\n2 8\n5 8\n8 6\n7 8\n9 1\n2 9\n3 9\n4 9\n9 5\n9 7\n3 9\n1 10\n2 10\n10 3\n4 10\n5 10\n7 10\n10 8\n10 9\n11 1\n2 11\n11 3\n11 4\n11 6\n9 11\n10 11\n1 12\n12 2\n12 4\n12 5\n6 12\n7 12\n12 10\n11 12\n",
            "output": "12664757568\n"
        },
        {
            "input": "12 48 12\n4 1\n4 3\n1 5\n5 3\n4 5\n6 1\n2 6\n6 3\n6 4\n5 6\n7 1\n7 2\n3 7\n7 4\n6 7\n1 8\n8 2\n4 8\n8 5\n8 6\n1 9\n9 2\n4 9\n9 6\n9 8\n10 1\n2 10\n3 10\n4 10\n10 5\n10 7\n10 8\n1 11\n11 3\n11 4\n11 9\n7 11\n11 9\n10 11\n12 2\n12 3\n4 12\n12 5\n12 6\n6 12\n12 8\n9 12\n11 12\n",
            "output": "12660100608\n"
        },
        {
            "input": "12 40 12\n3 2\n4 1\n4 2\n3 4\n5 1\n3 5\n6 1\n3 6\n6 4\n7 3\n4 7\n5 7\n6 7\n8 3\n3 8\n4 8\n8 5\n8 7\n1 9\n9 2\n5 9\n7 9\n9 8\n1 10\n10 4\n7 10\n10 9\n11 1\n11 2\n6 11\n11 7\n11 8\n9 11\n10 11\n1 3\n3 12\n5 12\n12 6\n12 8\n12 10\n",
            "output": "12370904448\n"
        },
        {
            "input": "12 35 12\n7 4\n8 11\n8 4\n8 6\n5 12\n9 10\n5 10\n2 8\n8 7\n8 9\n7 5\n5 8\n11 1\n3 7\n3 11\n3 5\n9 7\n10 8\n3 6\n6 10\n1 8\n11 4\n3 1\n6 10\n10 11\n10 1\n11 9\n9 7\n5 4\n8 3\n6 11\n6 5\n6 4\n5 1\n9 3\n",
            "output": "168279552\n"
        },
        {
            "input": "12 26 12\n1 2\n1 8\n3 4\n5 1\n2 3\n6 5\n3 7\n5 7\n8 2\n8 4\n9 2\n3 9\n9 6\n9 7\n10 4\n5 10\n10 8\n10 9\n3 11\n11 5\n7 11\n10 11\n1 12\n12 2\n12 6\n12 8\n",
            "output": "3576773916\n"
        },
        {
            "input": "12 38 12\n2 1\n3 2\n4 2\n5 2\n5 3\n6 1\n2 6\n6 3\n6 4\n6 5\n1 7\n3 10\n1 8\n3 8\n4 8\n8 6\n7 8\n3 9\n9 4\n9 5\n7 9\n1 10\n4 10\n5 10\n10 7\n9 10\n11 1\n11 2\n2 4\n11 7\n9 11\n11 10\n12 2\n12 4\n5 12\n7 12\n8 12\n10 12\n",
            "output": "12224128368\n"
        },
        {
            "input": "12 37 12\n1 2\n3 1\n4 1\n2 4\n3 4\n5 3\n6 1\n6 2\n6 3\n6 5\n1 7\n7 4\n7 5\n2 8\n3 8\n8 6\n1 9\n3 9\n7 9\n8 9\n1 10\n10 2\n4 10\n5 10\n10 7\n9 10\n3 11\n11 4\n5 11\n8 11\n1 10\n12 3\n12 4\n5 12\n7 12\n12 10\n12 11\n",
            "output": "11720689608\n"
        },
        {
            "input": "12 42 12\n2 1\n1 3\n2 4\n4 3\n5 1\n3 5\n1 6\n6 2\n6 3\n5 6\n2 11\n7 3\n4 7\n7 6\n8 4\n5 8\n7 8\n2 9\n5 9\n6 9\n9 7\n9 8\n10 1\n10 2\n3 10\n4 10\n10 5\n10 7\n10 8\n11 2\n11 4\n5 11\n6 11\n11 9\n12 1\n12 2\n5 12\n7 12\n12 7\n12 8\n10 12\n12 11\n",
            "output": "12563623128\n"
        },
        {
            "input": "12 34 12\n2 1\n3 1\n3 2\n4 1\n4 2\n5 4\n6 1\n6 4\n6 5\n7 2\n3 7\n1 8\n2 8\n8 4\n8 5\n1 9\n4 9\n9 6\n7 9\n3 10\n10 6\n7 10\n8 10\n10 9\n5 3\n6 11\n11 8\n2 12\n3 12\n12 5\n12 7\n12 9\n12 10\n12 11\n",
            "output": "10413745596\n"
        },
        {
            "input": "6 10 2\n4 1\n4 5\n2 4\n2 1\n6 4\n2 3\n5 1\n5 4\n6 1\n6 2\n",
            "output": "24\n"
        },
        {
            "input": "12 40 12\n3 2\n4 1\n4 2\n3 4\n5 1\n3 5\n6 1\n3 5\n6 4\n7 3\n4 7\n5 7\n6 7\n8 3\n3 8\n4 8\n8 5\n8 7\n1 9\n9 2\n5 9\n7 9\n9 8\n1 10\n10 4\n7 10\n10 9\n11 1\n11 2\n6 11\n11 7\n11 8\n9 11\n10 11\n1 3\n3 12\n5 12\n12 6\n12 8\n12 10\n",
            "output": "12171187128\n"
        },
        {
            "input": "12 35 12\n7 4\n8 11\n8 4\n8 6\n5 12\n9 10\n5 10\n2 8\n8 7\n8 9\n7 5\n5 8\n11 1\n6 7\n3 11\n3 5\n9 7\n10 8\n3 6\n6 10\n1 8\n11 4\n3 1\n6 10\n10 11\n10 1\n11 9\n9 7\n5 4\n8 3\n6 11\n6 5\n6 4\n5 1\n9 3\n",
            "output": "163907712\n"
        },
        {
            "input": "12 26 12\n1 2\n1 8\n2 4\n5 1\n2 3\n6 5\n3 7\n5 7\n8 2\n8 4\n9 2\n3 9\n9 6\n9 7\n10 4\n5 10\n10 8\n10 9\n3 11\n11 5\n7 11\n10 11\n1 12\n12 2\n12 6\n12 8\n",
            "output": "3353633196\n"
        },
        {
            "input": "12 38 12\n2 1\n3 2\n4 2\n5 2\n5 3\n6 1\n2 6\n6 3\n6 4\n6 5\n1 7\n3 10\n1 8\n3 8\n4 8\n2 6\n7 8\n3 9\n9 4\n9 5\n7 9\n1 10\n4 10\n5 10\n10 7\n9 10\n11 1\n11 2\n2 4\n11 7\n9 11\n11 10\n12 2\n12 4\n5 12\n7 12\n8 12\n10 12\n",
            "output": "11880688128\n"
        },
        {
            "input": "12 37 12\n1 2\n3 1\n4 1\n2 4\n3 4\n5 3\n6 1\n6 2\n6 3\n6 5\n1 7\n7 4\n7 5\n2 8\n3 8\n8 6\n1 9\n3 9\n7 9\n8 10\n1 10\n10 2\n4 10\n5 10\n10 7\n9 10\n3 11\n11 4\n5 11\n8 11\n1 10\n12 3\n12 4\n5 12\n7 12\n12 10\n12 11\n",
            "output": "11380897848\n"
        },
        {
            "input": "12 34 12\n2 1\n3 1\n3 2\n4 1\n4 2\n5 4\n6 1\n6 4\n6 5\n7 2\n3 7\n1 8\n2 8\n8 4\n8 5\n1 9\n4 9\n9 6\n7 9\n3 10\n10 6\n7 10\n8 10\n10 9\n5 3\n6 11\n11 8\n2 12\n3 12\n12 5\n12 7\n12 9\n12 10\n4 11\n",
            "output": "10355631408\n"
        },
        {
            "input": "12 49 12\n3 1\n2 3\n4 1\n3 4\n5 3\n4 5\n1 6\n6 4\n6 5\n7 1\n7 2\n3 7\n4 7\n7 5\n7 6\n2 8\n3 8\n5 8\n8 6\n1 9\n4 9\n4 9\n9 5\n9 6\n8 9\n1 10\n10 2\n10 4\n10 5\n6 10\n7 10\n10 8\n10 9\n11 1\n4 11\n3 11\n11 4\n5 11\n6 11\n9 11\n12 1\n2 12\n12 4\n5 12\n6 12\n7 12\n12 8\n9 12\n12 11\n",
            "output": "12657914688\n"
        },
        {
            "input": "12 48 12\n4 1\n4 3\n1 5\n5 3\n4 5\n6 1\n2 6\n6 3\n6 4\n5 6\n7 1\n7 2\n3 7\n7 4\n6 7\n1 8\n8 2\n4 8\n8 5\n8 6\n1 9\n9 2\n4 9\n9 6\n9 8\n10 1\n2 10\n3 10\n4 10\n10 5\n10 7\n10 8\n1 11\n11 1\n11 5\n11 9\n7 11\n11 9\n10 11\n12 2\n12 3\n4 12\n12 5\n12 6\n6 12\n12 8\n9 12\n11 12\n",
            "output": "12659435328\n"
        },
        {
            "input": "12 35 7\n2 9\n2 10\n2 11\n3 12\n2 10\n5 4\n2 4\n8 3\n11 10\n10 5\n11 5\n4 8\n4 3\n6 11\n11 9\n10 3\n9 8\n9 3\n7 10\n2 8\n3 9\n7 3\n6 7\n2 5\n10 4\n8 11\n9 7\n4 11\n2 7\n9 10\n6 10\n3 11\n10 1\n2 3\n5 3\n",
            "output": "4513537\n"
        },
        {
            "input": "12 26 12\n1 2\n1 8\n2 4\n5 1\n2 3\n6 5\n3 7\n5 7\n8 2\n8 4\n9 2\n3 9\n9 11\n9 7\n10 4\n5 10\n10 8\n10 9\n3 11\n11 5\n7 11\n10 11\n1 12\n12 2\n12 6\n12 8\n",
            "output": "2520531828\n"
        },
        {
            "input": "12 37 12\n1 2\n3 1\n4 1\n2 4\n3 4\n5 3\n6 1\n6 2\n6 3\n6 5\n1 7\n7 4\n7 5\n2 8\n3 8\n8 6\n1 9\n3 9\n7 9\n8 10\n1 10\n10 2\n4 10\n5 10\n10 7\n9 10\n3 11\n11 4\n5 11\n8 11\n1 10\n12 3\n12 4\n4 12\n7 12\n12 10\n12 11\n",
            "output": "10707396888\n"
        },
        {
            "input": "12 34 12\n2 1\n3 1\n3 2\n4 1\n4 2\n5 4\n6 1\n6 4\n6 5\n7 2\n3 7\n1 8\n2 8\n8 4\n8 5\n1 9\n4 9\n9 6\n7 9\n3 10\n10 6\n7 10\n8 10\n10 9\n5 3\n6 11\n11 8\n2 12\n3 12\n12 5\n12 11\n12 9\n12 10\n4 11\n",
            "output": "10857387168\n"
        },
        {
            "input": "12 30 2\n6 4\n1 2\n5 2\n2 9\n5 3\n8 11\n10 3\n3 1\n12 2\n8 9\n5 3\n1 12\n10 4\n1 9\n8 2\n2 6\n8 11\n5 6\n7 2\n1 4\n10 3\n6 1\n11 4\n9 12\n1 11\n1 7\n7 9\n3 12\n4 2\n5 4\n",
            "output": "2038\n"
        },
        {
            "input": "12 49 12\n3 1\n2 3\n4 1\n3 4\n5 3\n4 5\n1 6\n6 4\n6 10\n7 1\n7 2\n3 7\n4 7\n7 5\n7 6\n2 8\n3 8\n5 8\n8 6\n1 9\n4 9\n4 9\n9 5\n9 6\n8 9\n1 10\n10 2\n10 4\n10 5\n6 10\n7 10\n10 8\n10 9\n11 1\n4 11\n3 11\n11 4\n5 11\n6 11\n9 11\n12 1\n2 12\n12 4\n5 12\n6 12\n7 12\n12 8\n9 12\n12 11\n",
            "output": "12655253568\n"
        },
        {
            "input": "12 35 7\n2 9\n2 10\n2 11\n3 12\n2 10\n5 4\n2 4\n8 3\n11 10\n10 5\n11 5\n4 8\n4 3\n6 11\n11 9\n10 3\n9 8\n9 3\n7 10\n2 8\n3 9\n7 3\n6 7\n2 5\n10 4\n8 11\n9 7\n4 11\n2 9\n9 10\n6 10\n3 11\n10 1\n2 3\n5 3\n",
            "output": "3778831\n"
        },
        {
            "input": "12 26 12\n1 2\n1 8\n2 4\n5 1\n2 3\n6 5\n3 7\n5 8\n8 2\n8 4\n9 2\n3 9\n9 11\n9 7\n10 4\n5 10\n10 8\n10 9\n3 11\n11 5\n7 11\n10 11\n1 12\n12 2\n12 6\n12 8\n",
            "output": "2046033804\n"
        },
        {
            "input": "12 37 12\n1 2\n3 1\n4 1\n2 4\n3 4\n5 3\n6 1\n6 2\n6 3\n6 5\n1 7\n7 4\n7 5\n2 8\n3 8\n8 6\n1 9\n3 9\n7 9\n8 10\n1 10\n3 2\n4 10\n5 10\n10 7\n9 10\n3 11\n11 4\n5 11\n8 11\n1 10\n12 3\n12 4\n4 12\n7 12\n12 10\n12 11\n",
            "output": "10460979288\n"
        },
        {
            "input": "12 49 12\n3 1\n2 3\n4 1\n3 4\n5 3\n4 5\n1 6\n6 4\n6 10\n7 1\n7 2\n3 7\n4 7\n7 5\n7 6\n2 8\n3 8\n5 8\n8 6\n1 9\n4 9\n4 9\n9 5\n12 6\n8 9\n1 10\n10 2\n10 4\n10 5\n6 10\n7 10\n10 8\n10 9\n11 1\n4 11\n3 11\n11 4\n5 11\n6 11\n9 11\n12 1\n2 12\n12 4\n5 12\n6 12\n7 12\n12 8\n9 12\n12 11\n",
            "output": "12654588288\n"
        },
        {
            "input": "12 35 7\n2 9\n2 10\n2 11\n3 12\n2 10\n5 4\n2 4\n8 3\n11 10\n10 5\n11 5\n4 8\n4 3\n6 11\n11 9\n10 3\n9 8\n9 3\n7 10\n2 8\n3 9\n7 3\n6 7\n2 5\n10 4\n8 11\n9 7\n4 7\n2 9\n9 10\n6 10\n3 11\n10 1\n2 3\n5 3\n",
            "output": "4511479\n"
        },
        {
            "input": "12 26 12\n1 2\n1 8\n2 4\n5 1\n1 3\n6 5\n3 7\n5 8\n8 2\n8 4\n9 2\n3 9\n9 11\n9 7\n10 4\n5 10\n10 8\n10 9\n3 11\n11 5\n7 11\n10 11\n1 12\n12 2\n12 6\n12 8\n",
            "output": "2584436988\n"
        },
        {
            "input": "12 37 12\n1 2\n3 1\n4 1\n2 4\n3 4\n5 3\n6 1\n6 2\n6 3\n7 5\n1 7\n7 4\n7 5\n2 8\n3 8\n8 6\n1 9\n3 9\n7 9\n8 10\n1 10\n3 2\n4 10\n5 10\n10 7\n9 10\n3 11\n11 4\n5 11\n8 11\n1 10\n12 3\n12 4\n4 12\n7 12\n12 10\n12 11\n",
            "output": "8972926128\n"
        },
        {
            "input": "12 49 12\n3 1\n2 3\n4 1\n3 4\n5 3\n4 5\n1 6\n6 4\n6 10\n7 1\n7 2\n3 7\n4 7\n7 5\n7 6\n2 8\n3 8\n5 8\n8 6\n1 9\n4 9\n4 9\n9 5\n12 6\n8 9\n1 10\n10 2\n10 4\n10 5\n6 10\n7 10\n10 8\n10 9\n11 1\n4 11\n3 11\n11 4\n5 11\n6 11\n9 11\n12 1\n2 12\n12 8\n5 12\n6 12\n7 12\n12 8\n9 12\n12 11\n",
            "output": "12647935488\n"
        },
        {
            "input": "12 26 12\n1 2\n1 8\n2 4\n5 1\n1 3\n6 5\n3 7\n5 8\n8 2\n8 4\n9 2\n3 9\n9 11\n9 7\n10 4\n5 10\n10 8\n10 9\n2 11\n11 5\n7 11\n10 11\n1 12\n12 2\n12 6\n12 8\n",
            "output": "2523859416\n"
        },
        {
            "input": "12 37 12\n1 2\n3 1\n4 1\n2 4\n3 4\n5 3\n12 1\n6 2\n6 3\n7 5\n1 7\n7 4\n7 5\n2 8\n3 8\n8 6\n1 9\n3 9\n7 9\n8 10\n1 10\n3 2\n4 10\n5 10\n10 7\n9 10\n3 11\n11 4\n5 11\n8 11\n1 10\n12 3\n12 4\n4 12\n7 12\n12 10\n12 11\n",
            "output": "8485060728\n"
        },
        {
            "input": "12 49 12\n3 1\n2 3\n4 1\n3 7\n5 3\n4 5\n1 6\n6 4\n6 10\n7 1\n7 2\n3 7\n4 7\n7 5\n7 6\n2 8\n3 8\n5 8\n8 6\n1 9\n4 9\n4 9\n9 5\n12 6\n8 9\n1 10\n10 2\n10 4\n10 5\n6 10\n7 10\n10 8\n10 9\n11 1\n4 11\n3 11\n11 4\n5 11\n6 11\n9 11\n12 1\n2 12\n12 8\n5 12\n6 12\n7 12\n12 8\n9 12\n12 11\n",
            "output": "12634915008\n"
        },
        {
            "input": "12 35 7\n2 9\n2 10\n2 11\n3 12\n2 5\n5 4\n2 4\n8 3\n11 10\n10 5\n11 5\n4 8\n4 3\n6 11\n11 9\n10 3\n9 8\n9 3\n7 10\n2 8\n3 9\n7 3\n6 7\n2 5\n10 4\n8 11\n5 7\n4 7\n2 9\n9 10\n6 10\n3 11\n10 1\n2 3\n5 3\n",
            "output": "4287157\n"
        },
        {
            "input": "12 49 12\n3 1\n2 3\n4 1\n3 7\n5 3\n4 5\n1 6\n6 4\n6 10\n7 1\n7 2\n3 7\n4 7\n7 5\n7 6\n2 8\n3 8\n5 8\n8 6\n1 9\n4 9\n4 9\n9 5\n12 6\n8 9\n1 10\n10 2\n10 4\n10 5\n6 10\n7 10\n10 8\n10 9\n11 1\n4 11\n3 11\n11 4\n5 11\n6 11\n9 5\n12 1\n2 12\n12 8\n5 12\n6 12\n7 12\n12 8\n9 12\n12 11\n",
            "output": "12621799488\n"
        },
        {
            "input": "12 35 7\n2 9\n2 10\n2 11\n3 12\n2 5\n5 4\n2 4\n8 3\n11 10\n10 5\n11 5\n4 8\n4 3\n6 11\n11 9\n10 3\n9 8\n9 3\n7 10\n4 8\n3 9\n7 3\n6 7\n2 5\n10 4\n8 11\n5 7\n4 7\n2 9\n9 10\n6 10\n3 11\n10 1\n2 3\n5 3\n",
            "output": "3317839\n"
        },
        {
            "input": "12 49 12\n3 1\n2 3\n4 1\n3 7\n5 3\n4 5\n1 6\n6 4\n6 10\n7 1\n7 2\n3 7\n4 7\n7 5\n7 6\n2 8\n3 8\n5 8\n8 6\n1 9\n4 9\n4 9\n9 5\n12 6\n8 9\n1 10\n10 2\n10 4\n10 5\n6 10\n7 10\n10 8\n10 9\n11 1\n4 11\n1 11\n11 4\n5 11\n6 11\n9 5\n12 1\n2 12\n12 8\n5 12\n6 12\n7 12\n12 1\n9 12\n12 11\n",
            "output": "12547086168\n"
        },
        {
            "input": "12 49 12\n3 1\n2 3\n4 1\n3 7\n5 3\n4 5\n1 6\n6 4\n6 10\n7 1\n7 2\n3 7\n4 7\n7 5\n7 6\n4 8\n3 8\n5 8\n8 6\n1 9\n4 9\n4 9\n9 5\n12 6\n8 9\n1 10\n10 2\n10 4\n10 5\n6 10\n7 10\n10 8\n10 9\n11 1\n4 11\n1 11\n11 4\n5 11\n6 11\n9 5\n12 1\n2 12\n12 8\n5 12\n6 12\n7 12\n12 1\n9 12\n12 11\n",
            "output": "12429901848\n"
        },
        {
            "input": "10 45 12\n3 4\n3 2\n10 6\n1 9\n9 5\n1 5\n3 6\n4 10\n2 7\n7 9\n2 2\n8 7\n1 10\n8 1\n3 1\n3 8\n10 2\n4 7\n10 5\n6 1\n2 4\n3 5\n6 8\n6 5\n6 4\n4 8\n2 1\n4 1\n5 7\n5 4\n6 2\n7 1\n9 3\n7 6\n2 5\n9 6\n7 3\n9 2\n9 8\n7 10\n4 9\n10 9\n8 10\n8 5\n10 3\n",
            "output": "130179072\n"
        },
        {
            "input": "6 5 6\n2 6\n2 1\n4 5\n3 1\n5 3\n",
            "output": "216\n"
        },
        {
            "input": "8 9 3\n2 3\n5 1\n6 1\n8 4\n4 7\n2 7\n5 8\n4 6\n2 1\n",
            "output": "153\n"
        },
        {
            "input": "10 28 3\n6 2\n7 6\n10 2\n3 9\n7 1\n8 2\n6 9\n5 1\n4 9\n2 7\n3 10\n10 9\n7 9\n5 10\n4 3\n8 3\n1 9\n9 5\n2 4\n8 10\n7 8\n7 5\n10 4\n6 4\n1 4\n4 7\n2 9\n2 1\n",
            "output": "14751\n"
        },
        {
            "input": "6 9 4\n2 6\n3 6\n3 4\n1 3\n5 3\n4 5\n1 4\n1 4\n3 2\n",
            "output": "196\n"
        },
        {
            "input": "6 13 3\n3 2\n6 1\n5 3\n4 3\n1 2\n1 4\n3 2\n5 6\n3 6\n5 4\n1 3\n4 6\n1 5\n",
            "output": "183\n"
        },
        {
            "input": "6 15 12\n5 1\n1 3\n1 6\n1 2\n6 2\n3 4\n4 6\n4 1\n5 3\n2 6\n6 5\n4 5\n3 6\n5 2\n3 2\n",
            "output": "21792\n"
        },
        {
            "input": "12 35 3\n8 12\n10 4\n7 11\n1 5\n6 1\n9 7\n3 6\n9 4\n12 2\n10 4\n9 8\n2 3\n8 4\n1 7\n3 9\n11 5\n6 11\n4 12\n2 9\n3 8\n2 1\n11 1\n7 2\n11 10\n2 11\n3 7\n6 12\n4 3\n6 10\n8 11\n6 2\n7 4\n2 8\n12 11\n8 10\n",
            "output": "131079\n"
        },
        {
            "input": "12 35 12\n2 9\n2 10\n2 11\n3 12\n8 10\n5 4\n2 4\n8 3\n11 10\n10 5\n11 5\n4 8\n4 3\n6 11\n11 9\n10 12\n9 8\n9 3\n7 10\n2 8\n3 10\n7 3\n6 7\n2 5\n10 4\n8 11\n9 7\n4 11\n2 7\n9 10\n6 10\n3 11\n10 1\n2 3\n6 3\n",
            "output": "587158716\n"
        },
        {
            "input": "12 46 12\n10 2\n10 5\n6 1\n1 4\n2 11\n12 9\n10 11\n2 7\n12 6\n2 6\n8 9\n3 11\n4 2\n9 1\n6 5\n4 12\n7 11\n7 6\n4 5\n6 11\n2 9\n12 7\n1 12\n1 5\n11 1\n6 10\n7 8\n4 6\n7 1\n12 11\n1 2\n2 12\n7 4\n9 6\n10 12\n7 9\n9 5\n4 9\n11 4\n7 5\n5 2\n5 12\n11 5\n9 10\n11 9\n1 10\n",
            "output": "6969619680\n"
        },
        {
            "input": "12 11 12\n3 4\n5 2\n4 6\n1 7\n7 8\n9 8\n6 10\n11 1\n2 11\n12 3\n5 12\n",
            "output": "2985984\n"
        },
        {
            "input": "12 39 12\n6 11\n10 6\n3 5\n4 11\n8 10\n7 9\n10 2\n7 11\n9 4\n7 4\n9 10\n8 12\n10 11\n5 12\n11 9\n2 1\n6 9\n3 4\n3 1\n2 11\n4 1\n7 5\n8 2\n12 4\n11 5\n6 4\n1 7\n5 9\n9 1\n6 1\n3 9\n1 12\n1 10\n4 2\n3 2\n6 5\n6 12\n8 5\n6 8\n",
            "output": "12300124728\n"
        },
        {
            "input": "12 26 12\n1 2\n1 4\n3 4\n5 1\n6 3\n6 5\n3 7\n5 7\n8 2\n8 4\n9 2\n3 9\n9 6\n9 7\n10 6\n5 10\n10 8\n10 9\n3 11\n11 5\n7 11\n10 11\n1 12\n12 2\n12 6\n12 8\n",
            "output": "4300866516\n"
        },
        {
            "input": "12 0 3\n",
            "output": "0\n"
        },
        {
            "input": "12 62 2\n1 5\n8 10\n9 10\n7 6\n9 12\n3 1\n12 1\n2 10\n9 9\n2 11\n2 5\n10 4\n4 2\n12 11\n7 8\n4 12\n12 3\n7 11\n10 3\n8 3\n2 8\n1 4\n3 2\n7 12\n10 1\n4 8\n1 6\n10 12\n3 5\n1 2\n6 11\n5 12\n5 9\n2 6\n5 4\n12 2\n3 7\n1 8\n11 5\n2 9\n11 10\n7 4\n8 5\n7 2\n9 1\n8 9\n9 4\n6 4\n6 12\n3 11\n11 4\n6 8\n9 11\n3 6\n8 11\n12 8\n6 5\n10 5\n5 7\n7 10\n7 1\n3 4\n",
            "output": "2048\n"
        },
        {
            "input": "6 5 3\n2 6\n2 2\n4 5\n3 1\n5 3\n",
            "output": "0\n"
        },
        {
            "input": "12 56 12\n1 2\n3 1\n3 2\n2 4\n4 3\n5 1\n5 2\n3 5\n1 6\n3 6\n4 6\n6 5\n7 1\n2 7\n7 3\n4 7\n7 5\n7 6\n1 8\n2 8\n8 3\n4 8\n5 8\n6 8\n9 1\n9 2\n3 9\n5 9\n6 9\n7 9\n9 8\n10 1\n2 10\n3 10\n10 4\n10 5\n10 7\n8 10\n10 9\n1 12\n11 2\n3 11\n11 4\n5 11\n7 11\n8 11\n9 11\n12 1\n12 4\n12 5\n6 12\n7 12\n8 12\n12 9\n10 12\n11 12\n",
            "output": "12665422848\n"
        },
        {
            "input": "8 24 3\n6 4\n5 1\n8 5\n7 6\n5 8\n7 3\n8 2\n2 3\n2 7\n6 2\n6 3\n8 3\n1 2\n8 7\n3 1\n1 6\n3 5\n1 7\n2 4\n4 8\n8 1\n2 5\n4 1\n4 3\n",
            "output": "1641\n"
        },
        {
            "input": "12 58 2\n11 6\n10 1\n2 12\n5 1\n11 1\n11 9\n1 4\n6 7\n8 11\n6 12\n11 10\n8 2\n3 11\n10 7\n8 12\n11 7\n10 5\n3 1\n12 9\n3 6\n10 12\n1 12\n2 4\n10 4\n3 9\n3 2\n2 6\n7 2\n7 9\n12 10\n3 8\n5 9\n9 2\n8 9\n1 2\n11 12\n1 9\n4 8\n3 10\n12 4\n5 11\n9 6\n10 2\n3 5\n6 1\n6 8\n5 4\n10 8\n3 7\n4 3\n7 8\n2 11\n12 7\n7 4\n12 5\n5 2\n6 5\n9 10\n",
            "output": "2048\n"
        },
        {
            "input": "12 55 12\n1 3\n2 3\n4 1\n2 4\n4 3\n1 5\n2 5\n5 3\n6 1\n6 2\n6 3\n4 6\n7 1\n2 7\n7 4\n5 7\n1 8\n8 2\n8 3\n8 5\n8 6\n8 7\n9 1\n2 9\n9 3\n4 9\n5 9\n7 9\n9 8\n1 10\n10 2\n3 10\n4 10\n10 6\n10 7\n10 8\n11 1\n11 2\n11 3\n11 4\n11 6\n7 11\n8 11\n11 9\n10 2\n1 12\n12 3\n12 4\n12 5\n6 12\n7 12\n12 8\n9 12\n10 12\n11 12\n",
            "output": "12665422848\n"
        },
        {
            "input": "10 9 12\n4 1\n4 3\n6 2\n6 3\n7 1\n1 8\n5 9\n7 9\n10 5\n",
            "output": "0\n"
        },
        {
            "input": "12 57 12\n1 2\n1 3\n3 2\n1 4\n4 3\n1 5\n2 5\n5 3\n4 3\n6 1\n2 6\n3 6\n4 6\n7 1\n7 2\n7 5\n7 6\n3 8\n8 4\n8 5\n6 8\n8 7\n2 9\n3 9\n4 9\n9 5\n7 9\n8 9\n10 1\n2 10\n3 10\n4 10\n5 10\n6 10\n10 7\n8 10\n9 10\n11 1\n2 11\n11 3\n11 4\n11 6\n7 11\n8 11\n9 11\n11 10\n1 12\n12 2\n3 12\n4 12\n5 12\n6 12\n12 7\n12 8\n12 9\n12 10\n11 12\n",
            "output": "12665422848\n"
        },
        {
            "input": "4 1 2\n3 2\n4 2\n1 4\n",
            "output": "0\n"
        },
        {
            "input": "12 50 12\n2 1\n3 1\n3 2\n4 1\n4 2\n1 5\n5 3\n1 6\n2 6\n6 3\n6 5\n1 7\n3 7\n7 4\n7 5\n1 8\n2 8\n5 8\n8 6\n7 8\n9 1\n2 9\n3 9\n4 9\n9 5\n9 7\n3 9\n1 10\n2 10\n10 3\n4 10\n5 10\n7 10\n10 8\n10 9\n11 1\n2 11\n11 3\n11 4\n11 6\n9 11\n10 11\n1 12\n12 2\n12 4\n12 5\n6 12\n7 12\n12 10\n11 12\n",
            "output": "12665422848\n"
        },
        {
            "input": "12 48 12\n4 1\n4 3\n1 5\n5 3\n4 5\n6 1\n2 6\n6 3\n6 4\n5 6\n7 1\n7 2\n3 7\n7 4\n6 7\n1 8\n8 2\n4 8\n8 5\n8 6\n1 9\n9 2\n4 9\n9 6\n9 8\n10 1\n2 10\n3 10\n4 10\n10 5\n10 7\n10 8\n1 11\n11 3\n11 4\n11 9\n7 11\n11 9\n10 11\n12 2\n12 3\n4 12\n12 5\n12 6\n7 12\n12 8\n9 12\n11 12\n",
            "output": "12662096448\n"
        },
        {
            "input": "12 0 2\n",
            "output": "0\n"
        },
        {
            "input": "12 11 12\n3 4\n3 4\n6 1\n8 6\n2 9\n9 7\n7 10\n11 2\n8 11\n12 1\n12 5\n",
            "output": "0\n"
        },
        {
            "input": "12 5 12\n3 4\n5 2\n4 6\n1 7\n7 9\n9 8\n6 10\n11 1\n2 11\n12 3\n5 12\n",
            "output": "0\n"
        },
        {
            "input": "12 37 12\n1 8\n1 5\n5 3\n8 7\n5 8\n2 3\n6 4\n8 3\n10 1\n10 5\n3 1\n9 10\n4 5\n9 4\n3 6\n8 9\n8 2\n9 3\n9 6\n6 10\n4 3\n7 5\n11 4\n5 1\n8 6\n4 2\n2 9\n8 10\n9 7\n5 9\n4 12\n6 1\n10 7\n6 7\n10 3\n2 1\n7 4\n",
            "output": "0\n"
        },
        {
            "input": "12 4 12\n5 3\n1 2\n6 8\n9 3\n",
            "output": "0\n"
        },
        {
            "input": "12 38 2\n4 11\n11 2\n5 1\n6 7\n9 1\n4 1\n12 2\n10 4\n8 1\n9 10\n1 2\n3 1\n11 12\n10 3\n12 9\n3 12\n4 5\n1 6\n3 9\n11 8\n4 12\n5 3\n9 7\n3 8\n7 5\n12 7\n11 10\n4 9\n2 10\n6 12\n9 2\n3 7\n6 2\n5 8\n10 12\n8 7\n4 2\n4 3\n",
            "output": "2048\n"
        },
        {
            "input": "12 39 2\n2 1\n11 4\n9 11\n1 5\n4 1\n11 7\n9 12\n9 3\n4 5\n12 4\n1 11\n8 1\n6 8\n6 11\n4 3\n1 10\n5 10\n3 7\n10 2\n3 11\n12 7\n10 6\n3 12\n12 11\n5 8\n8 2\n7 9\n9 8\n7 2\n11 8\n12 6\n4 6\n12 1\n11 5\n9 5\n7 9\n12 2\n9 4\n6 7\n",
            "output": "2048\n"
        },
        {
            "input": "12 30 2\n6 4\n1 2\n5 8\n2 9\n5 3\n8 11\n10 5\n3 1\n12 2\n8 9\n4 3\n1 12\n10 4\n1 9\n8 2\n2 6\n8 11\n5 6\n7 2\n1 4\n10 3\n6 1\n11 4\n9 12\n1 11\n1 7\n7 9\n3 12\n4 2\n5 4\n",
            "output": "2048\n"
        },
        {
            "input": "8 26 3\n6 4\n1 8\n8 4\n4 4\n5 6\n5 2\n1 7\n8 1\n3 7\n4 1\n6 1\n5 4\n7 2\n4 7\n6 2\n7 8\n2 1\n5 3\n6 3\n1 3\n5 7\n7 6\n8 5\n2 3\n8 6\n4 2\n",
            "output": "1641\n"
        },
        {
            "input": "12 0 0\n",
            "output": "0\n"
        },
        {
            "input": "12 50 2\n3 7\n12 11\n12 1\n1 6\n10 5\n5 9\n4 11\n5 7\n3 1\n9 4\n6 9\n5 12\n8 4\n1 11\n12 9\n9 2\n6 2\n5 2\n4 7\n4 10\n11 9\n10 11\n7 12\n4 5\n9 10\n9 8\n11 7\n12 8\n2 8\n7 9\n8 1\n12 4\n2 11\n11 3\n6 7\n8 10\n2 7\n1 9\n3 4\n1 5\n10 2\n3 8\n6 3\n2 12\n10 1\n10 7\n8 6\n5 1\n2 4\n9 12\n",
            "output": "2048\n"
        },
        {
            "input": "6 5 3\n2 6\n2 2\n4 5\n3 1\n5 4\n",
            "output": "0\n"
        },
        {
            "input": "8 24 3\n6 4\n5 1\n8 5\n7 6\n5 8\n7 3\n8 2\n2 3\n2 7\n6 2\n6 3\n8 3\n1 2\n8 7\n3 1\n1 6\n3 5\n1 7\n2 4\n6 8\n8 1\n2 5\n4 1\n4 3\n",
            "output": "1641\n"
        },
        {
            "input": "6 14 4\n5 2\n6 5\n1 2\n4 1\n5 4\n4 3\n4 4\n1 5\n5 3\n1 6\n6 1\n1 3\n6 4\n3 2\n",
            "output": "544\n"
        },
        {
            "input": "4 1 2\n3 2\n4 2\n1 2\n",
            "output": "0\n"
        },
        {
            "input": "12 59 5\n1 10\n9 4\n9 8\n9 1\n4 2\n8 10\n8 6\n3 8\n3 6\n10 6\n5 1\n9 3\n10 7\n4 1\n8 4\n6 11\n8 7\n4 11\n1 8\n8 5\n5 10\n9 6\n4 6\n1 2\n5 11\n9 11\n7 11\n7 12\n11 8\n5 3\n11 3\n12 4\n1 11\n11 12\n7 5\n1 6\n6 5\n2 7\n9 5\n12 8\n4 3\n4 5\n7 2\n12 6\n10 4\n9 7\n12 2\n2 9\n3 10\n6 7\n7 4\n12 1\n2 3\n12 3\n2 10\n2 5\n9 12\n2 9\n6 2\n",
            "output": "15424865\n"
        },
        {
            "input": "8 7 12\n4 1\n4 3\n2 5\n1 6\n7 2\n7 3\n2 6\n",
            "output": "0\n"
        },
        {
            "input": "12 35 12\n2 9\n2 10\n2 11\n3 12\n8 10\n5 4\n2 4\n8 3\n11 10\n10 5\n11 5\n4 8\n4 3\n6 11\n11 9\n10 3\n9 8\n9 3\n7 10\n2 8\n3 9\n7 3\n6 7\n2 5\n10 4\n8 11\n9 7\n4 11\n2 7\n9 10\n6 10\n3 11\n10 1\n2 3\n5 3\n",
            "output": "138246912\n"
        },
        {
            "input": "12 11 12\n3 4\n3 4\n6 2\n8 6\n2 9\n9 7\n7 10\n11 2\n8 11\n12 1\n12 5\n",
            "output": "0\n"
        },
        {
            "input": "12 5 12\n3 4\n5 4\n4 6\n1 7\n7 9\n9 8\n6 10\n11 1\n2 11\n12 3\n5 12\n",
            "output": "0\n"
        },
        {
            "input": "12 4 12\n5 3\n1 2\n6 8\n9 5\n",
            "output": "0\n"
        },
        {
            "input": "12 30 2\n6 4\n1 2\n5 8\n2 9\n5 3\n8 11\n10 5\n3 1\n12 2\n8 9\n5 3\n1 12\n10 4\n1 9\n8 2\n2 6\n8 11\n5 6\n7 2\n1 4\n10 3\n6 1\n11 4\n9 12\n1 11\n1 7\n7 9\n3 12\n4 2\n5 4\n",
            "output": "2048\n"
        },
        {
            "input": "12 50 2\n3 7\n12 11\n12 1\n1 6\n10 5\n5 9\n4 11\n5 7\n3 1\n9 4\n6 9\n4 12\n8 4\n1 11\n12 9\n9 2\n6 2\n5 2\n4 7\n4 10\n11 9\n10 11\n7 12\n4 5\n9 10\n9 8\n11 7\n12 8\n2 8\n7 9\n8 1\n12 4\n2 11\n11 3\n6 7\n8 10\n2 7\n1 9\n3 4\n1 5\n10 2\n3 8\n6 3\n2 12\n10 1\n10 7\n8 6\n5 1\n2 4\n9 12\n",
            "output": "2048\n"
        },
        {
            "input": "12 49 12\n3 1\n2 3\n4 1\n2 4\n5 3\n4 5\n1 6\n6 4\n6 5\n7 1\n7 2\n3 7\n4 7\n7 5\n7 6\n2 8\n3 8\n5 8\n8 6\n1 9\n4 9\n4 9\n9 5\n9 6\n8 9\n1 10\n10 2\n10 4\n10 5\n6 10\n7 10\n10 8\n10 9\n11 1\n4 11\n3 11\n11 4\n5 11\n6 11\n9 11\n12 1\n2 12\n12 4\n5 12\n6 12\n7 12\n12 8\n9 12\n12 11\n",
            "output": "12662096448\n"
        },
        {
            "input": "8 24 3\n6 4\n5 1\n8 5\n7 6\n5 8\n7 3\n8 2\n2 3\n2 7\n6 2\n6 3\n8 3\n1 2\n8 7\n3 2\n1 6\n3 5\n1 7\n2 4\n6 8\n8 1\n2 5\n4 1\n4 3\n",
            "output": "1641\n"
        },
        {
            "input": "12 50 12\n2 1\n3 1\n3 2\n4 1\n4 2\n1 5\n5 3\n1 6\n2 6\n6 3\n6 5\n2 7\n5 7\n7 4\n7 5\n1 8\n2 8\n5 8\n8 6\n7 8\n9 1\n2 9\n3 9\n4 9\n9 5\n9 7\n3 9\n1 10\n2 10\n10 3\n4 10\n5 10\n7 10\n10 8\n10 9\n11 1\n2 11\n11 3\n11 4\n11 6\n9 11\n10 11\n1 12\n12 2\n12 4\n12 5\n6 12\n7 12\n12 10\n11 12\n",
            "output": "12664757568\n"
        },
        {
            "input": "12 48 12\n4 1\n4 3\n1 5\n5 3\n4 5\n6 1\n2 6\n6 3\n6 4\n5 6\n7 1\n7 2\n3 7\n7 4\n6 7\n1 8\n8 2\n4 8\n8 5\n8 6\n1 9\n9 2\n4 9\n9 6\n9 8\n10 1\n2 10\n3 10\n4 10\n10 5\n10 7\n10 8\n1 11\n11 3\n11 5\n11 9\n7 11\n11 9\n10 11\n12 2\n12 3\n4 12\n12 5\n12 6\n6 12\n12 8\n9 12\n11 12\n",
            "output": "12660100608\n"
        },
        {
            "input": "8 7 3\n4 1\n4 3\n2 5\n1 6\n7 2\n7 3\n2 6\n",
            "output": "0\n"
        },
        {
            "input": "12 35 12\n2 9\n2 10\n2 11\n3 12\n2 10\n5 4\n2 4\n8 3\n11 10\n10 5\n11 5\n4 8\n4 3\n6 11\n11 9\n10 3\n9 8\n9 3\n7 10\n2 8\n3 9\n7 3\n6 7\n2 5\n10 4\n8 11\n9 7\n4 11\n2 7\n9 10\n6 10\n3 11\n10 1\n2 3\n5 3\n",
            "output": "138246912\n"
        },
        {
            "input": "12 11 12\n3 4\n3 4\n6 2\n12 6\n2 9\n9 7\n7 10\n11 2\n8 11\n12 1\n12 5\n",
            "output": "0\n"
        },
        {
            "input": "12 5 12\n3 4\n5 4\n4 6\n1 7\n7 9\n9 8\n6 10\n15 1\n2 11\n12 3\n5 12\n",
            "output": "0\n"
        },
        {
            "input": "12 4 2\n5 3\n1 2\n6 8\n9 5\n",
            "output": "0\n"
        },
        {
            "input": "12 30 2\n6 4\n1 2\n5 2\n2 9\n5 3\n8 11\n10 5\n3 1\n12 2\n8 9\n5 3\n1 12\n10 4\n1 9\n8 2\n2 6\n8 11\n5 6\n7 2\n1 4\n10 3\n6 1\n11 4\n9 12\n1 11\n1 7\n7 9\n3 12\n4 2\n5 4\n",
            "output": "2048\n"
        },
        {
            "input": "12 50 0\n3 7\n12 11\n12 1\n1 6\n10 5\n5 9\n4 11\n5 7\n3 1\n9 4\n6 9\n4 12\n8 4\n1 11\n12 9\n9 2\n6 2\n5 2\n4 7\n4 10\n11 9\n10 11\n7 12\n4 5\n9 10\n9 8\n11 7\n12 8\n2 8\n7 9\n8 1\n12 4\n2 11\n11 3\n6 7\n8 10\n2 7\n1 9\n3 4\n1 5\n10 2\n3 8\n6 3\n2 12\n10 1\n10 7\n8 6\n5 1\n2 4\n9 12\n",
            "output": "0\n"
        },
        {
            "input": "8 7 3\n4 1\n4 2\n2 5\n1 6\n7 2\n7 3\n2 6\n",
            "output": "0\n"
        },
        {
            "input": "12 11 12\n3 4\n3 4\n6 2\n12 12\n2 9\n9 7\n7 10\n11 2\n8 11\n12 1\n12 5\n",
            "output": "0\n"
        },
        {
            "input": "12 5 12\n3 4\n5 4\n4 6\n1 7\n7 9\n9 10\n6 10\n15 1\n2 11\n12 3\n5 12\n",
            "output": "0\n"
        },
        {
            "input": "12 5 12\n3 4\n5 4\n4 6\n1 7\n7 9\n9 10\n6 10\n15 1\n2 11\n16 3\n5 12\n",
            "output": "0\n"
        },
        {
            "input": "12 5 12\n3 4\n4 4\n4 6\n1 7\n7 9\n9 10\n6 10\n15 1\n2 11\n16 3\n5 12\n",
            "output": "0\n"
        },
        {
            "input": "12 35 7\n2 9\n2 10\n2 11\n3 12\n2 5\n5 4\n2 4\n8 3\n11 10\n10 5\n11 5\n4 8\n4 3\n6 11\n11 9\n10 3\n9 8\n9 3\n7 10\n2 8\n3 9\n7 3\n6 7\n2 5\n10 4\n8 11\n9 7\n4 7\n2 9\n9 10\n6 10\n3 11\n10 1\n2 3\n5 3\n",
            "output": "4511479\n"
        },
        {
            "input": "12 5 12\n3 4\n7 4\n4 6\n1 7\n7 9\n9 10\n6 10\n15 1\n2 11\n16 3\n5 12\n",
            "output": "0\n"
        },
        {
            "input": "12 5 12\n3 4\n7 4\n4 6\n1 7\n7 9\n9 10\n6 10\n15 1\n1 11\n16 3\n5 12\n",
            "output": "0\n"
        },
        {
            "input": "12 5 12\n3 4\n7 4\n4 6\n1 7\n7 9\n9 10\n6 10\n15 1\n1 11\n16 3\n5 14\n",
            "output": "0\n"
        },
        {
            "input": "12 49 12\n3 1\n2 3\n4 1\n3 7\n5 3\n4 5\n1 6\n6 4\n6 10\n7 1\n7 2\n3 7\n4 7\n7 5\n7 6\n2 8\n3 8\n5 8\n8 6\n1 9\n4 9\n4 9\n9 5\n12 6\n8 9\n1 10\n10 2\n10 4\n10 5\n6 10\n7 10\n10 8\n10 9\n11 1\n4 11\n3 11\n11 4\n5 11\n6 11\n9 5\n12 1\n2 12\n12 8\n5 12\n6 12\n7 12\n12 1\n9 12\n12 11\n",
            "output": "12621799488\n"
        },
        {
            "input": "12 9 7\n2 9\n2 10\n2 11\n3 12\n2 5\n5 4\n2 4\n8 3\n11 10\n10 5\n11 5\n4 8\n4 3\n6 11\n11 9\n10 3\n9 8\n9 3\n7 10\n4 8\n3 9\n7 3\n6 7\n2 5\n10 4\n8 11\n5 7\n4 7\n2 9\n9 10\n6 10\n3 11\n10 1\n2 3\n5 3\n",
            "output": "0\n"
        },
        {
            "input": "12 9 7\n2 9\n2 10\n2 11\n3 12\n2 5\n5 4\n2 4\n8 3\n11 10\n10 5\n11 5\n5 8\n4 3\n6 11\n11 9\n10 3\n9 8\n9 3\n7 10\n4 8\n3 9\n7 3\n6 7\n2 5\n10 4\n8 11\n5 7\n4 7\n2 9\n9 10\n6 10\n3 11\n10 1\n2 3\n5 3\n",
            "output": "0\n"
        },
        {
            "input": "12 9 7\n2 9\n2 10\n2 11\n3 12\n2 5\n5 6\n2 4\n8 3\n11 10\n10 5\n11 5\n5 8\n4 3\n6 11\n11 9\n10 3\n9 8\n9 3\n7 10\n4 8\n3 9\n7 3\n6 7\n2 5\n10 4\n8 11\n5 7\n4 7\n2 9\n9 10\n6 10\n3 11\n10 1\n2 3\n5 3\n",
            "output": "0\n"
        },
        {
            "input": "12 9 7\n2 9\n2 10\n2 11\n3 12\n2 5\n5 6\n2 4\n8 3\n11 10\n10 5\n11 5\n5 8\n4 3\n6 11\n11 9\n10 3\n9 8\n9 3\n7 10\n4 8\n3 9\n7 3\n6 7\n2 5\n10 4\n8 11\n5 7\n4 14\n2 9\n9 10\n6 10\n3 11\n10 1\n2 3\n5 3\n",
            "output": "0\n"
        },
        {
            "input": "12 9 7\n2 9\n2 10\n2 11\n3 12\n4 5\n5 6\n2 4\n8 3\n11 10\n10 5\n11 5\n5 8\n4 3\n6 11\n11 9\n10 3\n9 8\n9 3\n7 10\n4 8\n3 9\n7 3\n6 7\n2 5\n10 4\n8 11\n5 7\n4 14\n2 9\n9 10\n6 10\n3 11\n10 1\n2 3\n5 3\n",
            "output": "0\n"
        },
        {
            "input": "12 9 7\n2 9\n2 10\n2 11\n3 12\n4 5\n5 6\n2 4\n8 3\n11 10\n10 5\n11 5\n5 8\n4 3\n6 11\n11 9\n10 3\n9 8\n9 3\n7 10\n4 8\n3 9\n7 3\n6 7\n2 2\n10 4\n8 11\n5 7\n4 14\n2 9\n9 10\n6 10\n3 11\n10 1\n2 3\n5 3\n",
            "output": "0\n"
        },
        {
            "input": "12 9 7\n2 9\n2 10\n2 11\n3 12\n4 5\n5 6\n2 4\n8 3\n5 10\n10 5\n11 5\n5 8\n4 3\n6 11\n11 9\n10 3\n9 8\n9 3\n7 10\n4 8\n3 9\n7 3\n6 7\n2 2\n10 4\n8 11\n5 7\n4 14\n2 9\n9 10\n6 10\n3 11\n10 1\n2 3\n5 3\n",
            "output": "0\n"
        },
        {
            "input": "12 9 7\n2 9\n2 10\n2 11\n3 12\n4 5\n5 6\n2 4\n8 3\n5 10\n10 5\n11 5\n5 8\n4 3\n6 11\n10 9\n10 3\n9 8\n9 3\n7 10\n4 8\n3 9\n7 3\n6 7\n2 2\n10 4\n8 11\n5 7\n4 14\n2 9\n9 10\n6 10\n3 11\n10 1\n2 3\n5 3\n",
            "output": "0\n"
        },
        {
            "input": "12 9 7\n2 9\n2 10\n2 11\n3 12\n4 5\n5 6\n2 4\n8 3\n5 10\n10 5\n11 5\n5 8\n4 1\n6 11\n10 9\n10 3\n9 8\n9 3\n7 10\n4 8\n3 9\n7 3\n6 7\n2 2\n10 4\n8 11\n5 7\n4 14\n2 9\n9 10\n6 10\n3 11\n10 1\n2 3\n5 3\n",
            "output": "0\n"
        },
        {
            "input": "12 9 7\n2 9\n2 10\n2 2\n3 12\n4 5\n5 6\n2 4\n8 3\n5 10\n10 5\n11 5\n5 8\n4 1\n6 11\n10 9\n10 3\n9 8\n9 3\n7 10\n4 8\n3 9\n7 3\n6 7\n2 2\n10 4\n8 11\n5 7\n4 14\n2 9\n9 10\n6 10\n3 11\n10 1\n2 3\n5 3\n",
            "output": "0\n"
        },
        {
            "input": "12 9 7\n2 9\n2 10\n2 2\n3 12\n4 5\n5 6\n1 4\n8 3\n5 10\n10 5\n11 5\n5 8\n4 1\n6 11\n10 9\n10 3\n9 8\n9 3\n7 10\n4 8\n3 9\n7 3\n6 7\n2 2\n10 4\n8 11\n5 7\n4 14\n2 9\n9 10\n6 10\n3 11\n10 1\n2 3\n5 3\n",
            "output": "0\n"
        },
        {
            "input": "12 9 7\n2 9\n2 10\n2 2\n3 12\n4 5\n5 6\n1 4\n8 3\n5 10\n10 5\n11 5\n5 8\n4 1\n6 11\n10 9\n10 3\n9 8\n9 3\n7 10\n4 8\n3 9\n7 3\n6 7\n2 2\n10 4\n8 11\n5 7\n4 14\n2 9\n9 10\n6 10\n3 11\n10 0\n2 3\n5 3\n",
            "output": "0\n"
        },
        {
            "input": "12 9 7\n2 9\n2 10\n2 2\n3 12\n4 5\n5 6\n1 4\n8 3\n5 10\n10 5\n11 5\n5 8\n4 1\n6 11\n10 9\n10 3\n9 8\n9 6\n7 10\n4 8\n3 9\n7 3\n6 7\n2 2\n10 4\n8 11\n5 7\n4 14\n2 9\n9 10\n6 10\n3 11\n10 0\n2 3\n5 3\n",
            "output": "0\n"
        },
        {
            "input": "12 9 7\n2 9\n2 10\n2 2\n3 12\n4 5\n5 6\n1 4\n8 3\n5 10\n10 5\n11 5\n5 8\n4 1\n9 11\n10 9\n10 3\n9 8\n9 6\n7 10\n4 8\n3 9\n7 3\n6 7\n2 2\n10 4\n8 11\n5 7\n4 14\n2 9\n9 10\n6 10\n3 11\n10 0\n2 3\n5 3\n",
            "output": "0\n"
        },
        {
            "input": "12 9 7\n2 9\n2 10\n2 2\n3 12\n4 5\n5 6\n1 4\n8 5\n5 10\n10 5\n11 5\n5 8\n4 1\n9 11\n10 9\n10 3\n9 8\n9 6\n7 10\n4 8\n3 9\n7 3\n6 7\n2 2\n10 4\n8 11\n5 7\n4 14\n2 9\n9 10\n6 10\n3 11\n10 0\n2 3\n5 3\n",
            "output": "0\n"
        },
        {
            "input": "12 9 7\n2 9\n2 10\n2 2\n3 12\n4 5\n5 6\n1 4\n8 5\n5 10\n10 5\n11 5\n5 8\n4 1\n9 11\n10 9\n10 3\n9 8\n9 6\n7 10\n4 8\n3 9\n7 3\n6 7\n2 2\n11 4\n8 11\n5 7\n4 14\n2 9\n9 10\n6 10\n3 11\n10 0\n2 3\n5 3\n",
            "output": "0\n"
        },
        {
            "input": "12 9 7\n2 9\n2 10\n2 2\n3 12\n4 5\n5 6\n1 4\n8 5\n5 10\n10 5\n11 5\n5 8\n4 1\n9 11\n10 9\n10 3\n9 6\n9 6\n7 10\n4 8\n3 9\n7 3\n6 7\n2 2\n11 4\n8 11\n5 7\n4 14\n2 9\n9 10\n6 10\n3 11\n10 0\n2 3\n5 3\n",
            "output": "0\n"
        },
        {
            "input": "12 9 7\n2 9\n2 10\n2 2\n3 12\n4 5\n5 6\n1 4\n8 5\n5 10\n10 5\n11 5\n5 8\n4 1\n9 11\n10 9\n10 3\n9 6\n9 6\n7 10\n4 8\n3 9\n7 3\n6 7\n2 2\n11 4\n8 11\n5 7\n4 14\n2 9\n9 10\n6 10\n3 11\n10 1\n2 3\n5 3\n",
            "output": "0\n"
        },
        {
            "input": "12 9 7\n1 9\n2 10\n2 2\n3 12\n4 5\n5 6\n1 4\n8 5\n5 10\n10 5\n11 5\n5 8\n4 1\n9 11\n10 9\n10 3\n9 6\n9 6\n7 10\n4 8\n3 9\n7 3\n6 7\n2 2\n11 4\n8 11\n5 7\n4 14\n2 9\n9 10\n6 10\n3 11\n10 1\n2 3\n5 3\n",
            "output": "0\n"
        },
        {
            "input": "12 9 7\n1 9\n2 10\n2 2\n3 12\n4 5\n5 6\n1 4\n8 5\n5 10\n10 5\n11 1\n5 8\n4 1\n9 11\n10 9\n10 3\n9 6\n9 6\n7 10\n4 8\n3 9\n7 3\n6 7\n2 2\n11 4\n8 11\n5 7\n4 14\n2 9\n9 10\n6 10\n3 11\n10 1\n2 3\n5 3\n",
            "output": "0\n"
        },
        {
            "input": "12 9 7\n1 9\n2 10\n2 2\n3 12\n4 5\n5 1\n1 4\n8 5\n5 10\n10 5\n11 1\n5 8\n4 1\n9 11\n10 9\n10 3\n9 6\n9 6\n7 10\n4 8\n3 9\n7 3\n6 7\n2 2\n11 4\n8 11\n5 7\n4 14\n2 9\n9 10\n6 10\n3 11\n10 1\n2 3\n5 3\n",
            "output": "0\n"
        },
        {
            "input": "12 9 7\n1 9\n2 10\n2 2\n3 12\n4 5\n5 1\n1 4\n8 5\n5 10\n10 5\n11 1\n5 8\n7 1\n9 11\n10 9\n10 3\n9 6\n9 6\n7 10\n4 8\n3 9\n7 3\n6 7\n2 2\n11 4\n8 11\n5 7\n4 14\n2 9\n9 10\n6 10\n3 11\n10 1\n2 3\n5 3\n",
            "output": "0\n"
        },
        {
            "input": "12 9 7\n1 9\n2 10\n2 2\n3 12\n4 5\n5 1\n1 4\n8 5\n5 10\n10 5\n11 1\n5 8\n7 1\n9 11\n10 9\n10 3\n9 6\n9 6\n7 10\n4 8\n3 9\n7 3\n6 7\n2 2\n11 4\n8 11\n5 7\n8 14\n2 9\n9 10\n6 10\n3 11\n10 1\n2 3\n5 3\n",
            "output": "0\n"
        },
        {
            "input": "12 9 7\n1 9\n2 10\n2 4\n3 12\n4 5\n5 1\n1 4\n8 5\n5 10\n10 5\n11 1\n5 8\n7 1\n9 11\n10 9\n10 3\n9 6\n9 6\n7 10\n4 8\n3 9\n7 3\n6 7\n2 2\n11 4\n8 11\n5 7\n8 14\n2 9\n9 10\n6 10\n3 11\n10 1\n2 3\n5 3\n",
            "output": "0\n"
        },
        {
            "input": "12 9 7\n1 9\n2 10\n2 4\n3 12\n4 5\n5 1\n1 5\n8 5\n5 10\n10 5\n11 1\n5 8\n7 1\n9 11\n10 9\n10 3\n9 6\n9 6\n7 10\n4 8\n3 9\n7 3\n6 7\n2 2\n11 4\n8 11\n5 7\n8 14\n2 9\n9 10\n6 10\n3 11\n10 1\n2 3\n5 3\n",
            "output": "0\n"
        },
        {
            "input": "6 14 4\n2 5\n1 5\n2 3\n6 2\n2 1\n6 1\n6 1\n6 3\n6 4\n4 3\n3 5\n2 4\n5 4\n5 6\n",
            "output": "544\n"
        },
        {
            "input": "8 6 0\n5 1\n5 4\n6 7\n4 3\n3 5\n3 2\n",
            "output": "0\n"
        },
        {
            "input": "8 26 3\n6 4\n2 8\n8 4\n3 4\n5 6\n5 2\n1 7\n8 1\n3 7\n4 1\n6 1\n5 4\n7 2\n4 7\n6 2\n7 8\n2 1\n5 3\n6 3\n1 3\n5 7\n7 6\n8 5\n2 4\n8 6\n4 2\n",
            "output": "1641\n"
        },
        {
            "input": "6 0 1\n",
            "output": "0\n"
        },
        {
            "input": "12 50 2\n3 7\n12 11\n12 1\n1 6\n10 5\n5 9\n4 11\n5 7\n3 1\n9 4\n6 9\n6 12\n8 4\n1 11\n12 6\n9 2\n6 2\n5 2\n4 7\n4 10\n11 9\n10 11\n7 12\n4 5\n9 10\n9 8\n11 7\n12 8\n2 8\n7 9\n8 1\n12 4\n2 11\n11 3\n6 7\n8 10\n2 7\n1 9\n3 4\n1 5\n10 2\n3 8\n6 3\n2 12\n10 1\n10 7\n8 6\n5 11\n2 4\n9 12\n",
            "output": "2048\n"
        },
        {
            "input": "12 63 5\n2 9\n7 11\n4 10\n5 1\n6 2\n6 4\n3 4\n5 11\n7 1\n11 12\n3 5\n3 12\n11 4\n9 12\n2 7\n1 8\n7 5\n2 3\n2 5\n1 9\n3 7\n10 9\n10 3\n10 5\n1 12\n8 2\n12 5\n8 7\n5 4\n9 8\n4 8\n4 9\n10 2\n7 12\n1 10\n9 5\n8 12\n3 9\n8 5\n7 6\n1 11\n3 6\n8 6\n4 12\n6 12\n4 7\n12 10\n3 11\n11 9\n2 1\n10 6\n11 10\n11 6\n2 4\n6 1\n11 2\n8 11\n10 8\n9 6\n7 9\n7 10\n5 6\n1 4\n",
            "output": "15424865\n"
        },
        {
            "input": "8 28 12\n3 7\n3 8\n3 3\n2 6\n1 3\n7 6\n7 1\n2 8\n8 5\n5 3\n5 1\n4 1\n4 3\n8 4\n6 3\n2 1\n7 8\n6 5\n7 5\n5 4\n1 8\n4 7\n6 8\n2 4\n2 7\n5 2\n4 6\n1 6\n",
            "output": "1532928\n"
        },
        {
            "input": "12 51 12\n3 1\n3 2\n4 1\n4 3\n5 1\n5 2\n6 1\n6 3\n6 4\n4 1\n2 7\n3 7\n6 7\n8 1\n8 2\n8 3\n4 8\n8 5\n6 8\n8 7\n2 9\n9 3\n4 9\n5 9\n9 6\n7 9\n9 8\n1 10\n10 2\n3 10\n4 10\n5 10\n10 9\n11 1\n2 11\n3 11\n5 11\n11 6\n11 8\n9 11\n10 11\n1 12\n12 2\n3 12\n4 12\n12 5\n6 12\n12 7\n12 8\n9 12\n12 10\n",
            "output": "12664757568\n"
        },
        {
            "input": "12 62 2\n1 5\n8 10\n9 10\n7 6\n9 12\n3 1\n12 1\n2 10\n6 9\n2 11\n2 5\n10 4\n4 2\n12 11\n7 8\n4 12\n12 3\n7 11\n10 3\n8 3\n2 8\n1 4\n3 2\n7 12\n10 1\n4 8\n1 6\n10 12\n3 5\n1 2\n6 11\n5 12\n5 9\n2 6\n5 4\n12 2\n3 7\n1 8\n11 5\n2 9\n2 10\n7 4\n8 5\n7 2\n9 1\n8 9\n9 4\n6 4\n6 12\n3 11\n11 4\n6 8\n9 11\n3 6\n8 11\n12 8\n6 5\n10 5\n5 7\n7 10\n7 1\n3 4\n",
            "output": "2048\n"
        },
        {
            "input": "12 49 12\n3 1\n2 3\n4 1\n2 4\n5 3\n4 5\n1 6\n6 4\n6 5\n7 1\n7 2\n3 7\n4 7\n7 5\n7 6\n2 8\n3 8\n5 8\n8 6\n1 9\n3 9\n4 9\n9 5\n9 6\n8 9\n1 10\n10 2\n10 3\n10 5\n6 10\n7 10\n10 8\n10 9\n11 1\n2 11\n3 11\n10 4\n5 11\n6 11\n9 11\n12 1\n2 12\n12 4\n5 12\n6 12\n7 12\n12 8\n9 12\n12 11\n",
            "output": "12662096448\n"
        },
        {
            "input": "12 64 12\n6 12\n4 6\n8 6\n5 9\n11 6\n12 11\n7 8\n11 10\n5 1\n5 3\n4 9\n9 1\n6 10\n10 9\n10 1\n5 11\n8 3\n3 2\n1 6\n2 6\n1 11\n3 7\n9 8\n5 10\n10 12\n12 1\n11 2\n6 9\n8 5\n5 12\n8 10\n8 4\n6 5\n1 8\n2 1\n11 7\n3 6\n3 10\n7 2\n7 6\n12 8\n2 9\n7 1\n12 2\n9 3\n4 5\n1 3\n1 4\n11 3\n9 12\n4 2\n3 12\n7 10\n10 4\n11 4\n7 4\n7 12\n2 5\n10 2\n9 7\n4 12\n9 11\n7 5\n4 3\n",
            "output": "12665422848\n"
        },
        {
            "input": "8 24 3\n6 4\n5 1\n8 5\n7 6\n5 4\n7 3\n8 2\n4 3\n2 7\n6 2\n6 3\n8 3\n1 2\n8 7\n3 1\n1 6\n3 5\n1 7\n2 4\n4 8\n8 1\n2 5\n4 1\n4 3\n",
            "output": "1641\n"
        },
        {
            "input": "12 58 2\n11 6\n10 1\n2 12\n5 1\n11 1\n11 9\n1 4\n6 7\n8 11\n6 12\n11 10\n8 2\n3 11\n10 7\n8 12\n11 7\n10 5\n3 1\n12 9\n3 6\n10 12\n1 12\n2 4\n10 4\n3 9\n3 2\n2 6\n2 2\n7 9\n6 10\n3 8\n5 9\n9 2\n8 9\n1 2\n11 12\n1 9\n4 8\n3 10\n12 4\n5 11\n9 6\n10 2\n3 5\n6 1\n6 8\n5 4\n10 8\n3 7\n4 3\n7 8\n2 11\n12 7\n7 4\n12 5\n5 2\n6 5\n9 10\n",
            "output": "2048\n"
        },
        {
            "input": "12 64 2\n10 9\n3 12\n6 4\n9 4\n12 8\n4 3\n2 8\n8 5\n10 4\n11 7\n12 2\n8 4\n3 5\n2 11\n4 2\n4 5\n12 6\n3 2\n2 5\n9 12\n7 5\n12 5\n9 2\n11 1\n6 1\n7 1\n12 7\n8 6\n7 3\n8 7\n5 10\n1 8\n9 7\n11 9\n10 11\n9 5\n8 11\n11 5\n2 7\n7 3\n1 2\n9 1\n6 5\n10 7\n7 4\n1 3\n1 10\n2 10\n9 8\n3 10\n5 1\n3 6\n6 10\n3 11\n9 3\n11 12\n1 4\n9 6\n6 11\n11 4\n3 8\n8 10\n10 12\n4 12\n",
            "output": "2048\n"
        },
        {
            "input": "12 62 5\n12 5\n5 10\n6 5\n2 5\n8 4\n8 2\n1 3\n7 10\n2 3\n11 12\n5 4\n1 3\n5 8\n12 7\n3 9\n9 2\n11 4\n6 9\n1 5\n4 12\n8 7\n11 8\n10 4\n10 11\n1 10\n12 6\n11 1\n11 9\n3 12\n2 1\n1 12\n9 5\n12 9\n12 8\n10 6\n7 6\n8 6\n1 7\n3 6\n8 10\n4 2\n9 10\n4 3\n7 2\n6 1\n8 1\n11 3\n3 10\n2 11\n2 6\n10 12\n8 9\n9 1\n5 7\n5 3\n6 11\n7 9\n5 11\n1 4\n12 2\n8 3\n4 7\n",
            "output": "15424865\n"
        },
        {
            "input": "12 55 12\n1 3\n2 3\n4 1\n2 4\n4 3\n1 5\n2 5\n5 3\n6 1\n6 2\n6 3\n4 6\n7 1\n2 7\n7 4\n5 7\n1 8\n8 2\n8 3\n8 5\n8 6\n8 7\n9 1\n2 9\n9 3\n4 9\n5 9\n7 9\n9 8\n1 10\n10 2\n3 10\n4 10\n10 12\n10 7\n10 8\n11 1\n11 2\n11 3\n11 4\n11 6\n7 11\n8 11\n11 9\n10 11\n1 12\n12 3\n12 4\n12 5\n6 12\n7 12\n12 8\n9 12\n10 12\n11 12\n",
            "output": "12665422848\n"
        },
        {
            "input": "8 14 4\n5 2\n6 5\n1 2\n4 1\n5 4\n4 3\n2 4\n1 5\n5 3\n1 6\n6 3\n1 3\n6 4\n3 2\n",
            "output": "0\n"
        },
        {
            "input": "12 66 12\n1 2\n1 3\n1 4\n1 5\n1 6\n1 7\n1 8\n1 9\n1 10\n1 11\n1 12\n2 3\n2 4\n2 5\n2 6\n2 7\n2 8\n2 9\n2 10\n2 11\n2 12\n3 4\n3 5\n3 6\n3 7\n3 8\n3 9\n3 10\n3 11\n3 12\n4 5\n4 6\n4 7\n4 8\n4 9\n4 10\n4 11\n4 12\n5 6\n5 7\n5 8\n5 9\n5 10\n5 11\n5 12\n6 2\n6 8\n6 9\n6 10\n6 11\n6 12\n7 8\n7 9\n7 10\n7 11\n7 12\n8 9\n8 10\n8 11\n8 12\n9 10\n9 11\n9 12\n10 11\n10 12\n11 12\n",
            "output": "12665422848\n"
        },
        {
            "input": "6 13 2\n1 3\n4 2\n6 3\n3 5\n1 6\n4 1\n3 2\n1 5\n4 3\n6 2\n2 5\n6 4\n1 2\n",
            "output": "32\n"
        },
        {
            "input": "12 57 12\n1 2\n1 3\n3 2\n1 4\n4 3\n1 5\n2 5\n5 3\n4 5\n6 1\n2 6\n3 2\n4 6\n7 1\n7 2\n7 5\n7 6\n3 8\n8 4\n8 5\n6 8\n8 7\n2 9\n3 9\n4 9\n9 5\n7 9\n8 9\n10 1\n2 10\n3 10\n4 10\n5 10\n6 10\n10 7\n8 10\n9 10\n11 1\n2 11\n11 3\n11 4\n11 6\n7 11\n8 11\n9 11\n11 10\n1 12\n12 2\n3 12\n4 12\n5 12\n6 12\n12 7\n12 8\n12 9\n12 10\n11 12\n",
            "output": "12665422848\n"
        },
        {
            "input": "12 51 5\n5 4\n9 1\n8 1\n3 8\n7 10\n5 10\n5 2\n7 9\n5 7\n10 4\n6 7\n3 9\n1 7\n6 12\n10 1\n9 11\n4 3\n8 12\n6 8\n1 12\n7 8\n2 12\n3 8\n11 12\n11 6\n9 12\n3 5\n1 2\n11 10\n12 7\n3 2\n4 9\n8 10\n11 7\n4 12\n7 2\n6 4\n1 4\n10 2\n9 8\n12 3\n2 6\n3 1\n5 12\n7 3\n5 1\n9 2\n6 3\n8 4\n10 6\n3 11\n",
            "output": "15424865\n"
        },
        {
            "input": "6 6 3\n3 5\n2 5\n6 1\n2 3\n6 6\n5 4\n",
            "output": "0\n"
        },
        {
            "input": "4 2 0\n1 4\n1 2\n",
            "output": "0\n"
        },
        {
            "input": "12 66 5\n1 2\n9 6\n1 4\n8 6\n1 6\n5 6\n10 9\n12 1\n6 7\n3 1\n12 3\n11 1\n4 5\n12 2\n10 2\n4 10\n2 11\n9 1\n10 5\n6 3\n4 7\n6 10\n4 8\n2 3\n12 5\n10 8\n9 7\n12 9\n9 3\n12 7\n2 5\n9 2\n10 3\n11 5\n1 5\n7 1\n8 1\n6 12\n8 12\n2 4\n9 8\n6 4\n4 12\n8 7\n9 11\n7 3\n3 5\n10 12\n10 11\n5 9\n3 8\n2 8\n7 10\n4 11\n3 4\n8 11\n7 2\n11 3\n7 5\n11 7\n12 11\n1 10\n6 11\n4 4\n5 8\n6 2\n",
            "output": "15424865\n"
        },
        {
            "input": "8 6 2\n3 8\n2 3\n4 8\n3 4\n4 1\n1 2\n",
            "output": "0\n"
        },
        {
            "input": "12 65 5\n1 10\n10 6\n2 10\n8 10\n2 11\n1 5\n12 10\n5 2\n8 2\n6 8\n12 11\n10 11\n1 9\n3 12\n4 2\n4 11\n9 11\n9 4\n1 6\n6 3\n11 6\n12 2\n1 7\n4 1\n12 1\n6 7\n7 12\n9 8\n9 6\n12 9\n3 1\n7 8\n5 12\n11 5\n1 8\n9 10\n3 4\n3 5\n5 7\n4 5\n3 7\n6 12\n1 2\n4 12\n5 10\n8 11\n10 7\n6 2\n5 6\n6 4\n3 9\n3 2\n11 1\n4 7\n10 7\n8 12\n8 3\n5 9\n7 2\n7 11\n9 7\n5 8\n3 11\n9 2\n10 3\n",
            "output": "15424865\n"
        },
        {
            "input": "10 36 2\n1 9\n3 5\n7 1\n10 1\n9 5\n10 2\n8 7\n9 3\n7 6\n10 4\n9 6\n8 4\n5 8\n2 8\n3 6\n1 5\n1 6\n6 2\n7 3\n2 4\n7 5\n1 2\n1 3\n10 5\n9 8\n5 6\n2 7\n4 9\n4 7\n8 10\n1 6\n7 10\n6 4\n1 4\n2 9\n7 9\n",
            "output": "512\n"
        },
        {
            "input": "12 59 5\n1 10\n9 4\n9 8\n9 1\n4 2\n8 10\n8 2\n3 8\n3 6\n10 6\n5 1\n9 3\n10 7\n4 1\n8 4\n6 11\n8 7\n4 11\n1 8\n8 5\n5 10\n9 6\n4 6\n1 2\n5 11\n9 11\n7 11\n7 12\n11 8\n5 3\n11 3\n12 4\n1 11\n11 12\n7 5\n1 6\n6 5\n3 7\n9 5\n12 8\n4 3\n4 5\n7 2\n12 6\n10 4\n9 7\n12 2\n2 9\n3 10\n6 7\n7 4\n12 1\n2 3\n12 3\n2 10\n2 5\n9 12\n10 9\n6 2\n",
            "output": "15424865\n"
        },
        {
            "input": "8 28 3\n3 5\n1 6\n4 6\n8 2\n7 3\n5 8\n6 3\n8 3\n7 4\n1 3\n7 6\n2 5\n5 7\n6 8\n3 2\n4 3\n5 6\n5 4\n4 1\n4 2\n7 1\n6 2\n1 8\n2 1\n4 8\n8 7\n5 1\n3 7\n",
            "output": "1641\n"
        },
        {
            "input": "12 65 2\n4 1\n5 3\n8 7\n11 2\n2 9\n6 3\n3 4\n4 12\n2 8\n4 10\n10 11\n5 1\n10 8\n6 4\n4 5\n11 3\n3 10\n12 2\n12 1\n11 6\n1 8\n9 7\n3 8\n5 8\n2 10\n5 2\n10 6\n8 12\n11 1\n7 12\n11 5\n7 11\n11 8\n8 6\n11 7\n3 9\n1 7\n10 9\n5 12\n12 10\n12 9\n2 1\n7 10\n6 5\n4 7\n6 9\n2 6\n5 9\n6 7\n11 4\n11 9\n7 2\n7 5\n6 1\n3 12\n3 1\n1 9\n4 8\n1 10\n9 8\n2 4\n9 4\n3 7\n2 3\n12 6\n",
            "output": "2048\n"
        },
        {
            "input": "12 50 12\n2 1\n3 1\n3 2\n4 1\n4 2\n1 5\n5 3\n1 6\n2 6\n6 3\n6 5\n1 7\n3 7\n7 4\n7 5\n1 8\n2 8\n5 8\n8 6\n7 8\n9 1\n2 9\n3 9\n4 9\n9 5\n9 7\n8 9\n1 10\n2 10\n10 3\n4 10\n5 10\n7 10\n10 8\n10 9\n11 1\n2 11\n11 3\n11 4\n11 6\n9 11\n10 11\n1 12\n12 2\n12 4\n12 5\n6 12\n10 12\n12 10\n11 12\n",
            "output": "12665422848\n"
        },
        {
            "input": "12 48 12\n4 1\n4 3\n1 5\n5 3\n4 5\n6 1\n2 6\n6 3\n9 4\n5 6\n7 1\n7 2\n3 7\n7 4\n6 7\n1 8\n8 2\n4 8\n8 5\n8 6\n1 9\n9 2\n4 9\n9 6\n9 8\n10 1\n2 10\n3 10\n4 10\n10 5\n10 7\n10 8\n1 11\n11 3\n11 4\n11 5\n7 11\n11 9\n10 11\n12 2\n12 3\n4 12\n12 5\n12 6\n7 12\n12 8\n9 12\n11 12\n",
            "output": "12660100608\n"
        },
        {
            "input": "12 64 5\n8 1\n6 4\n8 11\n8 4\n11 9\n8 3\n7 11\n12 3\n11 5\n11 2\n2 10\n3 7\n6 8\n4 3\n9 12\n7 6\n11 3\n7 8\n1 12\n10 3\n12 8\n1 2\n12 10\n2 12\n11 4\n5 12\n6 7\n7 2\n9 2\n5 4\n3 6\n1 6\n12 7\n1 5\n8 10\n1 4\n10 1\n4 10\n7 9\n1 3\n5 7\n2 5\n3 5\n6 12\n2 3\n12 11\n8 2\n10 11\n9 5\n3 9\n6 2\n9 6\n11 1\n8 5\n4 7\n1 7\n10 7\n4 12\n4 2\n10 5\n10 9\n9 1\n6 10\n11 6\n",
            "output": "15424865\n"
        },
        {
            "input": "2 0 2\n2 1\n",
            "output": "0\n"
        },
        {
            "input": "12 2 5\n4 4\n11 1\n",
            "output": "0\n"
        }
    ]
}