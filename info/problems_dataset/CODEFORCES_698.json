{
    "name": "698_B. Fix a Tree",
    "source": "CODEFORCES",
    "description": "A tree is an undirected connected graph without cycles.\n\nLet's consider a rooted undirected tree with n vertices, numbered 1 through n. There are many ways to represent such a tree. One way is to create an array with n integers p1, p2, ..., pn, where pi denotes a parent of vertex i (here, for convenience a root is considered its own parent).\n\n<image> For this rooted tree the array p is [2, 3, 3, 2].\n\nGiven a sequence p1, p2, ..., pn, one is able to restore a tree:\n\n  1. There must be exactly one index r that pr = r. A vertex r is a root of the tree. \n  2. For all other n - 1 vertices i, there is an edge between vertex i and vertex pi. \n\n\n\nA sequence p1, p2, ..., pn is called valid if the described procedure generates some (any) rooted tree. For example, for n = 3 sequences (1,2,2), (2,3,1) and (2,1,3) are not valid.\n\nYou are given a sequence a1, a2, ..., an, not necessarily valid. Your task is to change the minimum number of elements, in order to get a valid sequence. Print the minimum number of changes and an example of a valid sequence after that number of changes. If there are many valid sequences achievable in the minimum number of changes, print any of them.\n\nInput\n\nThe first line of the input contains an integer n (2 \u2264 n \u2264 200 000) \u2014 the number of vertices in the tree.\n\nThe second line contains n integers a1, a2, ..., an (1 \u2264 ai \u2264 n).\n\nOutput\n\nIn the first line print the minimum number of elements to change, in order to get a valid sequence.\n\nIn the second line, print any valid sequence possible to get from (a1, a2, ..., an) in the minimum number of changes. If there are many such sequences, any of them will be accepted.\n\nExamples\n\nInput\n\n4\n2 3 3 4\n\n\nOutput\n\n1\n2 3 4 4 \n\n\nInput\n\n5\n3 2 2 5 3\n\n\nOutput\n\n0\n3 2 2 5 3 \n\n\nInput\n\n8\n2 3 5 4 1 6 6 7\n\n\nOutput\n\n2\n2 3 7 8 1 6 6 7\n\nNote\n\nIn the first sample, it's enough to change one element. In the provided output, a sequence represents a tree rooted in a vertex 4 (because p4 = 4), which you can see on the left drawing below. One of other correct solutions would be a sequence 2 3 3 2, representing a tree rooted in vertex 3 (right drawing below). On both drawings, roots are painted red.\n\n<image>\n\nIn the second sample, the given sequence is already valid.",
    "difficulty": "B",
    "tags": [
        "constructive algorithms",
        "dfs and similar",
        "dsu",
        "graphs",
        "trees"
    ],
    "rating": 1700,
    "public_test": [
        {
            "input": "5\n3 2 2 5 3\n",
            "output": "0\n3 2 2 5 3 "
        },
        {
            "input": "8\n2 3 5 4 1 6 6 7\n",
            "output": "2 \n2 3 5 4 4 4 6 7 \n"
        },
        {
            "input": "4\n2 3 3 4\n",
            "output": "1 \n2 3 3 3 \n"
        }
    ],
    "generated_test": [
        {
            "input": "6\n6 2 1 2 4 2\n",
            "output": "0\n6 2 1 2 4 2\n"
        },
        {
            "input": "7\n1 2 3 4 5 1 7\n",
            "output": "5\n1 1 1 1 1 1 1\n"
        },
        {
            "input": "7\n4 3 2 6 5 5 2\n",
            "output": "1\n4 5 2 6 5 5 2\n"
        },
        {
            "input": "7\n1 2 3 4 7 1 7\n",
            "output": "4\n1 1 1 1 7 1 1\n"
        },
        {
            "input": "7\n4 3 1 6 5 5 2\n",
            "output": "0\n4 3 1 6 5 5 2\n"
        },
        {
            "input": "7\n1 2 3 7 7 1 7\n",
            "output": "3\n1 1 1 7 7 1 1\n"
        },
        {
            "input": "6\n3 2 6 2 4 2\n",
            "output": "0\n3 2 6 2 4 2\n"
        },
        {
            "input": "2\n2 2\n",
            "output": "0\n2 2\n"
        },
        {
            "input": "8\n2 1 2 2 6 5 6 2\n",
            "output": "2\n1 1 2 2 1 5 6 2\n"
        },
        {
            "input": "7\n7 5 3 1 4 1 5\n",
            "output": "1\n3 5 3 1 4 1 5\n"
        },
        {
            "input": "4\n3 3 3 4\n",
            "output": "1\n3 3 3 3\n"
        },
        {
            "input": "7\n1 2 3 4 5 1 4\n",
            "output": "4\n1 1 1 1 1 1 4\n"
        },
        {
            "input": "7\n4 3 2 6 5 5 3\n",
            "output": "1\n4 5 2 6 5 5 3\n"
        },
        {
            "input": "7\n4 3 1 6 5 2 2\n",
            "output": "1\n5 3 1 6 5 2 2\n"
        },
        {
            "input": "7\n4 1 1 6 5 2 2\n",
            "output": "1\n5 1 1 6 5 2 2\n"
        },
        {
            "input": "7\n1 2 3 1 5 1 4\n",
            "output": "3\n1 1 1 1 1 1 4\n"
        },
        {
            "input": "7\n4 1 1 6 5 3 2\n",
            "output": "1\n5 1 1 6 5 3 2\n"
        },
        {
            "input": "7\n4 1 1 6 4 3 2\n",
            "output": "1\n1 1 1 6 4 3 2\n"
        },
        {
            "input": "7\n4 1 1 6 4 3 1\n",
            "output": "1\n1 1 1 6 4 3 1\n"
        },
        {
            "input": "7\n7 1 2 6 4 3 1\n",
            "output": "1\n1 1 2 6 4 3 1\n"
        },
        {
            "input": "7\n7 1 2 6 4 3 2\n",
            "output": "1\n1 1 2 6 4 3 2\n"
        },
        {
            "input": "7\n7 2 2 6 4 3 2\n",
            "output": "0\n7 2 2 6 4 3 2\n"
        },
        {
            "input": "7\n7 4 2 6 4 3 2\n",
            "output": "1\n7 2 2 6 4 3 2\n"
        },
        {
            "input": "3\n2 2 1\n",
            "output": "0\n2 2 1\n"
        },
        {
            "input": "18\n2 3 4 5 2 7 8 9 2 7 11 12 14 15 13 17 18 18\n",
            "output": "4\n2 11 4 5 2 7 8 9 2 7 11 11 11 15 13 17 18 11\n"
        },
        {
            "input": "7\n1 2 3 5 5 6 7\n",
            "output": "5\n1 1 1 5 1 1 1\n"
        },
        {
            "input": "7\n4 3 2 7 3 5 2\n",
            "output": "1\n4 2 2 7 3 5 2\n"
        },
        {
            "input": "7\n7 5 3 1 2 1 6\n",
            "output": "2\n3 3 3 1 2 1 6\n"
        },
        {
            "input": "7\n1 6 4 2 5 6 7\n",
            "output": "3\n1 6 4 2 1 1 1\n"
        },
        {
            "input": "5\n5 2 2 5 3\n",
            "output": "0\n5 2 2 5 3\n"
        },
        {
            "input": "6\n4 2 1 2 4 2\n",
            "output": "0\n4 2 1 2 4 2\n"
        },
        {
            "input": "7\n4 3 4 6 5 5 3\n",
            "output": "0\n4 3 4 6 5 5 3\n"
        },
        {
            "input": "7\n5 3 1 6 5 5 2\n",
            "output": "0\n5 3 1 6 5 5 2\n"
        },
        {
            "input": "7\n7 2 3 1 4 1 5\n",
            "output": "2\n2 2 2 1 4 1 5\n"
        },
        {
            "input": "4\n3 3 1 4\n",
            "output": "1\n4 3 1 4\n"
        },
        {
            "input": "7\n6 3 2 6 5 5 3\n",
            "output": "1\n6 5 2 6 5 5 3\n"
        },
        {
            "input": "7\n4 3 1 6 5 1 2\n",
            "output": "1\n5 3 1 6 5 1 2\n"
        },
        {
            "input": "7\n1 2 2 7 5 1 4\n",
            "output": "3\n1 1 2 1 1 1 4\n"
        },
        {
            "input": "7\n4 1 1 6 5 1 2\n",
            "output": "1\n5 1 1 6 5 1 2\n"
        },
        {
            "input": "7\n1 2 3 1 3 1 4\n",
            "output": "2\n1 1 1 1 3 1 4\n"
        },
        {
            "input": "7\n5 1 1 6 5 3 2\n",
            "output": "0\n5 1 1 6 5 3 2\n"
        },
        {
            "input": "7\n4 1 1 6 2 3 1\n",
            "output": "1\n1 1 1 6 2 3 1\n"
        },
        {
            "input": "7\n7 2 2 6 4 3 4\n",
            "output": "0\n7 2 2 6 4 3 4\n"
        },
        {
            "input": "7\n1 4 4 6 4 3 2\n",
            "output": "1\n1 4 4 1 4 3 2\n"
        },
        {
            "input": "18\n2 3 4 5 2 7 4 9 2 7 11 12 14 15 13 17 18 18\n",
            "output": "4\n2 11 4 5 2 7 4 9 2 7 11 11 11 15 13 17 18 11\n"
        },
        {
            "input": "6\n4 2 1 2 4 3\n",
            "output": "0\n4 2 1 2 4 3\n"
        },
        {
            "input": "7\n4 3 4 6 3 5 3\n",
            "output": "1\n4 3 4 4 3 5 3\n"
        },
        {
            "input": "7\n5 3 2 6 5 5 2\n",
            "output": "1\n5 5 2 6 5 5 2\n"
        },
        {
            "input": "4\n3 3 2 4\n",
            "output": "1\n3 3 4 4\n"
        },
        {
            "input": "7\n4 3 1 7 5 1 2\n",
            "output": "1\n5 3 1 7 5 1 2\n"
        },
        {
            "input": "7\n1 2 2 7 5 1 3\n",
            "output": "2\n1 1 2 7 1 1 3\n"
        },
        {
            "input": "7\n1 2 3 2 3 1 4\n",
            "output": "2\n1 1 1 2 3 1 4\n"
        },
        {
            "input": "7\n4 1 1 7 2 3 1\n",
            "output": "1\n1 1 1 7 2 3 1\n"
        },
        {
            "input": "7\n7 2 1 6 4 3 4\n",
            "output": "1\n2 2 1 6 4 3 4\n"
        },
        {
            "input": "18\n2 3 4 5 2 7 4 6 2 7 11 12 14 15 13 17 18 18\n",
            "output": "4\n2 11 4 5 2 7 4 6 2 7 11 11 11 15 13 17 18 11\n"
        },
        {
            "input": "6\n4 2 1 2 1 3\n",
            "output": "0\n4 2 1 2 1 3\n"
        },
        {
            "input": "7\n5 3 2 6 5 1 2\n",
            "output": "1\n5 5 2 6 5 1 2\n"
        },
        {
            "input": "7\n4 3 1 7 5 1 1\n",
            "output": "1\n5 3 1 7 5 1 1\n"
        },
        {
            "input": "7\n1 2 3 7 5 1 4\n",
            "output": "4\n1 1 1 1 1 1 4\n"
        },
        {
            "input": "7\n7 1 1 6 4 3 1\n",
            "output": "1\n1 1 1 6 4 3 1\n"
        },
        {
            "input": "7\n1 4 2 6 4 3 2\n",
            "output": "1\n1 1 2 6 4 3 2\n"
        },
        {
            "input": "7\n6 1 1 6 4 3 2\n",
            "output": "1\n1 1 1 6 4 3 2\n"
        },
        {
            "input": "7\n4 1 2 6 4 3 2\n",
            "output": "1\n1 1 2 6 4 3 2\n"
        },
        {
            "input": "7\n5 1 2 6 4 3 2\n",
            "output": "1\n1 1 2 6 4 3 2\n"
        },
        {
            "input": "7\n1 4 2 7 5 1 3\n",
            "output": "2\n1 1 2 7 1 1 3\n"
        }
    ]
}