{
    "name": "1560_F2. Nearest Beautiful Number (hard version)",
    "source": "CODEFORCES",
    "description": "It is a complicated version of problem F1. The difference between them is the constraints (F1: k \u2264 2, F2: k \u2264 10).\n\nYou are given an integer n. Find the minimum integer x such that x \u2265 n and the number x is k-beautiful.\n\nA number is called k-beautiful if its decimal representation having no leading zeroes contains no more than k different digits. E.g. if k = 2, the numbers 3434443, 55550, 777 and 21 are k-beautiful whereas the numbers 120, 445435 and 998244353 are not.\n\nInput\n\nThe first line contains one integer t (1 \u2264 t \u2264 10^4) \u2014 the number of test cases. Then t test cases follow.\n\nEach test case consists of one line containing two integers n and k (1 \u2264 n \u2264 10^9, 1 \u2264 k \u2264 10).\n\nOutput\n\nFor each test case output on a separate line x \u2014 the minimum k-beautiful integer such that x \u2265 n.\n\nExample\n\nInput\n\n\n6\n2021 3\n177890 2\n34512 3\n724533 4\n998244353 1\n12345678 10\n\n\nOutput\n\n\n2021\n181111\n34533\n724542\n999999999\n12345678",
    "difficulty": "F",
    "tags": [
        "bitmasks",
        "brute force",
        "constructive algorithms",
        "dfs and similar",
        "dp",
        "greedy"
    ],
    "rating": 2100,
    "public_test": [
        {
            "input": "6\n2021 3\n177890 2\n34512 3\n724533 4\n998244353 1\n12345678 10\n",
            "output": "2021\n181111\n34533\n724542\n999999999\n12345678\n"
        }
    ],
    "generated_test": [
        {
            "input": "1\n1533832 3\n",
            "output": "1535111\n"
        },
        {
            "input": "1\n6173683 2\n",
            "output": "6222222\n"
        },
        {
            "input": "1\n3330999 6\n",
            "output": "3330999\n"
        },
        {
            "input": "1\n186519 9\n",
            "output": "186519\n"
        },
        {
            "input": "1\n8923138 2\n",
            "output": "8988888\n"
        },
        {
            "input": "1\n1533832 2\n",
            "output": "1551111\n"
        },
        {
            "input": "1\n5144699 2\n",
            "output": "5151111\n"
        },
        {
            "input": "1\n3330999 2\n",
            "output": "3331111\n"
        },
        {
            "input": "1\n1533832 5\n",
            "output": "1533832\n"
        },
        {
            "input": "1\n723048 2\n",
            "output": "727222\n"
        },
        {
            "input": "1\n244697 6\n",
            "output": "244697\n"
        },
        {
            "input": "1\n2909865 5\n",
            "output": "2909866\n"
        },
        {
            "input": "1\n723048 3\n",
            "output": "723222\n"
        },
        {
            "input": "1\n3506626 4\n",
            "output": "3506630\n"
        },
        {
            "input": "1\n4876572 5\n",
            "output": "4876574\n"
        },
        {
            "input": "1\n1292643 3\n",
            "output": "1292911\n"
        },
        {
            "input": "1\n3506626 8\n",
            "output": "3506626\n"
        },
        {
            "input": "1\n156146 5\n",
            "output": "156146\n"
        },
        {
            "input": "1\n4876572 1\n",
            "output": "5555555\n"
        },
        {
            "input": "1\n2034399 3\n",
            "output": "2040000\n"
        },
        {
            "input": "1\n3138495 8\n",
            "output": "3138495\n"
        },
        {
            "input": "1\n1807417 1\n",
            "output": "2222222\n"
        },
        {
            "input": "1\n2034399 5\n",
            "output": "2034399\n"
        },
        {
            "input": "1\n2266501 1\n",
            "output": "3333333\n"
        },
        {
            "input": "1\n448683 5\n",
            "output": "448683\n"
        },
        {
            "input": "1\n37388 10\n",
            "output": "37388\n"
        },
        {
            "input": "1\n954385 1\n",
            "output": "999999\n"
        },
        {
            "input": "1\n5728 10\n",
            "output": "5728\n"
        },
        {
            "input": "1\n691217 8\n",
            "output": "691217\n"
        },
        {
            "input": "1\n962994 8\n",
            "output": "962994\n"
        },
        {
            "input": "1\n1332328 2\n",
            "output": "1333111\n"
        },
        {
            "input": "1\n1249981 8\n",
            "output": "1249981\n"
        },
        {
            "input": "1\n1332328 4\n",
            "output": "1332328\n"
        },
        {
            "input": "1\n2066505 8\n",
            "output": "2066505\n"
        },
        {
            "input": "1\n38249 1\n",
            "output": "44444\n"
        },
        {
            "input": "1\n2775919 7\n",
            "output": "2775919\n"
        },
        {
            "input": "1\n38249 2\n",
            "output": "38333\n"
        },
        {
            "input": "1\n4614203 7\n",
            "output": "4614203\n"
        },
        {
            "input": "1\n28066 2\n",
            "output": "28222\n"
        },
        {
            "input": "1\n4614203 5\n",
            "output": "4614204\n"
        },
        {
            "input": "1\n28066 3\n",
            "output": "28080\n"
        },
        {
            "input": "1\n35037 3\n",
            "output": "35050\n"
        },
        {
            "input": "1\n1484416 6\n",
            "output": "1484416\n"
        },
        {
            "input": "1\n1484416 2\n",
            "output": "1511111\n"
        },
        {
            "input": "1\n1091735 2\n",
            "output": "1100000\n"
        },
        {
            "input": "1\n1091735 1\n",
            "output": "1111111\n"
        },
        {
            "input": "1\n616184 1\n",
            "output": "666666\n"
        },
        {
            "input": "1\n11961857 3\n",
            "output": "11961911\n"
        },
        {
            "input": "1\n3330099 3\n",
            "output": "3330099\n"
        },
        {
            "input": "1\n1598379 3\n",
            "output": "1599111\n"
        },
        {
            "input": "1\n114514 3\n",
            "output": "114514\n"
        },
        {
            "input": "1\n2010326 2\n",
            "output": "2020000\n"
        },
        {
            "input": "6\n2021 3\n177890 2\n34512 3\n724533 4\n998244353 1\n12345678 9\n",
            "output": "2021\n181111\n34533\n724542\n999999999\n12345678\n"
        },
        {
            "input": "1\n1533832 4\n",
            "output": "1533833\n"
        },
        {
            "input": "1\n320958 9\n",
            "output": "320958\n"
        },
        {
            "input": "1\n1230839 4\n",
            "output": "1231000\n"
        },
        {
            "input": "1\n1380207 5\n",
            "output": "1380208\n"
        },
        {
            "input": "1\n723048 6\n",
            "output": "723048\n"
        },
        {
            "input": "1\n185903 6\n",
            "output": "185903\n"
        },
        {
            "input": "1\n2909865 9\n",
            "output": "2909865\n"
        },
        {
            "input": "1\n1229193 3\n",
            "output": "1229199\n"
        },
        {
            "input": "1\n298856 5\n",
            "output": "298856\n"
        },
        {
            "input": "1\n4876572 3\n",
            "output": "4877444\n"
        },
        {
            "input": "1\n756920 3\n",
            "output": "757000\n"
        },
        {
            "input": "1\n5583246 8\n",
            "output": "5583246\n"
        },
        {
            "input": "1\n289903 5\n",
            "output": "289903\n"
        },
        {
            "input": "1\n3913993 8\n",
            "output": "3913993\n"
        },
        {
            "input": "1\n1807417 2\n",
            "output": "1811111\n"
        },
        {
            "input": "1\n1996383 5\n",
            "output": "1996383\n"
        },
        {
            "input": "1\n5921172 10\n",
            "output": "5921172\n"
        },
        {
            "input": "1\n2266501 2\n",
            "output": "2266622\n"
        },
        {
            "input": "1\n448683 1\n",
            "output": "555555\n"
        },
        {
            "input": "1\n688 10\n",
            "output": "688\n"
        },
        {
            "input": "1\n123241 1\n",
            "output": "222222\n"
        },
        {
            "input": "1\n998610 8\n",
            "output": "998610\n"
        },
        {
            "input": "1\n1584322 8\n",
            "output": "1584322\n"
        },
        {
            "input": "1\n1332328 3\n",
            "output": "1332331\n"
        },
        {
            "input": "1\n851800 4\n",
            "output": "851800\n"
        },
        {
            "input": "1\n2848238 8\n",
            "output": "2848238\n"
        },
        {
            "input": "1\n5425581 7\n",
            "output": "5425581\n"
        },
        {
            "input": "1\n8315125 7\n",
            "output": "8315125\n"
        },
        {
            "input": "1\n46403 2\n",
            "output": "46444\n"
        },
        {
            "input": "1\n28066 5\n",
            "output": "28066\n"
        },
        {
            "input": "1\n2332172 6\n",
            "output": "2332172\n"
        },
        {
            "input": "1\n35037 2\n",
            "output": "35333\n"
        },
        {
            "input": "1\n616184 2\n",
            "output": "616611\n"
        },
        {
            "input": "1\n495286 3\n",
            "output": "495444\n"
        },
        {
            "input": "1\n155908 3\n",
            "output": "155911\n"
        },
        {
            "input": "1\n444006 2\n",
            "output": "444040\n"
        },
        {
            "input": "6\n2021 3\n177890 2\n34512 3\n724533 5\n998244353 1\n12345678 9\n",
            "output": "2021\n181111\n34533\n724533\n999999999\n12345678\n"
        },
        {
            "input": "1\n320958 1\n",
            "output": "333333\n"
        },
        {
            "input": "1\n2405415 4\n",
            "output": "2405420\n"
        },
        {
            "input": "1\n3738667 1\n",
            "output": "4444444\n"
        },
        {
            "input": "1\n1395332 5\n",
            "output": "1395332\n"
        },
        {
            "input": "1\n152872 6\n",
            "output": "152872\n"
        },
        {
            "input": "1\n1726631 7\n",
            "output": "1726631\n"
        },
        {
            "input": "1\n3041793 3\n",
            "output": "3043000\n"
        },
        {
            "input": "1\n756920 1\n",
            "output": "777777\n"
        },
        {
            "input": "1\n5583246 4\n",
            "output": "5583252\n"
        },
        {
            "input": "1\n490401 5\n",
            "output": "490401\n"
        },
        {
            "input": "1\n640167 6\n",
            "output": "640167\n"
        },
        {
            "input": "1\n1807417 3\n",
            "output": "1808000\n"
        },
        {
            "input": "1\n7181551 10\n",
            "output": "7181551\n"
        },
        {
            "input": "1\n2266501 3\n",
            "output": "2266522\n"
        },
        {
            "input": "1\n58301 1\n",
            "output": "66666\n"
        },
        {
            "input": "1\n938239 2\n",
            "output": "939333\n"
        },
        {
            "input": "1\n891658 9\n",
            "output": "891658\n"
        },
        {
            "input": "1\n701 10\n",
            "output": "701\n"
        },
        {
            "input": "1\n5828 1\n",
            "output": "6666\n"
        },
        {
            "input": "1\n1092187 8\n",
            "output": "1092187\n"
        },
        {
            "input": "1\n1665073 8\n",
            "output": "1665073\n"
        },
        {
            "input": "1\n2118422 2\n",
            "output": "2121111\n"
        },
        {
            "input": "1\n52742 2\n",
            "output": "53333\n"
        },
        {
            "input": "1\n27327 3\n",
            "output": "27327\n"
        },
        {
            "input": "1\n1054132 6\n",
            "output": "1054132\n"
        },
        {
            "input": "1\n2381070 2\n",
            "output": "2422222\n"
        },
        {
            "input": "1\n1114783 2\n",
            "output": "1115111\n"
        },
        {
            "input": "1\n495286 4\n",
            "output": "495292\n"
        },
        {
            "input": "1\n217070 3\n",
            "output": "217111\n"
        },
        {
            "input": "1\n444006 3\n",
            "output": "444006\n"
        },
        {
            "input": "1\n517337 2\n",
            "output": "522222\n"
        },
        {
            "input": "1\n373166 1\n",
            "output": "444444\n"
        },
        {
            "input": "1\n2405415 8\n",
            "output": "2405415\n"
        },
        {
            "input": "1\n2715901 5\n",
            "output": "2715911\n"
        },
        {
            "input": "1\n152872 3\n",
            "output": "153111\n"
        },
        {
            "input": "1\n3041793 4\n",
            "output": "3042000\n"
        },
        {
            "input": "1\n7943399 4\n",
            "output": "7943399\n"
        },
        {
            "input": "1\n1234799 6\n",
            "output": "1234799\n"
        },
        {
            "input": "1\n993475 7\n",
            "output": "993475\n"
        },
        {
            "input": "1\n1807417 5\n",
            "output": "1807417\n"
        },
        {
            "input": "1\n2140873 8\n",
            "output": "2140873\n"
        },
        {
            "input": "1\n7749811 10\n",
            "output": "7749811\n"
        },
        {
            "input": "1\n593455 2\n",
            "output": "595555\n"
        },
        {
            "input": "1\n984589 9\n",
            "output": "984589\n"
        },
        {
            "input": "1\n9772 1\n",
            "output": "9999\n"
        },
        {
            "input": "1\n761673 8\n",
            "output": "761673\n"
        },
        {
            "input": "1\n4955 2\n",
            "output": "4994\n"
        },
        {
            "input": "1\n44210 3\n",
            "output": "44211\n"
        },
        {
            "input": "1\n3819859 2\n",
            "output": "3833333\n"
        },
        {
            "input": "1\n1850849 2\n",
            "output": "1881111\n"
        },
        {
            "input": "1\n298799 3\n",
            "output": "298822\n"
        },
        {
            "input": "6\n2021 3\n122784 2\n34512 3\n724533 7\n998244353 1\n12345678 9\n",
            "output": "2021\n131111\n34533\n724533\n999999999\n12345678\n"
        },
        {
            "input": "1\n386612 2\n",
            "output": "388333\n"
        },
        {
            "input": "1\n3645493 5\n",
            "output": "3645493\n"
        },
        {
            "input": "1\n286658 3\n",
            "output": "286662\n"
        },
        {
            "input": "1\n182481 4\n",
            "output": "182481\n"
        },
        {
            "input": "1\n328398 2\n",
            "output": "330000\n"
        },
        {
            "input": "1\n184029 4\n",
            "output": "184040\n"
        },
        {
            "input": "1\n1474792 6\n",
            "output": "1474792\n"
        },
        {
            "input": "1\n2588478 5\n",
            "output": "2588478\n"
        },
        {
            "input": "1\n615752 2\n",
            "output": "616111\n"
        },
        {
            "input": "1\n932194 9\n",
            "output": "932194\n"
        },
        {
            "input": "1\n12035 1\n",
            "output": "22222\n"
        },
        {
            "input": "1\n213038 8\n",
            "output": "213038\n"
        },
        {
            "input": "1\n2388 2\n",
            "output": "2422\n"
        },
        {
            "input": "1\n16827 3\n",
            "output": "16861\n"
        },
        {
            "input": "1\n180194 9\n",
            "output": "180194\n"
        },
        {
            "input": "1\n3819859 3\n",
            "output": "3822222\n"
        },
        {
            "input": "1\n298799 6\n",
            "output": "298799\n"
        },
        {
            "input": "6\n2021 3\n122784 2\n34512 3\n724533 7\n998244353 1\n12345678 1\n",
            "output": "2021\n131111\n34533\n724533\n999999999\n22222222\n"
        },
        {
            "input": "1\n271179 2\n",
            "output": "272222\n"
        },
        {
            "input": "1\n543446 2\n",
            "output": "544444\n"
        },
        {
            "input": "1\n4100573 5\n",
            "output": "4100574\n"
        },
        {
            "input": "1\n173575 3\n",
            "output": "173711\n"
        },
        {
            "input": "1\n153765 4\n",
            "output": "153771\n"
        },
        {
            "input": "1\n178370 2\n",
            "output": "181111\n"
        },
        {
            "input": "1\n47711 4\n",
            "output": "47711\n"
        },
        {
            "input": "1\n2190713 6\n",
            "output": "2190713\n"
        },
        {
            "input": "1\n347343 10\n",
            "output": "347343\n"
        },
        {
            "input": "1\n555110 5\n",
            "output": "555110\n"
        },
        {
            "input": "1\n1173600 2\n",
            "output": "1177111\n"
        },
        {
            "input": "1\n213038 2\n",
            "output": "220000\n"
        },
        {
            "input": "1\n3562366 2\n",
            "output": "3633333\n"
        },
        {
            "input": "1\n2388 4\n",
            "output": "2388\n"
        },
        {
            "input": "1\n21711 3\n",
            "output": "21711\n"
        },
        {
            "input": "1\n4126977 3\n",
            "output": "4131111\n"
        },
        {
            "input": "1\n1850849 3\n",
            "output": "1851111\n"
        },
        {
            "input": "6\n2021 3\n122784 2\n34512 3\n963120 7\n998244353 1\n12345678 1\n",
            "output": "2021\n131111\n34533\n963120\n999999999\n22222222\n"
        },
        {
            "input": "1\n442801 2\n",
            "output": "443333\n"
        },
        {
            "input": "1\n844189 5\n",
            "output": "844189\n"
        },
        {
            "input": "1\n173575 2\n",
            "output": "177111\n"
        },
        {
            "input": "1\n83267 4\n",
            "output": "83268\n"
        },
        {
            "input": "1\n11976 2\n",
            "output": "11991\n"
        },
        {
            "input": "1\n15407 4\n",
            "output": "15410\n"
        },
        {
            "input": "1\n2190713 3\n",
            "output": "2191111\n"
        },
        {
            "input": "1\n2318 10\n",
            "output": "2318\n"
        },
        {
            "input": "1\n1077232 5\n",
            "output": "1077232\n"
        },
        {
            "input": "1\n1328827 2\n",
            "output": "1331111\n"
        },
        {
            "input": "1\n932194 3\n",
            "output": "932222\n"
        },
        {
            "input": "1\n277406 2\n",
            "output": "277722\n"
        },
        {
            "input": "1\n4410751 2\n",
            "output": "4411111\n"
        },
        {
            "input": "1\n2388 1\n",
            "output": "3333\n"
        },
        {
            "input": "1\n2328 3\n",
            "output": "2328\n"
        },
        {
            "input": "1\n30960 1\n",
            "output": "33333\n"
        },
        {
            "input": "6\n2300 3\n122784 2\n34512 3\n963120 7\n998244353 1\n12345678 1\n",
            "output": "2300\n131111\n34533\n963120\n999999999\n22222222\n"
        },
        {
            "input": "1\n844189 2\n",
            "output": "844444\n"
        },
        {
            "input": "1\n110728 2\n",
            "output": "111000\n"
        },
        {
            "input": "1\n83267 6\n",
            "output": "83267\n"
        },
        {
            "input": "1\n1727 2\n",
            "output": "1771\n"
        },
        {
            "input": "1\n13218 4\n",
            "output": "13218\n"
        }
    ]
}