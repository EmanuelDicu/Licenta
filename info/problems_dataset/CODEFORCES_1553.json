{
    "name": "1553_I. Stairs",
    "source": "CODEFORCES",
    "description": "For a permutation p of numbers 1 through n, we define a stair array a as follows: a_i is length of the longest segment of permutation which contains position i and is made of consecutive values in sorted order: [x, x+1, \u2026, y-1, y] or [y, y-1, \u2026, x+1, x] for some x \u2264 y. For example, for permutation p = [4, 1, 2, 3, 7, 6, 5] we have a = [1, 3, 3, 3, 3, 3, 3]. \n\nYou are given the stair array a. Your task is to calculate the number of permutations which have stair array equal to a. Since the number can be big, compute it modulo 998 244 353. Note that this number can be equal to zero.\n\nInput\n\nThe first line of input contains integer n (1 \u2264 n \u2264 10^5) \u2014 the length of a stair array a.\n\nThe second line of input contains n integers a_1, a_2, \u2026, a_n (1 \u2264 a_i \u2264 n).\n\nOutput\n\nPrint the number of permutations which have stair array equal to a. Since the number can be big, compute it modulo 998 244 353.\n\nExamples\n\nInput\n\n\n6\n3 3 3 1 1 1\n\n\nOutput\n\n\n6\n\n\nInput\n\n\n7\n4 4 4 4 3 3 3\n\n\nOutput\n\n\n6\n\n\nInput\n\n\n1\n1\n\n\nOutput\n\n\n1\n\n\nInput\n\n\n8\n2 2 2 2 2 2 1 1\n\n\nOutput\n\n\n370\n\n\nInput\n\n\n4\n3 2 3 1\n\n\nOutput\n\n\n0",
    "difficulty": "I",
    "tags": [
        "combinatorics",
        "divide and conquer",
        "dp",
        "fft",
        "math"
    ],
    "rating": 3400,
    "public_test": [
        {
            "input": "1\n1\n",
            "output": "1\n"
        },
        {
            "input": "4\n3 2 3 1\n",
            "output": "0\n"
        },
        {
            "input": "8\n2 2 2 2 2 2 1 1\n",
            "output": "370\n"
        },
        {
            "input": "6\n3 3 3 1 1 1\n",
            "output": "6\n"
        },
        {
            "input": "7\n4 4 4 4 3 3 3\n",
            "output": "6\n"
        }
    ],
    "generated_test": [
        {
            "input": "4\n5 2 3 1\n",
            "output": "0\n"
        },
        {
            "input": "4\n3 3 3 1\n",
            "output": "2\n"
        },
        {
            "input": "7\n4 4 4 5 3 3 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 2 3 2\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 4 2 5 3 3 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 3 3 2\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 3 0 2\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 3 -1 2\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 0 -1 2\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 0 -2 2\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 4 4 8 3 3 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n6 2 3 1\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 4 3 5 3 3 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 2 3 4\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 4 2 5 5 3 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 3 -1 4\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 0 0 2\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 5 -1 2\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 0 -1 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 0 -2 3\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 3 4 8 3 3 3\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 4 5 5 3 3 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n6 2 3 4\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 4 1 5 5 3 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 3 -1 6\n",
            "output": "0\n"
        },
        {
            "input": "4\n10 0 0 2\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 1 -1 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 0 -4 3\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 3 4 8 3 2 3\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 4 5 3 3 3 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n10 2 3 4\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 4 0 5 5 3 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 3 -1 7\n",
            "output": "0\n"
        },
        {
            "input": "4\n19 0 0 2\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 1 -4 3\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 3 4 8 4 2 3\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 4 5 3 3 4 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n10 2 6 4\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 4 0 6 5 3 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 3 0 7\n",
            "output": "0\n"
        },
        {
            "input": "4\n19 1 0 2\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 0 -4 5\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 3 7 8 4 2 3\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 7 5 3 3 4 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n10 3 6 4\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 4 0 6 10 3 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 3 1 7\n",
            "output": "0\n"
        },
        {
            "input": "4\n19 1 1 2\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 1 -4 5\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 3 7 8 1 2 3\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 7 1 3 3 4 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n10 0 6 4\n",
            "output": "0\n"
        },
        {
            "input": "4\n1 3 1 7\n",
            "output": "0\n"
        },
        {
            "input": "4\n19 0 1 2\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 1 -4 10\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 3 7 2 1 2 3\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 7 1 3 1 4 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n10 1 6 4\n",
            "output": "0\n"
        },
        {
            "input": "4\n1 3 2 7\n",
            "output": "0\n"
        },
        {
            "input": "4\n19 -1 1 2\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 1 -2 10\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 3 0 2 1 2 3\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 7 1 5 1 4 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n2 2 6 4\n",
            "output": "0\n"
        },
        {
            "input": "4\n1 3 2 6\n",
            "output": "0\n"
        },
        {
            "input": "4\n19 -2 1 2\n",
            "output": "0\n"
        },
        {
            "input": "4\n6 1 -2 10\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 3 0 2 1 2 6\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 7 1 6 1 4 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n2 2 6 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n1 4 2 6\n",
            "output": "0\n"
        },
        {
            "input": "4\n19 -2 1 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n4 1 -2 10\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 3 0 2 1 2 12\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 7 2 6 1 4 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n1 4 2 2\n",
            "output": "0\n"
        },
        {
            "input": "4\n19 -2 1 1\n",
            "output": "0\n"
        },
        {
            "input": "4\n4 1 -2 3\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 0 0 2 1 2 12\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 9 2 6 1 4 3\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 9 3 6 1 4 3\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 4 3 6 1 4 3\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 7 3 6 1 4 3\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 2 3 6 1 4 3\n",
            "output": "0\n"
        },
        {
            "input": "8\n2 2 2 3 2 2 1 1\n",
            "output": "0\n"
        },
        {
            "input": "6\n6 3 3 1 1 1\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 4 4 4 3 3 5\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 1 3 1\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 4 0 5 3 3 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 2 0 2\n",
            "output": "0\n"
        },
        {
            "input": "7\n3 4 2 5 3 3 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n8 3 3 2\n",
            "output": "0\n"
        },
        {
            "input": "4\n9 3 0 2\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 4 -1 2\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 0 -1 1\n",
            "output": "0\n"
        },
        {
            "input": "4\n10 0 -2 2\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 4 4 13 3 3 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n6 3 3 1\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 6 3 5 3 3 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 2 0 4\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 4 2 5 5 3 1\n",
            "output": "0\n"
        },
        {
            "input": "4\n8 3 -1 4\n",
            "output": "0\n"
        },
        {
            "input": "4\n10 0 1 2\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 5 0 2\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 -1 -2 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 -1 -2 2\n",
            "output": "0\n"
        },
        {
            "input": "7\n5 3 4 8 3 3 3\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 4 5 5 3 1 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n7 2 3 4\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 7 1 5 5 3 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 3 0 6\n",
            "output": "0\n"
        },
        {
            "input": "4\n10 1 -1 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 -1 -4 3\n",
            "output": "0\n"
        },
        {
            "input": "7\n8 3 4 8 3 3 3\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 3 5 3 3 3 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n1 2 3 4\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 4 0 5 5 3 4\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 4 -1 7\n",
            "output": "0\n"
        },
        {
            "input": "4\n19 1 2 2\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 1 -4 4\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 3 4 1 4 2 3\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 4 5 4 3 4 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n10 4 6 4\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 3 0 6 5 3 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 3 0 13\n",
            "output": "0\n"
        },
        {
            "input": "4\n11 1 2 2\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 0 -2 5\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 3 7 7 4 2 3\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 14 5 3 3 4 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n10 3 6 1\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 4 -1 6 10 3 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n36 1 1 2\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 1 -4 7\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 3 7 12 1 2 3\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 7 1 6 3 4 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n10 0 5 4\n",
            "output": "0\n"
        },
        {
            "input": "4\n29 -1 1 2\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 1 -6 10\n",
            "output": "0\n"
        },
        {
            "input": "7\n2 3 7 2 1 2 3\n",
            "output": "0\n"
        },
        {
            "input": "7\n7 7 1 3 1 4 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n15 1 6 4\n",
            "output": "0\n"
        },
        {
            "input": "4\n1 4 2 7\n",
            "output": "0\n"
        },
        {
            "input": "4\n19 -1 2 2\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 1 -2 20\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 3 0 1 1 2 3\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 1 1 5 1 4 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n4 2 6 4\n",
            "output": "0\n"
        },
        {
            "input": "4\n1 3 2 11\n",
            "output": "0\n"
        },
        {
            "input": "4\n2 -2 1 2\n",
            "output": "0\n"
        },
        {
            "input": "4\n6 2 -2 10\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 3 -1 2 1 2 6\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 7 1 6 1 8 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n1 4 2 9\n",
            "output": "0\n"
        },
        {
            "input": "4\n19 -2 0 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n4 1 -2 13\n",
            "output": "0\n"
        },
        {
            "input": "7\n6 3 0 2 1 2 12\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 7 2 11 1 4 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n1 4 0 2\n",
            "output": "0\n"
        },
        {
            "input": "4\n19 -4 1 1\n",
            "output": "0\n"
        },
        {
            "input": "4\n4 1 0 3\n",
            "output": "0\n"
        },
        {
            "input": "7\n2 9 2 6 1 4 3\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 9 3 6 1 4 4\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 4 3 11 1 4 3\n",
            "output": "0\n"
        },
        {
            "input": "7\n8 7 3 6 1 4 3\n",
            "output": "0\n"
        },
        {
            "input": "7\n7 2 3 6 1 4 3\n",
            "output": "0\n"
        },
        {
            "input": "8\n2 2 2 3 4 2 1 1\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 4 4 4 3 2 5\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 1 1 1\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 6 0 5 3 3 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 0 0 4\n",
            "output": "0\n"
        },
        {
            "input": "7\n3 6 2 5 3 3 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n8 5 3 2\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 2 -1 2\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 1 -1 1\n",
            "output": "0\n"
        },
        {
            "input": "4\n10 -1 -2 2\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 4 3 13 3 3 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n1 3 3 1\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 6 3 5 3 3 6\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 3 0 4\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 0 2 5 5 3 1\n",
            "output": "0\n"
        },
        {
            "input": "4\n10 3 -1 4\n",
            "output": "0\n"
        },
        {
            "input": "4\n23 0 1 2\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 9 0 2\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 -2 -2 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n6 -1 -2 2\n",
            "output": "0\n"
        },
        {
            "input": "7\n5 3 4 8 5 3 3\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 4 2 5 3 1 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n7 2 1 4\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 7 1 1 5 3 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n1 3 0 6\n",
            "output": "0\n"
        },
        {
            "input": "4\n10 0 -1 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 -2 -4 3\n",
            "output": "0\n"
        },
        {
            "input": "7\n8 6 4 8 3 3 3\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 3 2 3 3 3 3\n",
            "output": "0\n"
        },
        {
            "input": "4\n2 2 3 4\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 4 0 5 5 3 2\n",
            "output": "0\n"
        },
        {
            "input": "4\n3 4 -1 7\n",
            "output": "0\n"
        },
        {
            "input": "4\n19 2 2 2\n",
            "output": "0\n"
        },
        {
            "input": "4\n5 1 0 4\n",
            "output": "0\n"
        },
        {
            "input": "7\n4 3 4 2 4 2 3\n",
            "output": "0\n"
        }
    ]
}