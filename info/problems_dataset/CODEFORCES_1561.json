{
    "name": "1561_D2. Up the Strip",
    "source": "CODEFORCES",
    "description": "Note that the memory limit in this problem is lower than in others.\n\nYou have a vertical strip with n cells, numbered consecutively from 1 to n from top to bottom.\n\nYou also have a token that is initially placed in cell n. You will move the token up until it arrives at cell 1.\n\nLet the token be in cell x > 1 at some moment. One shift of the token can have either of the following kinds: \n\n  * Subtraction: you choose an integer y between 1 and x-1, inclusive, and move the token from cell x to cell x - y. \n  * Floored division: you choose an integer z between 2 and x, inclusive, and move the token from cell x to cell \u230a x/z \u230b (x divided by z rounded down). \n\n\n\nFind the number of ways to move the token from cell n to cell 1 using one or more shifts, and print it modulo m. Note that if there are several ways to move the token from one cell to another in one shift, all these ways are considered distinct (check example explanation for a better understanding).\n\nInput\n\nThe only line contains two integers n and m (2 \u2264 n \u2264 4 \u22c5 10^6; 10^8 < m < 10^9; m is a prime number) \u2014 the length of the strip and the modulo.\n\nOutput\n\nPrint the number of ways to move the token from cell n to cell 1, modulo m.\n\nExamples\n\nInput\n\n\n3 998244353\n\n\nOutput\n\n\n5\n\n\nInput\n\n\n5 998244353\n\n\nOutput\n\n\n25\n\n\nInput\n\n\n42 998244353\n\n\nOutput\n\n\n793019428\n\n\nInput\n\n\n787788 100000007\n\n\nOutput\n\n\n94810539\n\nNote\n\nIn the first test, there are three ways to move the token from cell 3 to cell 1 in one shift: using subtraction of y = 2, or using division by z = 2 or z = 3.\n\nThere are also two ways to move the token from cell 3 to cell 1 via cell 2: first subtract y = 1, and then either subtract y = 1 again or divide by z = 2.\n\nTherefore, there are five ways in total.",
    "difficulty": "D",
    "tags": [
        "brute force",
        "dp",
        "math",
        "number theory"
    ],
    "rating": 1900,
    "public_test": [
        {
            "input": "3 998244353\n",
            "output": "5"
        },
        {
            "input": "42 998244353\n",
            "output": "793019428"
        },
        {
            "input": "787788 100000007\n",
            "output": "94810539"
        },
        {
            "input": "5 998244353\n",
            "output": "25"
        }
    ],
    "generated_test": [
        {
            "input": "182550 754401678\n",
            "output": "331750090\n"
        },
        {
            "input": "93 318786553\n",
            "output": "3834838\n"
        },
        {
            "input": "363 791893607\n",
            "output": "297147181\n"
        },
        {
            "input": "3912472 307193683\n",
            "output": "149191773\n"
        },
        {
            "input": "104450 998244353\n",
            "output": "806661494\n"
        },
        {
            "input": "6 879902963\n",
            "output": "55\n"
        },
        {
            "input": "30249 936347479\n",
            "output": "142140502\n"
        },
        {
            "input": "2924225 466256901\n",
            "output": "96875854\n"
        },
        {
            "input": "69843 463252301\n",
            "output": "422573163\n"
        },
        {
            "input": "2383 248535541\n",
            "output": "32560999\n"
        },
        {
            "input": "2525447 612881327\n",
            "output": "368194805\n"
        },
        {
            "input": "4 1022845464\n",
            "output": "12\n"
        },
        {
            "input": "4000000 183642095\n",
            "output": "22912955\n"
        },
        {
            "input": "3 1745482103\n",
            "output": "5\n"
        },
        {
            "input": "42 182096533\n",
            "output": "150614713\n"
        },
        {
            "input": "787788 40344335\n",
            "output": "13963078\n"
        },
        {
            "input": "5 1823748024\n",
            "output": "25\n"
        },
        {
            "input": "182550 259156327\n",
            "output": "23231734\n"
        },
        {
            "input": "93 447734838\n",
            "output": "32270285\n"
        },
        {
            "input": "104450 147098549\n",
            "output": "79900151\n"
        },
        {
            "input": "8 879902963\n",
            "output": "231\n"
        },
        {
            "input": "2924225 629135317\n",
            "output": "498731287\n"
        },
        {
            "input": "69843 799260826\n",
            "output": "715019339\n"
        },
        {
            "input": "1106 248535541\n",
            "output": "238535103\n"
        },
        {
            "input": "3175292 612881327\n",
            "output": "609803727\n"
        },
        {
            "input": "2 1745482103\n",
            "output": "2\n"
        },
        {
            "input": "31 182096533\n",
            "output": "23516106\n"
        },
        {
            "input": "787788 44544120\n",
            "output": "10298823\n"
        },
        {
            "input": "182550 356939314\n",
            "output": "33287744\n"
        },
        {
            "input": "77 447734838\n",
            "output": "278525249\n"
        },
        {
            "input": "104450 29817370\n",
            "output": "19290250\n"
        },
        {
            "input": "9 879902963\n",
            "output": "466\n"
        },
        {
            "input": "2924225 78749238\n",
            "output": "64277353\n"
        },
        {
            "input": "101599 799260826\n",
            "output": "467453677\n"
        },
        {
            "input": "653 248535541\n",
            "output": "66084596\n"
        },
        {
            "input": "2984980 612881327\n",
            "output": "547104902\n"
        },
        {
            "input": "31 213877682\n",
            "output": "101678831\n"
        },
        {
            "input": "787788 43068696\n",
            "output": "21525519\n"
        },
        {
            "input": "182550 673535321\n",
            "output": "562002790\n"
        },
        {
            "input": "77 439653971\n",
            "output": "14989602\n"
        },
        {
            "input": "104450 44764019\n",
            "output": "11645004\n"
        },
        {
            "input": "186221 799260826\n",
            "output": "277058979\n"
        },
        {
            "input": "346 248535541\n",
            "output": "75903713\n"
        },
        {
            "input": "1185887 612881327\n",
            "output": "20242229\n"
        },
        {
            "input": "31 193044863\n",
            "output": "96129339\n"
        },
        {
            "input": "787788 75141983\n",
            "output": "38444895\n"
        },
        {
            "input": "227600 673535321\n",
            "output": "417031934\n"
        },
        {
            "input": "89 439653971\n",
            "output": "432690230\n"
        },
        {
            "input": "118564 44764019\n",
            "output": "10860768\n"
        },
        {
            "input": "186221 190113066\n",
            "output": "167300161\n"
        },
        {
            "input": "630 248535541\n",
            "output": "69612322\n"
        },
        {
            "input": "1185887 820168200\n",
            "output": "599059054\n"
        },
        {
            "input": "31 250865928\n",
            "output": "19650545\n"
        },
        {
            "input": "716714 75141983\n",
            "output": "71308850\n"
        },
        {
            "input": "15 1116240308\n",
            "output": "30793\n"
        },
        {
            "input": "227600 997062914\n",
            "output": "159596758\n"
        },
        {
            "input": "165 439653971\n",
            "output": "110178601\n"
        },
        {
            "input": "212169 44764019\n",
            "output": "38923596\n"
        },
        {
            "input": "186221 248736626\n",
            "output": "109267203\n"
        },
        {
            "input": "1116 248535541\n",
            "output": "198441612\n"
        },
        {
            "input": "10 250865928\n",
            "output": "947\n"
        },
        {
            "input": "716714 9396539\n",
            "output": "3092228\n"
        },
        {
            "input": "227600 604116569\n",
            "output": "548651355\n"
        },
        {
            "input": "150 439653971\n",
            "output": "87582893\n"
        },
        {
            "input": "212169 81610688\n",
            "output": "1183222\n"
        },
        {
            "input": "186221 473301202\n",
            "output": "194640529\n"
        },
        {
            "input": "1146 248535541\n",
            "output": "70112473\n"
        },
        {
            "input": "14 250865928\n",
            "output": "15388\n"
        },
        {
            "input": "367960 9396539\n",
            "output": "1830007\n"
        },
        {
            "input": "227600 14038108\n",
            "output": "948654\n"
        },
        {
            "input": "150 807177737\n",
            "output": "108423380\n"
        },
        {
            "input": "4152 81610688\n",
            "output": "30074061\n"
        },
        {
            "input": "11 50907741\n",
            "output": "1895\n"
        },
        {
            "input": "186221 514794851\n",
            "output": "508420149\n"
        },
        {
            "input": "1146 233873517\n",
            "output": "161815303\n"
        },
        {
            "input": "367960 6657520\n",
            "output": "6110527\n"
        },
        {
            "input": "227600 27497781\n",
            "output": "21736379\n"
        },
        {
            "input": "24 807177737\n",
            "output": "15830909\n"
        },
        {
            "input": "4152 46369125\n",
            "output": "1140634\n"
        },
        {
            "input": "186221 19810836\n",
            "output": "7472617\n"
        },
        {
            "input": "1146 6967396\n",
            "output": "912187\n"
        },
        {
            "input": "163040 6657520\n",
            "output": "2064610\n"
        },
        {
            "input": "156823 27497781\n",
            "output": "11285900\n"
        },
        {
            "input": "17 807177737\n",
            "output": "123431\n"
        },
        {
            "input": "6948 46369125\n",
            "output": "997242\n"
        },
        {
            "input": "301385 19810836\n",
            "output": "2528500\n"
        },
        {
            "input": "166 6967396\n",
            "output": "6512293\n"
        },
        {
            "input": "163040 1542905\n",
            "output": "631025\n"
        },
        {
            "input": "156823 29246228\n",
            "output": "25289685\n"
        },
        {
            "input": "12331 46369125\n",
            "output": "43386667\n"
        },
        {
            "input": "75058 19810836\n",
            "output": "5744960\n"
        },
        {
            "input": "166 10580968\n",
            "output": "552545\n"
        },
        {
            "input": "163040 396627\n",
            "output": "105423\n"
        },
        {
            "input": "156823 21780074\n",
            "output": "4352617\n"
        },
        {
            "input": "12331 61732484\n",
            "output": "577901\n"
        },
        {
            "input": "75058 15541748\n",
            "output": "2940888\n"
        },
        {
            "input": "261 10580968\n",
            "output": "3886965\n"
        },
        {
            "input": "94537 396627\n",
            "output": "250428\n"
        },
        {
            "input": "156823 22900124\n",
            "output": "11065121\n"
        },
        {
            "input": "20 17989931\n",
            "output": "989033\n"
        },
        {
            "input": "12331 79765391\n",
            "output": "32043942\n"
        },
        {
            "input": "42983 15541748\n",
            "output": "4504511\n"
        },
        {
            "input": "492 10580968\n",
            "output": "6622061\n"
        },
        {
            "input": "67942 396627\n",
            "output": "236326\n"
        },
        {
            "input": "156823 14860189\n",
            "output": "9185498\n"
        },
        {
            "input": "12331 117233745\n",
            "output": "93892702\n"
        },
        {
            "input": "42983 27829485\n",
            "output": "607808\n"
        },
        {
            "input": "492 3044541\n",
            "output": "1906814\n"
        },
        {
            "input": "67942 51199\n",
            "output": "4292\n"
        },
        {
            "input": "156823 8048341\n",
            "output": "394738\n"
        },
        {
            "input": "12331 83542833\n",
            "output": "63662263\n"
        },
        {
            "input": "41179 27829485\n",
            "output": "8091168\n"
        },
        {
            "input": "492 3323205\n",
            "output": "1736111\n"
        },
        {
            "input": "28599 51199\n",
            "output": "8838\n"
        },
        {
            "input": "206095 8048341\n",
            "output": "2597465\n"
        },
        {
            "input": "14052 83542833\n",
            "output": "2635117\n"
        },
        {
            "input": "67183 27829485\n",
            "output": "5252153\n"
        },
        {
            "input": "552 3323205\n",
            "output": "2824909\n"
        },
        {
            "input": "55258 51199\n",
            "output": "26614\n"
        },
        {
            "input": "10532 8048341\n",
            "output": "3299690\n"
        },
        {
            "input": "22769 83542833\n",
            "output": "10392111\n"
        },
        {
            "input": "67183 46989357\n",
            "output": "42900344\n"
        },
        {
            "input": "552 5092609\n",
            "output": "4054109\n"
        },
        {
            "input": "4941 51199\n",
            "output": "5524\n"
        },
        {
            "input": "19040 8048341\n",
            "output": "6583869\n"
        },
        {
            "input": "9248 83542833\n",
            "output": "4464453\n"
        },
        {
            "input": "67183 72452193\n",
            "output": "64858487\n"
        },
        {
            "input": "552 4024366\n",
            "output": "2604770\n"
        },
        {
            "input": "4941 51946\n",
            "output": "43303\n"
        },
        {
            "input": "17324 8048341\n",
            "output": "7197178\n"
        },
        {
            "input": "9248 139933488\n",
            "output": "111318681\n"
        },
        {
            "input": "67183 56504624\n",
            "output": "26373095\n"
        },
        {
            "input": "155 4024366\n",
            "output": "1783863\n"
        },
        {
            "input": "8271 51946\n",
            "output": "26105\n"
        },
        {
            "input": "17324 11981040\n",
            "output": "11164031\n"
        },
        {
            "input": "14261 139933488\n",
            "output": "39714764\n"
        },
        {
            "input": "128981 56504624\n",
            "output": "50954145\n"
        },
        {
            "input": "137 4024366\n",
            "output": "2031761\n"
        },
        {
            "input": "8271 37507\n",
            "output": "34813\n"
        },
        {
            "input": "23818 11981040\n",
            "output": "4537585\n"
        },
        {
            "input": "14261 157203681\n",
            "output": "105895505\n"
        },
        {
            "input": "128981 66633041\n",
            "output": "47281007\n"
        },
        {
            "input": "137 5368668\n",
            "output": "757071\n"
        },
        {
            "input": "5048 37507\n",
            "output": "27881\n"
        },
        {
            "input": "8782 11981040\n",
            "output": "8818471\n"
        },
        {
            "input": "2890 157203681\n",
            "output": "60777039\n"
        },
        {
            "input": "128981 70105743\n",
            "output": "28701894\n"
        },
        {
            "input": "152 5368668\n",
            "output": "5299211\n"
        },
        {
            "input": "5048 58721\n",
            "output": "41109\n"
        },
        {
            "input": "8782 19984674\n",
            "output": "13096249\n"
        },
        {
            "input": "2890 10972381\n",
            "output": "887484\n"
        },
        {
            "input": "128981 74610689\n",
            "output": "58240278\n"
        },
        {
            "input": "235 5368668\n",
            "output": "773188\n"
        },
        {
            "input": "5048 59691\n",
            "output": "9865\n"
        },
        {
            "input": "16473 19984674\n",
            "output": "3594421\n"
        },
        {
            "input": "2890 18871262\n",
            "output": "14193830\n"
        },
        {
            "input": "128981 73102034\n",
            "output": "65159059\n"
        },
        {
            "input": "235 4246068\n",
            "output": "67900\n"
        },
        {
            "input": "2093 59691\n",
            "output": "14622\n"
        },
        {
            "input": "11181 19984674\n",
            "output": "1897773\n"
        },
        {
            "input": "2842 18871262\n",
            "output": "9321592\n"
        },
        {
            "input": "128981 130346717\n",
            "output": "57100141\n"
        },
        {
            "input": "235 4532354\n",
            "output": "3151220\n"
        },
        {
            "input": "2093 15811\n",
            "output": "10040\n"
        },
        {
            "input": "11181 29399257\n",
            "output": "29105933\n"
        },
        {
            "input": "4878 18871262\n",
            "output": "17438843\n"
        },
        {
            "input": "245228 130346717\n",
            "output": "106184866\n"
        },
        {
            "input": "235 3157816\n",
            "output": "1967764\n"
        },
        {
            "input": "1106 15811\n",
            "output": "14198\n"
        },
        {
            "input": "20099 29399257\n",
            "output": "26022645\n"
        },
        {
            "input": "2404 18871262\n",
            "output": "13415858\n"
        },
        {
            "input": "195991 130346717\n",
            "output": "15298476\n"
        },
        {
            "input": "32 3157816\n",
            "output": "1709061\n"
        },
        {
            "input": "1106 1040\n",
            "output": "889\n"
        },
        {
            "input": "20099 41021268\n",
            "output": "26504895\n"
        },
        {
            "input": "1503 18871262\n",
            "output": "4814093\n"
        },
        {
            "input": "382631 130346717\n",
            "output": "46984815\n"
        },
        {
            "input": "32 940571\n",
            "output": "266550\n"
        },
        {
            "input": "801 1040\n",
            "output": "484\n"
        },
        {
            "input": "20663 41021268\n",
            "output": "19802861\n"
        },
        {
            "input": "1503 12982854\n",
            "output": "9342457\n"
        },
        {
            "input": "301059 130346717\n",
            "output": "118653078\n"
        },
        {
            "input": "54 940571\n",
            "output": "163916\n"
        },
        {
            "input": "215 1040\n",
            "output": "850\n"
        },
        {
            "input": "20663 51068843\n",
            "output": "25565449\n"
        },
        {
            "input": "1503 1021015\n",
            "output": "998577\n"
        },
        {
            "input": "446269 130346717\n",
            "output": "18572168\n"
        },
        {
            "input": "30 940571\n",
            "output": "294017\n"
        },
        {
            "input": "215 494\n",
            "output": "434\n"
        },
        {
            "input": "20663 4463170\n",
            "output": "324183\n"
        },
        {
            "input": "319 1021015\n",
            "output": "651991\n"
        },
        {
            "input": "446269 19193041\n",
            "output": "13282548\n"
        },
        {
            "input": "37 940571\n",
            "output": "825548\n"
        },
        {
            "input": "215 744\n",
            "output": "306\n"
        },
        {
            "input": "20663 5274903\n",
            "output": "4301723\n"
        },
        {
            "input": "633 1021015\n",
            "output": "464829\n"
        },
        {
            "input": "446269 7585633\n",
            "output": "2270773\n"
        },
        {
            "input": "22 744\n",
            "output": "610\n"
        },
        {
            "input": "28289 5274903\n",
            "output": "890933\n"
        },
        {
            "input": "633 1975331\n",
            "output": "1954828\n"
        }
    ]
}