{
    "name": "901_D. Weighting a Tree",
    "source": "CODEFORCES",
    "description": "You are given a connected undirected graph with n vertices and m edges. The vertices are enumerated from 1 to n. \n\nYou are given n integers c1, c2, ..., cn, each of them is between  - n and n, inclusive. It is also guaranteed that the parity of cv equals the parity of degree of vertex v. The degree of a vertex is the number of edges connected to it.\n\nYou are to write a weight between  - 2\u00b7n2 and 2\u00b7n2 (inclusive) on each edge in such a way, that for each vertex v the sum of weights on edges connected to this vertex is equal to cv, or determine that this is impossible.\n\nInput\n\nThe first line contains two integers n and m (2 \u2264 n \u2264 105, n - 1 \u2264 m \u2264 105) \u2014 the number of vertices and the number of edges.\n\nThe next line contains n integers c1, c2, ..., cn ( - n \u2264 ci \u2264 n), where ci is the required sum of weights of edges connected to vertex i. It is guaranteed that the parity of ci equals the parity of degree of vertex i.\n\nThe next m lines describe edges of the graph. The i-th of these lines contains two integers ai and bi (1 \u2264 ai, bi \u2264 n; ai \u2260 bi), meaning that the i-th edge connects vertices ai and bi.\n\nIt is guaranteed that the given graph is connected and does not contain loops and multiple edges.\n\nOutput\n\nIf there is no solution, print \"NO\".\n\nOtherwise print \"YES\" and then m lines, the i-th of them is the weight of the i-th edge wi ( - 2\u00b7n2 \u2264 wi \u2264 2\u00b7n2).\n\nExamples\n\nInput\n\n3 3\n2 2 2\n1 2\n2 3\n1 3\n\n\nOutput\n\nYES\n1\n1\n1\n\n\nInput\n\n4 3\n-1 0 2 1\n1 2\n2 3\n3 4\n\n\nOutput\n\nYES\n-1\n1\n1\n\n\nInput\n\n6 6\n3 5 5 5 1 5\n1 4\n3 2\n4 3\n4 5\n3 5\n5 6\n\n\nOutput\n\nYES\n3\n5\n3\n-1\n-3\n5\n\n\nInput\n\n4 4\n4 4 2 4\n1 2\n2 3\n3 4\n4 1\n\n\nOutput\n\nNO",
    "difficulty": "D",
    "tags": [
        "constructive algorithms",
        "dfs and similar",
        "graphs"
    ],
    "rating": 2700,
    "public_test": [
        {
            "input": "6 6\n3 5 5 5 1 5\n1 4\n3 2\n4 3\n4 5\n3 5\n5 6\n",
            "output": "YES\n                                                               3\n                                                               5\n                                                               3\n                                                              -1\n                                                              -3\n                                                               5\n"
        },
        {
            "input": "4 4\n4 4 2 4\n1 2\n2 3\n3 4\n4 1\n",
            "output": "NO\n"
        },
        {
            "input": "3 3\n2 2 2\n1 2\n2 3\n1 3\n",
            "output": "YES\n                                                               1\n                                                               1\n                                                               1\n"
        },
        {
            "input": "4 3\n-1 0 2 1\n1 2\n2 3\n3 4\n",
            "output": "YES\n                                                              -1\n                                                               1\n                                                               1\n"
        }
    ],
    "generated_test": [
        {
            "input": "8 12\n-6 2 -3 2 6 -7 1 -5\n2 1\n5 6\n1 6\n1 4\n8 2\n2 7\n2 5\n8 3\n8 4\n3 7\n7 6\n6 1\n",
            "output": "NO\n"
        },
        {
            "input": "10 12\n5 1 1 8 -8 10 -3 -2 1 7\n5 3\n8 2\n10 9\n4 6\n5 6\n4 5\n5 10\n4 7\n8 4\n3 1\n1 6\n6 10\n",
            "output": "YES\n-4\n1\n1\n11\n-7\n3\n0\n-3\n-3\n5\n0\n6\n"
        },
        {
            "input": "20 40\n-9 -10 -9 15 -3 -5 -17 -10 -6 2 -13 19 10 -15 15 -14 17 0 7 -8\n3 17\n6 18\n15 12\n2 5\n18 3\n16 20\n6 17\n20 10\n10 18\n9 12\n15 3\n6 4\n15 16\n20 6\n20 9\n9 4\n4 8\n14 5\n11 7\n12 11\n3 13\n14 19\n7 17\n16 14\n19 7\n12 13\n14 13\n13 11\n9 14\n13 17\n8 19\n5 20\n2 17\n2 6\n12 5\n8 1\n20 3\n6 2\n5 18\n13 8\n",
            "output": "YES\n-30\n-21\n-23\n-10\n21\n-52\n0\n2\n0\n-9\n0\n16\n38\n0\n42\n0\n-1\n7\n-64\n51\n0\n7\n47\n0\n0\n0\n10\n0\n-39\n0\n0\n0\n0\n0\n0\n-9\n0\n0\n0\n0\n"
        },
        {
            "input": "5 7\n4 1 3 3 -1\n2 4\n5 4\n5 2\n1 5\n1 2\n4 1\n1 3\n",
            "output": "YES\n3\n0\n-2\n1\n0\n0\n3\n"
        },
        {
            "input": "10 12\n5 1 1 8 -8 10 -3 -2 1 7\n5 3\n8 2\n10 9\n4 1\n5 6\n4 5\n5 10\n4 7\n8 4\n3 1\n3 6\n6 10\n",
            "output": "YES\n-10\n1\n1\n5\n-7\n9\n0\n-3\n-3\n0\n11\n6\n"
        },
        {
            "input": "4 3\n-1 0 2 1\n1 4\n2 3\n3 4\n",
            "output": "YES\n-1\n0\n2\n"
        },
        {
            "input": "10 13\n5 4 -3 8 6 1 -5 2 3 -7\n9 5\n9 2\n10 3\n1 4\n3 5\n10 1\n6 10\n10 4\n3 1\n2 7\n1 6\n1 7\n7 8\n",
            "output": "YES\n-8\n11\n-17\n2\n14\n3\n1\n6\n0\n-7\n0\n0\n2\n"
        },
        {
            "input": "10 13\n3 4 -4 8 6 4 -5 1 3 -7\n9 5\n9 2\n10 3\n1 4\n3 5\n9 1\n6 10\n10 4\n3 1\n2 7\n1 6\n1 7\n7 8\n",
            "output": "NO\n"
        },
        {
            "input": "43 52\n-29 -18 -35 21 -12 38 -35 -11 28 -20 27 -5 9 -19 -39 -25 -32 32 -36 28 11 37 1 -25 -22 9 -15 21 25 -39 10 36 -30 -40 22 26 25 -27 -22 -38 -1 18 -13\n33 40\n31 23\n30 26\n21 17\n6 2\n41 19\n32 39\n32 23\n13 14\n25 35\n31 30\n19 32\n25 22\n34 36\n7 40\n23 6\n40 12\n1 3\n23 43\n36 13\n18 33\n17 32\n7 3\n21 34\n41 35\n20 7\n23 1\n41 8\n25 19\n20 29\n42 5\n40 21\n9 37\n17 41\n30 10\n41 18\n39 1\n20 24\n20 4\n42 3\n20 25\n5 16\n31 9\n42 28\n10 11\n19 42\n31 38\n25 2\n31 27\n17 25\n13 15\n31 20\n",
            "output": "NO\n"
        },
        {
            "input": "4 3\n-1 0 2 2\n1 2\n2 3\n3 4\n",
            "output": "NO\n"
        },
        {
            "input": "8 12\n-6 2 -3 2 1 -7 1 -5\n2 1\n5 6\n1 6\n1 4\n8 2\n2 7\n2 5\n8 3\n8 4\n3 7\n7 6\n6 1\n",
            "output": "NO\n"
        },
        {
            "input": "8 12\n-6 2 -3 2 6 -7 2 -5\n2 1\n5 6\n1 6\n1 4\n8 2\n2 7\n2 5\n8 3\n8 4\n3 7\n7 6\n3 1\n",
            "output": "NO\n"
        },
        {
            "input": "10 13\n3 4 -3 8 6 4 -5 2 3 -7\n9 5\n9 2\n10 3\n1 4\n3 5\n9 1\n6 10\n10 4\n3 1\n2 7\n1 6\n1 7\n7 8\n",
            "output": "NO\n"
        },
        {
            "input": "43 52\n-23 -18 -35 21 -12 38 -35 -11 28 -20 27 -5 9 -19 -39 -25 -32 32 -36 28 11 37 1 -25 -22 9 -15 21 25 -39 10 36 -30 0 22 26 25 -27 -22 -38 -1 18 -13\n33 40\n31 23\n30 26\n21 17\n6 2\n41 19\n32 39\n32 23\n13 14\n25 35\n31 30\n19 32\n25 22\n34 36\n7 40\n23 6\n40 12\n1 3\n23 43\n36 13\n18 33\n17 32\n7 3\n21 34\n41 35\n20 7\n23 1\n41 8\n25 19\n20 29\n42 5\n40 21\n9 37\n17 41\n30 10\n41 18\n39 1\n20 24\n20 4\n42 3\n20 25\n5 16\n31 9\n42 28\n10 11\n19 42\n31 38\n25 2\n31 27\n17 25\n13 15\n31 20\n",
            "output": "NO\n"
        },
        {
            "input": "2 1\n2 1\n1 2\n",
            "output": "NO\n"
        },
        {
            "input": "10 13\n3 4 -4 8 6 4 -5 1 5 -7\n9 5\n9 2\n10 3\n1 4\n3 5\n9 1\n6 10\n10 4\n3 1\n2 7\n1 6\n1 7\n7 8\n",
            "output": "NO\n"
        },
        {
            "input": "43 52\n-29 -18 -35 21 -12 38 -35 -11 28 -20 27 -5 9 -19 -39 -25 -32 32 -36 28 11 37 1 -25 -22 9 -15 21 25 -39 10 36 -30 -40 22 26 25 -27 -22 -38 -1 18 -13\n33 40\n31 23\n30 26\n21 17\n6 2\n41 19\n32 39\n32 23\n13 14\n25 35\n31 30\n19 32\n25 22\n34 36\n7 40\n23 6\n40 12\n1 3\n23 43\n36 13\n18 33\n17 32\n7 5\n21 34\n41 35\n20 7\n23 1\n41 8\n25 19\n20 29\n42 5\n40 21\n9 37\n17 41\n30 10\n41 18\n39 1\n20 24\n20 4\n42 3\n20 25\n5 16\n31 9\n42 28\n10 11\n19 42\n31 38\n25 2\n31 27\n17 25\n13 15\n31 20\n",
            "output": "NO\n"
        },
        {
            "input": "10 13\n3 4 0 8 6 4 -5 2 3 -7\n9 5\n9 2\n10 3\n1 4\n3 5\n9 1\n6 10\n10 4\n3 1\n2 7\n1 6\n1 7\n7 8\n",
            "output": "NO\n"
        },
        {
            "input": "43 52\n-29 -18 -35 21 -12 38 -35 -11 28 -20 27 -7 9 -19 -39 -25 -32 32 -36 28 11 37 1 -25 -22 9 -15 21 25 -39 10 36 -30 -40 22 26 25 -27 -22 -38 -1 18 -13\n33 40\n31 23\n30 26\n21 17\n6 2\n41 19\n32 39\n32 23\n13 14\n25 35\n31 30\n19 32\n25 22\n34 36\n7 40\n23 6\n40 12\n1 3\n23 43\n36 13\n18 33\n17 32\n7 5\n21 34\n41 35\n20 7\n23 1\n41 8\n25 19\n20 29\n42 5\n40 21\n9 37\n17 41\n30 10\n41 18\n39 1\n20 24\n20 4\n42 3\n20 25\n5 16\n31 9\n42 28\n10 11\n19 42\n31 38\n25 2\n31 27\n17 25\n13 15\n31 20\n",
            "output": "NO\n"
        },
        {
            "input": "10 13\n3 4 0 0 6 4 -5 2 3 -7\n9 5\n9 2\n10 3\n1 4\n3 5\n9 1\n6 10\n10 4\n3 1\n2 7\n1 6\n1 7\n7 8\n",
            "output": "NO\n"
        },
        {
            "input": "43 52\n-29 -18 -35 21 -12 38 -35 -11 28 -20 27 -7 9 -19 -39 -25 -32 32 -36 28 1 37 1 -25 -22 9 -15 21 25 -39 10 36 -30 -40 22 26 25 -27 -22 -38 -1 18 -13\n33 40\n31 23\n30 26\n21 17\n6 2\n41 19\n32 39\n32 23\n13 14\n25 35\n31 30\n19 32\n25 22\n34 36\n7 40\n23 6\n40 12\n1 3\n23 43\n36 13\n18 33\n17 32\n7 5\n21 34\n41 35\n20 7\n23 1\n41 8\n25 19\n20 29\n42 5\n40 21\n9 37\n17 41\n30 10\n41 18\n39 1\n20 24\n20 4\n42 3\n20 25\n5 16\n31 9\n42 28\n10 11\n19 42\n31 38\n25 2\n31 27\n17 25\n13 15\n31 20\n",
            "output": "NO\n"
        },
        {
            "input": "2 1\n1 0\n2 1\n",
            "output": "NO\n"
        },
        {
            "input": "10 13\n3 4 -3 8 6 4 -5 1 3 -12\n9 5\n9 2\n10 3\n1 4\n3 5\n9 1\n6 10\n10 4\n3 1\n2 7\n1 6\n1 7\n7 8\n",
            "output": "NO\n"
        },
        {
            "input": "10 13\n3 4 -4 8 6 4 -5 1 3 -11\n9 5\n9 2\n10 3\n1 4\n3 5\n9 1\n6 10\n10 4\n3 1\n2 7\n1 6\n1 7\n7 8\n",
            "output": "NO\n"
        },
        {
            "input": "43 52\n-29 -18 -32 21 -12 38 -35 -11 28 -20 27 -5 9 -19 -39 -25 -32 32 -36 28 11 37 1 -25 -22 9 -15 21 25 -39 10 36 -30 -40 22 26 25 -27 -22 -38 -1 18 -13\n33 40\n31 23\n30 26\n21 17\n6 2\n41 19\n32 39\n32 23\n13 14\n25 35\n31 30\n19 32\n25 22\n34 36\n7 40\n23 6\n40 12\n1 3\n23 43\n36 13\n18 33\n17 32\n7 3\n21 34\n41 35\n20 7\n23 1\n41 8\n25 19\n20 29\n42 5\n40 21\n9 37\n17 41\n30 10\n41 18\n39 1\n20 24\n20 4\n42 3\n20 25\n5 16\n31 9\n42 28\n10 11\n19 42\n31 38\n25 2\n31 27\n17 25\n13 15\n31 20\n",
            "output": "NO\n"
        },
        {
            "input": "8 12\n-6 2 -3 1 1 -7 1 -5\n2 1\n5 6\n1 6\n1 4\n8 2\n2 7\n2 5\n8 3\n8 4\n3 7\n7 6\n6 1\n",
            "output": "NO\n"
        },
        {
            "input": "8 12\n-6 2 -3 1 6 -7 2 -5\n2 1\n5 6\n1 6\n1 4\n8 2\n2 7\n2 5\n8 3\n8 4\n3 7\n7 6\n3 1\n",
            "output": "NO\n"
        },
        {
            "input": "10 13\n3 4 -3 8 6 1 -5 2 3 -7\n9 5\n9 2\n10 3\n1 4\n3 5\n9 1\n6 10\n10 4\n3 1\n2 7\n1 6\n1 7\n7 8\n",
            "output": "NO\n"
        },
        {
            "input": "43 52\n-29 -18 -35 21 -12 38 -35 -11 28 -20 27 -5 9 -19 -39 -25 -32 32 -36 28 11 37 1 -25 -22 9 -15 21 25 -39 10 36 -30 -40 22 26 25 -27 -22 -38 -1 18 -13\n33 40\n31 23\n30 26\n21 17\n6 2\n41 19\n32 39\n32 23\n13 14\n25 35\n31 30\n19 32\n25 22\n34 36\n7 40\n23 6\n40 12\n1 3\n23 43\n36 13\n18 33\n17 32\n7 5\n21 34\n41 35\n20 7\n23 1\n41 8\n25 19\n20 29\n42 5\n40 21\n9 37\n17 41\n30 10\n41 18\n39 1\n20 24\n20 4\n42 3\n20 25\n5 16\n31 9\n29 28\n10 11\n19 42\n31 38\n25 2\n31 27\n17 25\n13 15\n31 20\n",
            "output": "NO\n"
        },
        {
            "input": "43 52\n-29 -18 -35 21 -12 38 -35 -11 28 -20 27 -7 9 -19 -39 -25 -32 32 -36 28 11 37 1 -25 -22 9 -15 21 25 -39 10 36 -30 -40 14 26 25 -27 -22 -38 -1 18 -13\n33 40\n31 23\n30 26\n21 17\n6 2\n41 19\n32 39\n32 23\n13 14\n25 35\n31 30\n19 32\n25 22\n34 36\n7 40\n23 6\n40 12\n1 3\n23 43\n36 13\n18 33\n17 32\n7 5\n21 34\n41 35\n20 7\n23 1\n41 8\n25 19\n20 29\n42 5\n40 21\n9 37\n17 41\n30 10\n41 18\n39 1\n20 24\n20 4\n42 3\n20 25\n5 16\n31 9\n42 28\n10 11\n19 42\n31 38\n25 2\n31 27\n17 25\n13 15\n31 20\n",
            "output": "NO\n"
        },
        {
            "input": "10 13\n3 4 0 0 6 4 -5 2 3 -7\n9 5\n9 2\n10 3\n2 4\n3 5\n9 1\n6 10\n10 4\n3 1\n2 7\n1 6\n1 7\n7 8\n",
            "output": "NO\n"
        },
        {
            "input": "43 52\n-29 -18 -35 21 -12 38 -35 -11 28 -20 27 -7 12 -19 -39 -25 -32 32 -36 28 1 37 1 -25 -22 9 -15 21 25 -39 10 36 -30 -40 22 26 25 -27 -22 -38 -1 18 -13\n33 40\n31 23\n30 26\n21 17\n6 2\n41 19\n32 39\n32 23\n13 14\n25 35\n31 30\n19 32\n25 22\n34 36\n7 40\n23 6\n40 12\n1 3\n23 43\n36 13\n18 33\n17 32\n7 5\n21 34\n41 35\n20 7\n23 1\n41 8\n25 19\n20 29\n42 5\n40 21\n9 37\n17 41\n30 10\n41 18\n39 1\n20 24\n20 4\n42 3\n20 25\n5 16\n31 9\n42 28\n10 11\n19 42\n31 38\n25 2\n31 27\n17 25\n13 15\n31 20\n",
            "output": "NO\n"
        },
        {
            "input": "10 13\n3 4 -3 8 9 4 -5 1 3 -12\n9 5\n9 2\n10 3\n1 4\n3 5\n9 1\n6 10\n10 4\n3 1\n2 7\n1 6\n1 7\n7 8\n",
            "output": "NO\n"
        },
        {
            "input": "10 12\n5 1 1 8 -8 10 -3 -2 1 7\n5 3\n8 2\n10 9\n4 1\n5 6\n4 5\n10 10\n4 7\n8 4\n3 1\n3 6\n6 10\n",
            "output": "YES\n-10\n1\n1\n5\n-7\n9\n0\n-3\n-3\n0\n11\n6\n"
        },
        {
            "input": "10 13\n3 4 -4 8 6 4 -5 1 3 -11\n9 5\n9 2\n10 4\n1 4\n3 5\n9 1\n6 10\n10 4\n3 1\n2 7\n1 6\n1 7\n7 8\n",
            "output": "NO\n"
        },
        {
            "input": "10 13\n5 4 -3 8 6 1 -5 2 3 -7\n9 5\n9 2\n10 3\n1 4\n3 5\n9 1\n6 10\n10 4\n3 1\n2 7\n1 6\n1 7\n7 8\n",
            "output": "NO\n"
        },
        {
            "input": "43 52\n-29 -18 -35 21 -12 38 -35 -11 28 -20 27 -7 9 -19 -39 -25 -32 32 -36 28 11 37 1 -25 -22 9 -15 21 25 -39 10 55 -30 -40 14 26 25 -27 -22 -38 -1 18 -13\n33 40\n31 23\n30 26\n21 17\n6 2\n41 19\n32 39\n32 23\n13 14\n25 35\n31 30\n19 32\n25 22\n34 36\n7 40\n23 6\n40 12\n1 3\n23 43\n36 13\n18 33\n17 32\n7 5\n21 34\n41 35\n20 7\n23 1\n41 8\n25 19\n20 29\n42 5\n40 21\n9 37\n17 41\n30 10\n41 18\n39 1\n20 24\n20 4\n42 3\n20 25\n5 16\n31 9\n42 28\n10 11\n19 42\n31 38\n25 2\n31 27\n17 25\n13 15\n31 20\n",
            "output": "NO\n"
        },
        {
            "input": "10 13\n3 4 0 0 6 4 -5 2 3 -7\n9 5\n9 2\n10 3\n2 4\n3 5\n4 1\n6 10\n10 4\n3 1\n2 7\n1 6\n1 7\n7 8\n",
            "output": "NO\n"
        },
        {
            "input": "10 13\n3 4 -3 8 9 4 -5 1 3 -12\n9 5\n9 2\n10 3\n1 4\n3 5\n9 1\n6 10\n10 4\n3 1\n2 7\n1 6\n1 3\n7 8\n",
            "output": "NO\n"
        },
        {
            "input": "10 13\n3 4 -4 8 6 4 -5 0 3 -11\n9 5\n9 2\n10 4\n1 4\n3 5\n9 1\n6 10\n10 4\n3 1\n2 7\n1 6\n1 7\n7 8\n",
            "output": "NO\n"
        },
        {
            "input": "10 13\n3 4 -4 8 6 4 -5 0 3 -11\n9 5\n9 2\n10 4\n1 4\n3 5\n9 1\n7 10\n10 4\n3 1\n2 7\n1 6\n1 7\n7 8\n",
            "output": "NO\n"
        },
        {
            "input": "8 12\n-6 2 -3 2 6 -7 1 -5\n2 1\n5 6\n1 6\n1 4\n8 2\n2 7\n2 5\n8 6\n8 4\n3 7\n7 6\n3 1\n",
            "output": "NO\n"
        },
        {
            "input": "43 52\n-23 -18 -35 21 -12 38 -35 -11 28 -20 27 -5 9 -19 -39 -25 -32 32 -36 28 11 37 1 -25 -22 9 -15 21 25 -39 10 36 -30 -40 22 26 25 -27 -22 -38 -1 18 -13\n33 40\n31 23\n30 26\n21 17\n6 2\n41 19\n32 39\n32 23\n13 14\n25 35\n31 30\n19 32\n25 22\n34 36\n7 40\n23 6\n40 12\n1 3\n23 43\n36 13\n18 33\n17 32\n7 3\n21 34\n41 35\n20 7\n23 1\n41 8\n25 19\n16 29\n42 5\n40 21\n9 37\n17 41\n30 10\n41 18\n39 1\n20 24\n20 4\n42 3\n20 25\n5 16\n31 9\n42 28\n10 11\n19 42\n31 38\n25 2\n31 27\n17 25\n13 15\n31 20\n",
            "output": "NO\n"
        },
        {
            "input": "10 12\n5 1 1 8 -8 10 -3 -2 1 7\n5 3\n8 2\n10 9\n4 6\n5 6\n4 5\n5 10\n4 7\n8 4\n3 1\n2 6\n6 10\n",
            "output": "YES\n-4\n1\n1\n11\n-7\n3\n0\n-3\n-3\n5\n0\n6\n"
        },
        {
            "input": "6 6\n3 5 5 5 1 5\n1 4\n3 2\n4 1\n4 5\n3 5\n5 6\n",
            "output": "NO\n"
        },
        {
            "input": "4 4\n4 4 2 4\n1 2\n2 3\n3 2\n4 1\n",
            "output": "NO\n"
        },
        {
            "input": "4 3\n-1 0 4 1\n1 2\n2 3\n3 4\n",
            "output": "NO\n"
        }
    ]
}