{
    "name": "624_D. Array GCD",
    "source": "CODEFORCES",
    "description": "You are given array ai of length n. You may consecutively apply two operations to this array:\n\n  * remove some subsegment (continuous subsequence) of length m < n and pay for it m\u00b7a coins; \n  * change some elements of the array by at most 1, and pay b coins for each change. \n\n\n\nPlease note that each of operations may be applied at most once (and may be not applied at all) so you can remove only one segment and each number may be changed (increased or decreased) by at most 1. Also note, that you are not allowed to delete the whole array.\n\nYour goal is to calculate the minimum number of coins that you need to spend in order to make the greatest common divisor of the elements of the resulting array be greater than 1.\n\nInput\n\nThe first line of the input contains integers n, a and b (1 \u2264 n \u2264 1 000 000, 0 \u2264 a, b \u2264 109) \u2014 the length of the array, the cost of removing a single element in the first operation and the cost of changing an element, respectively.\n\nThe second line contains n integers ai (2 \u2264 ai \u2264 109) \u2014 elements of the array.\n\nOutput\n\nPrint a single number \u2014 the minimum cost of changes needed to obtain an array, such that the greatest common divisor of all its elements is greater than 1.\n\nExamples\n\nInput\n\n3 1 4\n4 2 3\n\n\nOutput\n\n1\n\n\nInput\n\n5 3 2\n5 17 13 5 6\n\n\nOutput\n\n8\n\n\nInput\n\n8 3 4\n3 7 5 4 3 12 9 4\n\n\nOutput\n\n13\n\nNote\n\nIn the first sample the optimal way is to remove number 3 and pay 1 coin for it.\n\nIn the second sample you need to remove a segment [17, 13] and then decrease number 6. The cost of these changes is equal to 2\u00b73 + 2 = 8 coins.",
    "difficulty": "D",
    "tags": [
        "dp",
        "greedy",
        "number theory"
    ],
    "rating": 2300,
    "public_test": [
        {
            "input": "3 1 4\n4 2 3\n",
            "output": "                                                               1\n"
        },
        {
            "input": "8 3 4\n3 7 5 4 3 12 9 4\n",
            "output": "                                                              13\n"
        },
        {
            "input": "5 3 2\n5 17 13 5 6\n",
            "output": "                                                               8\n"
        }
    ],
    "generated_test": [
        {
            "input": "93 1985 9702\n1711 6269 9689 9119 569 3990 5129 6314 2171 4078 2607 3063 5410 7140 7831 4622 2597 8486 267 3110 1673 5435 8981 6871 4679 8854 5675 39 7227 2533 1782 7833 7029 5919 7792 4192 5856 6020 4735 9772 3145 8757 3853 6371 7217 815 6643 837 3490 1667 2360 983 653 2708 5795 9203 1405 2875 7590 2682 8667 5369 8371 1235 3093 1802 483 2359 677 2044 4556 8403 6419 301 7410 1964 9587 392 1712 1105 7882 3215 5212 1885 1772 4865 1248 7410 9690 6840 7981 8550 4561\n",
            "output": "182620"
        },
        {
            "input": "6 100 1\n4 2 2 2 2 3\n",
            "output": "1"
        },
        {
            "input": "3 2 0\n463 926 925\n",
            "output": "0"
        },
        {
            "input": "4 457 423\n559 559 561 327\n",
            "output": "846"
        },
        {
            "input": "7 735937743 207711841\n43 400 667 521 729 413 878\n",
            "output": "1038559205"
        },
        {
            "input": "2 10 7\n2 5\n",
            "output": "7"
        },
        {
            "input": "7 46 23\n47 17 90 30 53 6 63\n",
            "output": "69"
        },
        {
            "input": "5 4 5\n7 4 7 4 8\n",
            "output": "9"
        },
        {
            "input": "2 965 473\n569 90\n",
            "output": "473"
        },
        {
            "input": "5 2 10\n124 777 133 616 618\n",
            "output": "4"
        },
        {
            "input": "45 393296667 817784089\n513035443 513035443 513035445 513035445 513035443 555648978 463549879 830693049 524420119 541365334 562791911 736173182 644390537 639730339 913702156 807631127 679411095 457747249 554394051 803981524 901463184 651788488 792766018 587562656 564169971 645381787 497940709 886010956 577261234 513035444 513035443 513035443 902522059 513035445 513035444 513035444 513035443 513035443 513035445 513035445 513035443 513035443 513035443 513035443 513035445\n",
            "output": "16911756681"
        },
        {
            "input": "10 8 4\n256 402 803 803 801 226 802 801 401 801\n",
            "output": "24"
        },
        {
            "input": "6 128454855 446458629\n920 204 261 770 485 919\n",
            "output": "513819420"
        },
        {
            "input": "5 10 1\n1300333 1300332 2600666 1300334 2426257\n",
            "output": "2"
        },
        {
            "input": "3 63 850\n764 383 381\n",
            "output": "126"
        },
        {
            "input": "6 4 10\n577 576 883 679 956 864\n",
            "output": "16"
        },
        {
            "input": "13 219 292\n879 798 798 797 328 263 148 931 92 578 262 798 796\n",
            "output": "1095"
        },
        {
            "input": "2 7 5\n5 12\n",
            "output": "5"
        },
        {
            "input": "8 3 4\n3 7 6 4 3 12 9 4\n",
            "output": "11"
        },
        {
            "input": "5 3 2\n5 17 8 5 6\n",
            "output": "6"
        },
        {
            "input": "5 4 5\n7 7 7 4 8\n",
            "output": "8"
        },
        {
            "input": "10 8 4\n39 402 803 803 801 226 802 801 401 801\n",
            "output": "20"
        },
        {
            "input": "3 102 850\n764 383 381\n",
            "output": "204"
        },
        {
            "input": "13 245 292\n879 798 798 797 328 263 148 931 92 578 262 798 796\n",
            "output": "1121"
        },
        {
            "input": "7 735937743 207711841\n43 112 667 674 729 413 878\n",
            "output": "830847364"
        },
        {
            "input": "1 6 2\n12\n",
            "output": "0"
        },
        {
            "input": "1 476059451 601925138\n609\n",
            "output": "0"
        },
        {
            "input": "1 5 10\n99\n",
            "output": "0"
        },
        {
            "input": "5 1 1\n1300333 1300332 2600666 1300334 153728\n",
            "output": "1"
        },
        {
            "input": "2 10 2\n18 13\n",
            "output": "2"
        },
        {
            "input": "1 16 276\n104\n",
            "output": "0"
        },
        {
            "input": "1 334159859 249565919\n92\n",
            "output": "0"
        },
        {
            "input": "93 1985 9702\n1711 6269 9689 9119 569 3990 5129 6314 2171 4078 2607 3063 5410 7140 7831 4622 2597 8486 267 3110 1673 5435 8981 6871 4679 8854 5675 39 7227 2533 1782 7833 7029 5919 7792 4192 5856 6020 4735 9772 3145 8757 3853 6371 7217 815 6643 837 3490 1667 2360 983 653 2708 5795 9203 1405 2875 7590 2682 8667 5369 8371 1235 3093 1802 483 2359 677 2044 1897 8403 6419 301 7410 1964 9587 392 1712 1105 7882 3215 5212 1885 1772 4865 1248 7410 9690 6840 7981 8550 4561\n",
            "output": "182620"
        },
        {
            "input": "6 100 1\n4 3 2 2 2 3\n",
            "output": "2"
        },
        {
            "input": "3 4 0\n463 926 925\n",
            "output": "0"
        },
        {
            "input": "1 6 2\n13\n",
            "output": "0"
        },
        {
            "input": "4 457 423\n559 559 561 135\n",
            "output": "846"
        },
        {
            "input": "7 735937743 207711841\n43 112 667 521 729 413 878\n",
            "output": "1038559205"
        },
        {
            "input": "7 46 23\n47 17 90 30 17 6 63\n",
            "output": "69"
        },
        {
            "input": "2 965 473\n358 90\n",
            "output": "0"
        },
        {
            "input": "5 2 10\n124 1278 133 616 618\n",
            "output": "2"
        },
        {
            "input": "45 393296667 817784089\n513035443 513035443 965106677 513035445 513035443 555648978 463549879 830693049 524420119 541365334 562791911 736173182 644390537 639730339 913702156 807631127 679411095 457747249 554394051 803981524 901463184 651788488 792766018 587562656 564169971 645381787 497940709 886010956 577261234 513035444 513035443 513035443 902522059 513035445 513035444 513035444 513035443 513035443 513035445 513035445 513035443 513035443 513035443 513035443 513035445\n",
            "output": "16911756681"
        },
        {
            "input": "6 128454855 733824005\n920 204 261 770 485 919\n",
            "output": "513819420"
        },
        {
            "input": "5 1 2\n1300333 1300332 2600666 1300334 153728\n",
            "output": "1"
        },
        {
            "input": "5 10 1\n1300333 1300332 2600666 1300334 1554775\n",
            "output": "2"
        },
        {
            "input": "6 4 10\n577 576 883 679 956 863\n",
            "output": "20"
        },
        {
            "input": "2 7 5\n2 12\n",
            "output": "0"
        },
        {
            "input": "8 3 4\n3 7 6 4 3 12 9 8\n",
            "output": "11"
        },
        {
            "input": "93 1985 9702\n1711 6269 9689 9119 569 3990 5129 6314 2171 4078 2607 3063 5410 7140 7831 4622 2597 8486 267 3110 1673 5435 8981 6871 4679 8854 5675 39 7227 2533 1782 7833 7029 5919 7792 4192 5856 6020 4735 9772 3145 8757 3853 6371 7217 815 6643 837 3490 1667 2360 983 653 2708 5795 9203 1405 2875 7590 2682 8667 5369 8371 1235 3093 1802 483 3493 677 2044 1897 8403 6419 301 7410 1964 9587 392 1712 1105 7882 3215 5212 1885 1772 4865 1248 7410 9690 6840 7981 8550 4561\n",
            "output": "182620"
        },
        {
            "input": "1 6 0\n13\n",
            "output": "0"
        },
        {
            "input": "4 457 423\n559 634 561 135\n",
            "output": "846"
        },
        {
            "input": "7 80 23\n47 17 90 30 17 6 63\n",
            "output": "69"
        },
        {
            "input": "5 4 5\n7 7 7 4 10\n",
            "output": "8"
        },
        {
            "input": "2 965 312\n358 90\n",
            "output": "0"
        },
        {
            "input": "5 2 10\n124 1278 133 1052 618\n",
            "output": "2"
        },
        {
            "input": "45 393296667 817784089\n513035443 513035443 965106677 513035445 513035443 555648978 463549879 830693049 524420119 541365334 562791911 736173182 644390537 639730339 913702156 807631127 679411095 457747249 554394051 803981524 901463184 651788488 792766018 587562656 564169971 233597349 497940709 886010956 577261234 513035444 513035443 513035443 902522059 513035445 513035444 513035444 513035443 513035443 513035445 513035445 513035443 513035443 513035443 513035443 513035445\n",
            "output": "16911756681"
        }
    ]
}