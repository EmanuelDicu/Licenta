{
    "name": "436_B. Om Nom and Spiders",
    "source": "CODEFORCES",
    "description": "Om Nom really likes candies and doesn't like spiders as they frequently steal candies. One day Om Nom fancied a walk in a park. Unfortunately, the park has some spiders and Om Nom doesn't want to see them at all.\n\n<image>\n\nThe park can be represented as a rectangular n \u00d7 m field. The park has k spiders, each spider at time 0 is at some cell of the field. The spiders move all the time, and each spider always moves in one of the four directions (left, right, down, up). In a unit of time, a spider crawls from his cell to the side-adjacent cell in the corresponding direction. If there is no cell in the given direction, then the spider leaves the park. The spiders do not interfere with each other as they move. Specifically, one cell can have multiple spiders at the same time.\n\nOm Nom isn't yet sure where to start his walk from but he definitely wants:\n\n  * to start walking at time 0 at an upper row cell of the field (it is guaranteed that the cells in this row do not contain any spiders); \n  * to walk by moving down the field towards the lowest row (the walk ends when Om Nom leaves the boundaries of the park). \n\n\n\nWe know that Om Nom moves by jumping. One jump takes one time unit and transports the little monster from his cell to either a side-adjacent cell on the lower row or outside the park boundaries.\n\nEach time Om Nom lands in a cell he sees all the spiders that have come to that cell at this moment of time. Om Nom wants to choose the optimal cell to start the walk from. That's why he wonders: for each possible starting cell, how many spiders will he see during the walk if he starts from this cell? Help him and calculate the required value for each possible starting cell.\n\nInput\n\nThe first line contains three integers n, m, k (2 \u2264 n, m \u2264 2000; 0 \u2264 k \u2264 m(n - 1)). \n\nEach of the next n lines contains m characters \u2014 the description of the park. The characters in the i-th line describe the i-th row of the park field. If the character in the line equals \".\", that means that the corresponding cell of the field is empty; otherwise, the character in the line will equal one of the four characters: \"L\" (meaning that this cell has a spider at time 0, moving left), \"R\" (a spider moving right), \"U\" (a spider moving up), \"D\" (a spider moving down). \n\nIt is guaranteed that the first row doesn't contain any spiders. It is guaranteed that the description of the field contains no extra characters. It is guaranteed that at time 0 the field contains exactly k spiders.\n\nOutput\n\nPrint m integers: the j-th integer must show the number of spiders Om Nom will see if he starts his walk from the j-th cell of the first row. The cells in any row of the field are numbered from left to right.\n\nExamples\n\nInput\n\n3 3 4\n...\nR.L\nR.U\n\n\nOutput\n\n0 2 2 \n\nInput\n\n2 2 2\n..\nRL\n\n\nOutput\n\n1 1 \n\nInput\n\n2 2 2\n..\nLR\n\n\nOutput\n\n0 0 \n\nInput\n\n3 4 8\n....\nRRLL\nUUUU\n\n\nOutput\n\n1 3 3 1 \n\nInput\n\n2 2 2\n..\nUU\n\n\nOutput\n\n0 0 \n\nNote\n\nConsider the first sample. The notes below show how the spider arrangement changes on the field over time:\n    \n    \n      \n    ...        ...        ..U       ...  \n    R.L   ->   .*U   ->   L.R   ->  ...  \n    R.U        .R.        ..R       ...  \n      \n    \n\nCharacter \"*\" represents a cell that contains two spiders at the same time.\n\n  * If Om Nom starts from the first cell of the first row, he won't see any spiders. \n  * If he starts from the second cell, he will see two spiders at time 1. \n  * If he starts from the third cell, he will see two spiders: one at time 1, the other one at time 2. ",
    "difficulty": "B",
    "tags": [
        "implementation",
        "math"
    ],
    "rating": 1400,
    "public_test": [
        {
            "input": "2 2 2\n..\nRL\n",
            "output": "1 1 "
        },
        {
            "input": "3 3 4\n...\nR.L\nR.U\n",
            "output": "0 2 2 "
        },
        {
            "input": "2 2 2\n..\nUU\n",
            "output": "0 0 "
        },
        {
            "input": "3 4 8\n....\nRRLL\nUUUU\n",
            "output": "1 3 3 1 "
        },
        {
            "input": "2 2 2\n..\nLR\n",
            "output": "0 0 "
        }
    ],
    "generated_test": [
        {
            "input": "3 7 26\n.......\nLDUDLLD\nDLRDDLD\n",
            "output": "0 0 0 2 2 0 0\n"
        },
        {
            "input": "4 5 15\n.....\nDRRLR\nULDLD\nDLRQL\n",
            "output": "1 2 2 1 0\n"
        },
        {
            "input": "9 8 30\n........\n.L.LDRR.\nD.LDLR.U\n..RL.L..\nUR.UL...\n.D.....L\nR..UDULL\n........\nDD.U...D\n........\n",
            "output": "6 1 4 3 0 3 2 3\n"
        },
        {
            "input": "8 9 34\n.........\n.R.LDR.D.\n....UULU.\nR.D..DL.L\n.R..DLUDU\nR........\n.URU...UU\n.....D.L.\n",
            "output": "1 2 2 3 2 4 2 2 3\n"
        },
        {
            "input": "10 10 47\n..........\n.R.LML.R.L\nR.ULUL.RUL\nRD..RL.L..\nRU.D....LU\n..RRR..DL.\n.DRUUD.ULD\n...D...LDD\n...UUU.U..\nR.....D...\n",
            "output": "1 2 6 5 7 1 0 5 5 4\n"
        },
        {
            "input": "100 2 45\n..\n.D\nU.\n..\nU.\n..\n..\n..\nU.\n..\n..\nD.\nU.\n..\n..\n.D\nDU\n..\nUD\n..\n..\n..\n..\n..\n..\nD.\n.U\n..\n..\nD.\nU.\n..\n..\n..\nU.\n..\n..\n.D\n..\n..\n.D\n..\n..\n.D\n.U\nD.\n..\n.D\n..\n..\nUD\n..\nU.\n..\nU.\n..\nUD\n..\nU.\n..\nU.\n..\n..\n..\nU.\n..\n..\nD.\n..\n..\nU.\n..\nU.\n..\nUU\n..\nU.\n..\nU.\n..\n..\n..\n..\n..\n..\n..\n..\n..\n.D\n..\n..\nD.\nU.\n.D\n..\n..\nU.\n.D\nU.\n..\n",
            "output": "22 4\n"
        },
        {
            "input": "5 5 10\n.....\nRU.D.\n..DLL\n.D...\nL..LR\n",
            "output": "0 2 1 0 0\n"
        },
        {
            "input": "2 2 1\n..\nUU\n",
            "output": "0 0\n"
        },
        {
            "input": "3 7 26\n.......\nUDLDLLD\nDLRDDLD\n",
            "output": "0 1 0 2 2 0 0\n"
        },
        {
            "input": "4 5 15\n.....\nDRRLR\nDLDLU\nDLRQL\n",
            "output": "0 2 2 1 1\n"
        },
        {
            "input": "9 8 30\n........\n.L.LDRR.\nD.LDLR.U\n..RL.L..\nUR.UL...\n.D.....K\nR..UDULL\n........\nDD.U...D\n........\n",
            "output": "6 1 3 3 0 3 2 3\n"
        },
        {
            "input": "10 10 47\n..........\n.R.LML.R.L\nR.ULUL.RUL\nRD..RL.L..\nRU.D....LU\n.LD..RRR..\n.DRUUD.ULD\n...D...LDD\n...UUU.U..\nR.....D...\n",
            "output": "1 2 6 4 7 1 0 4 4 3\n"
        },
        {
            "input": "4 5 15\n.....\nDRSLR\nDLDLU\nDLRQL\n",
            "output": "0 2 2 0 1\n"
        },
        {
            "input": "10 10 47\n..........\n.R.LML.R.L\nR.LLUU.RUL\nRD..RL.L..\nRU.D....LU\n.LD..RRR..\n.DRUUD.ULD\n...D...LDD\n...UUU.U..\nR.....D...\n",
            "output": "2 2 5 3 7 2 0 4 4 3\n"
        },
        {
            "input": "9 8 30\n........\n.L.LDRR.\nU.RLDL.D\n..RL/L..\nUR.UL...\n.D.....K\nR..UDULL\n........\nDD.U...D\n........\n",
            "output": "6 2 2 4 1 3 2 1\n"
        },
        {
            "input": "4 5 15\n.....\nDRSLR\nDLDLU\nLRRDL\n",
            "output": "0 2 2 0 2\n"
        },
        {
            "input": "6 8 28\n........\n.L.LDRR.\nU.RLDL.D\n.-RL.L..\nUR.UL...\n.D.....K\nR..UDULL\n........\nDD.U...D\n........\n",
            "output": "5 1 2 2 1 2 1 1\n"
        },
        {
            "input": "4 5 15\n.....\nDRRLR\nULDLD\nLRRLD\n",
            "output": "2 1 2 1 1\n"
        },
        {
            "input": "10 8 30\n........\n.L.LDRR.\nD.LDLR.U\n..RL.L..\nUR.UL...\n.D.....L\nR..UDULL\n........\nUD.D...D\n........\n",
            "output": "7 1 4 2 0 3 2 3\n"
        },
        {
            "input": "5 7 19\n.......\nRDLLLRL\nUUR..U.\n.D/DLLL\n..R..UU\n",
            "output": "1 4 2 2 1 3 3\n"
        },
        {
            "input": "8 9 28\n.........\n.R.LDR.D.\n....UULU.\nR.D..DL.L\nUDULD..R.\nR........\n.URU...UU\n.....D.L.\n",
            "output": "2 1 3 3 2 3 1 2 2\n"
        },
        {
            "input": "10 10 0\n..........\n.R.LLL.R.L\nR.ULUL.RUL\nRD..RL.L..\nRU.D....LU\n..RRR..DL.\n.DRUUD.ULD\n...D...LDD\n...UUU.U..\nR.....D...\n",
            "output": "1 2 6 6 7 1 0 5 5 4\n"
        },
        {
            "input": "100 2 45\n..\n.D\nU.\n..\nU.\n..\n..\n..\nU.\n..\n..\nD.\nU.\n.-\n..\n.D\nDU\n..\nUD\n..\n..\n..\n..\n..\n..\nD.\nU.\n..\n..\nD.\nU.\n..\n..\n..\nU.\n..\n..\n.D\n..\n..\n.D\n..\n..\n.D\n.U\nD.\n..\n.D\n..\n..\nUD\n..\nU.\n..\nU.\n..\nUD\n..\nU.\n..\nU.\n..\n..\n..\nU.\n..\n..\nD.\n..\n..\nU.\n..\nU.\n..\nUU\n..\nU.\n..\nU.\n..\n..\n..\n..\n..\n..\n..\n..\n..\n.D\n..\n..\nD.\nU.\n.D\n..\n..\nU.\n.D\nU.\n..\n",
            "output": "23 3\n"
        },
        {
            "input": "2 100 59\n....................................................................................................\n.R.LL.D...DR..D.L.....DLRD.RL.RL....LD.DL.R..D.L.LLRR.DLRD...R.RLL.RRDL.DLDRRRDL.L..RRDL.RLLD..D.RD.\n",
            "output": "0 0 2 1 0 0 0 0 0 0 0 0 1 0 0 1 0 0 0 0 0 0 1 0 0 1 0 1 1 0 1 1 0 0 0 1 0 0 0 1 0 0 0 1 0 0 1 0 1 1 0 0 1 1 1 0 0 1 0 0 0 0 1 1 2 0 0 0 1 2 0 0 1 0 0 0 1 1 2 0 1 0 0 0 0 1 2 0 0 1 2 0 0 0 0 0 0 0 1 0\n"
        },
        {
            "input": "2 2 1\n..\nRL\n",
            "output": "1 1\n"
        },
        {
            "input": "3 4 8\n....\nLLRR\nUUUU\n",
            "output": "2 1 1 2\n"
        },
        {
            "input": "4 5 15\n.....\nDRRLR\nUDLLD\nDLRQL\n",
            "output": "2 2 2 1 0\n"
        },
        {
            "input": "100 2 45\n..\n.D\nU.\n..\nU.\n..\n..\n..\nU.\n..\n..\nD.\nU.\n..\n..\n.D\nDU\n..\nUD\n..\n..\n..\n..\n..\n..\nD.\n.U\n..\n..\nD.\nU.\n..\n..\n..\nU.\n..\n..\n.D\n..\n..\n.D\n..\n..\n.D\n.U\nD.\n..\n.D\n..\n..\nDU\n..\nU.\n..\nU.\n..\nUD\n..\nU.\n..\nU.\n..\n..\n..\nU.\n..\n..\nD.\n..\n..\nU.\n..\nU.\n..\nUU\n..\nU.\n..\nU.\n..\n..\n..\n..\n..\n..\n..\n..\n..\n.D\n..\n..\nD.\nU.\n.D\n..\n..\nU.\n.D\nU.\n..\n",
            "output": "21 5\n"
        },
        {
            "input": "5 5 0\n.....\nRU.D.\n..DLL\n.D...\nRL..L\n",
            "output": "1 2 1 0 1\n"
        },
        {
            "input": "2 7 26\n.......\nUDLDLLD\nDLRDDLD\n",
            "output": "0 1 0 1 1 0 0\n"
        },
        {
            "input": "9 8 30\n........\n.L.LDRR.\nD.LDLR.U\n..L/LR..\nUR.UL...\n.D.....K\nR..UDULL\n........\nDD.U...D\n........\n",
            "output": "5 2 2 3 0 2 2 3\n"
        },
        {
            "input": "10 10 47\n..........\n.R.LML.R.L\nR.LLUU.RUL\n..L.LR..DR\nRU.D....LU\n.LD..RRR..\n.DRUUD.ULD\n...D...LDD\n...UUU.U..\nR.....C...\n",
            "output": "2 3 4 2 6 2 0 3 5 3\n"
        },
        {
            "input": "4 5 15\n.....\nDRSLR\nULDLD\nLRRDL\n",
            "output": "1 2 2 0 1\n"
        },
        {
            "input": "100 2 45\n..\n.D\nU.\n..\nU.\n..\n..\n..\nU.\n..\n..\nD.\nU.\n..\n..\n.D\nDU\n..\nUD\n..\n..\n..\n..\n..\n..\nD.\n.U\n..\n..\nD.\nU.\n..\n..\n..\nU.\n..\n..\n.D\n..\n..\n.D\n..\n..\n.D\n.U\nD.\n..\n.E\n..\n..\nUD\n..\nU.\n..\nU.\n..\nUD\n..\nU.\n..\nU.\n..\n..\n..\nU.\n..\n..\nD.\n..\n..\nU.\n..\nU.\n..\nUU\n..\nU.\n..\nU.\n..\n..\n..\n..\n..\n..\n..\n..\n..\n.D\n..\n..\nD.\nU.\n.D\n..\n..\nU.\n.D\nU.\n..\n",
            "output": "22 4\n"
        },
        {
            "input": "2 2 1\n..\nUV\n",
            "output": "0 0\n"
        },
        {
            "input": "9 8 30\n........\n.L.LDRR.\nD.LDLR.U\n..RL/L..\nUR.UL...\n.D.....K\nR..UDULL\n........\nDD.U...D\n........\n",
            "output": "6 1 3 3 0 3 2 3\n"
        },
        {
            "input": "100 2 45\n..\n.D\nU.\n..\nU.\n..\n..\n..\nU.\n..\n..\nD.\nU.\n..\n..\n.D\nDU\n..\nUD\n..\n..\n..\n..\n..\n..\nD.\n.U\n..\n..\nD.\nU.\n..\n..\n..\nU.\n..\n..\n.D\n..\n..\n.D\n..\n..\n.D\n.U\nD.\n..\n.E\n..\n..\nUD\n..\nU.\n..\nU.\n..\nUD\n..\nU.\n..\nU.\n..\n..\n..\nU.\n.-\n..\nD.\n..\n..\nU.\n..\nU.\n..\nUU\n..\nU.\n..\nU.\n..\n..\n..\n..\n..\n..\n..\n..\n..\n.D\n..\n..\nD.\nU.\n.D\n..\n..\nU.\n.D\nU.\n..\n",
            "output": "22 4\n"
        },
        {
            "input": "4 5 15\n.....\nDRSLR\nDLDLU\nLDRQL\n",
            "output": "0 2 2 0 1\n"
        },
        {
            "input": "10 10 47\n..........\n.R.LML.R.L\nR.LLUU.RUL\nRD..RL.L..\nRU.D....LU\n.LD..RRR..\n.DRUUD.ULD\n...D...LDD\n...UUU.U..\nR.....C...\n",
            "output": "2 2 5 3 7 2 0 4 4 3\n"
        },
        {
            "input": "100 2 45\n..\n.D\nU.\n..\nU.\n..\n..\n..\nU.\n..\n..\nD.\nU.\n..\n..\n.D\nDU\n..\nUD\n..\n..\n..\n..\n..\n..\nD.\n.U\n..\n..\nD.\nU.\n..\n..\n..\nU.\n..\n..\n.D\n..\n..\n.D\n..\n..\n.D\n.U\nD.\n..\n.E\n..\n..\nUD\n..\nU.\n..\nU.\n..\nUD\n..\nU.\n./\nU.\n..\n..\n..\nU.\n.-\n..\nD.\n..\n..\nU.\n..\nU.\n..\nUU\n..\nU.\n..\nU.\n..\n..\n..\n..\n..\n..\n..\n..\n..\n.D\n..\n..\nD.\nU.\n.D\n..\n..\nU.\n.D\nU.\n..\n",
            "output": "22 4\n"
        },
        {
            "input": "4 5 15\n.....\nDRSLR\nDLDLU\nLQRDL\n",
            "output": "0 2 2 0 1\n"
        },
        {
            "input": "9 8 30\n........\n.L.LDRR.\nU.RLDL.D\n..RL.L..\nUR.UL...\n.D.....K\nR..UDULL\n........\nDD.U...D\n........\n",
            "output": "6 2 2 4 1 3 2 1\n"
        },
        {
            "input": "9 8 28\n........\n.L.LDRR.\nU.RLDL.D\n..RL.L..\nUR.UL...\n.D.....K\nR..UDULL\n........\nDD.U...D\n........\n",
            "output": "6 2 2 4 1 3 2 1\n"
        },
        {
            "input": "9 8 28\n........\n.L.LDRR.\nU.RLDL.D\n.-RL.L..\nUR.UL...\n.D.....K\nR..UDULL\n........\nDD.U...D\n........\n",
            "output": "6 2 2 4 1 3 2 1\n"
        },
        {
            "input": "9 8 30\n........\n.L-LDRR.\nD.LDLR.U\n..RL.L..\nUR.UL...\n.D.....K\nR..UDULL\n........\nDD.U...D\n........\n",
            "output": "6 1 3 3 0 3 2 3\n"
        },
        {
            "input": "100 2 45\n..\n.D\nU.\n..\nU.\n..\n..\n..\nU.\n..\n..\nD.\nU.\n..\n..\n.C\nDU\n..\nUD\n..\n..\n..\n..\n..\n..\nD.\n.U\n..\n..\nD.\nU.\n..\n..\n..\nU.\n..\n..\n.D\n..\n..\n.D\n..\n..\n.D\n.U\nD.\n..\n.E\n..\n..\nUD\n..\nU.\n..\nU.\n..\nUD\n..\nU.\n..\nU.\n..\n..\n..\nU.\n..\n..\nD.\n..\n..\nU.\n..\nU.\n..\nUU\n..\nU.\n..\nU.\n..\n..\n..\n..\n..\n..\n..\n..\n..\n.D\n..\n..\nD.\nU.\n.D\n..\n..\nU.\n.D\nU.\n..\n",
            "output": "22 4\n"
        },
        {
            "input": "100 2 45\n..\n.D\nU.\n..\nU.\n..\n..\n..\nU.\n..\n..\nD.\nU.\n..\n..\nD.\nDU\n..\nUD\n..\n..\n..\n..\n..\n..\nD.\n.U\n..\n..\nD.\nU.\n..\n..\n..\nU.\n..\n..\n.D\n..\n..\n.D\n..\n..\n.D\n.U\nD.\n..\n.E\n..\n..\nUD\n..\nU.\n..\nU.\n..\nUD\n..\nU.\n..\nU.\n..\n..\n..\nU.\n.-\n..\nD.\n..\n..\nU.\n..\nU.\n..\nUU\n..\nU.\n..\nU.\n..\n..\n..\n..\n..\n..\n..\n..\n..\n.D\n..\n..\nD.\nU.\n.D\n..\n..\nU.\n.D\nU.\n..\n",
            "output": "22 4\n"
        },
        {
            "input": "4 5 15\n.....\nDRSLR\nDLDLU\nMDRQL\n",
            "output": "0 2 2 0 1\n"
        },
        {
            "input": "100 2 45\n..\n.D\nU.\n..\nU.\n..\n..\n..\nU.\n..\n..\nD.\nU.\n..\n..\n.D\nDU\n..\nUD\n..\n..\n..\n..\n..\n..\nD.\n.U\n..\n..\nD.\nU.\n..\n..\n..\nU.\n..\n..\n.D\n..\n..\n.D\n..\n..\n.D\n.U\nD.\n..\n.E\n..\n..\nUD\n..\nU.\n..\nU.\n..\nUD\n..\nU.\n./\nU.\n..\n..\n..\nU.\n--\n..\nD.\n..\n..\nU.\n..\nU.\n..\nUU\n..\nU.\n..\nU.\n..\n..\n..\n..\n..\n..\n..\n..\n..\n.D\n..\n..\nD.\nU.\n.D\n..\n..\nU.\n.D\nU.\n..\n",
            "output": "22 4\n"
        },
        {
            "input": "4 5 15\n.....\nDRRLR\nDLDLU\nLQRDL\n",
            "output": "0 2 2 1 1\n"
        }
    ]
}