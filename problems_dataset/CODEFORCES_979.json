{
    "name": "979_E. Kuro and Topological Parity",
    "source": "CODEFORCES",
    "description": "Kuro has recently won the \"Most intelligent cat ever\" contest. The three friends then decided to go to Katie's home to celebrate Kuro's winning. After a big meal, they took a small break then started playing games.\n\nKuro challenged Katie to create a game with only a white paper, a pencil, a pair of scissors and a lot of arrows (you can assume that the number of arrows is infinite). Immediately, Katie came up with the game called Topological Parity.\n\nThe paper is divided into n pieces enumerated from 1 to n. Shiro has painted some pieces with some color. Specifically, the i-th piece has color c_{i} where c_{i} = 0 defines black color, c_{i} = 1 defines white color and c_{i} = -1 means that the piece hasn't been colored yet.\n\nThe rules of the game is simple. Players must put some arrows between some pairs of different pieces in such a way that for each arrow, the number in the piece it starts from is less than the number of the piece it ends at. Also, two different pieces can only be connected by at most one arrow. After that the players must choose the color (0 or 1) for each of the unpainted pieces. The score of a valid way of putting the arrows and coloring pieces is defined as the number of paths of pieces of alternating colors. For example, [1 \u2192 0 \u2192 1 \u2192 0], [0 \u2192 1 \u2192 0 \u2192 1], [1], [0] are valid paths and will be counted. You can only travel from piece x to piece y if and only if there is an arrow from x to y.\n\nBut Kuro is not fun yet. He loves parity. Let's call his favorite parity p where p = 0 stands for \"even\" and p = 1 stands for \"odd\". He wants to put the arrows and choose colors in such a way that the score has the parity of p.\n\nIt seems like there will be so many ways which satisfy Kuro. He wants to count the number of them but this could be a very large number. Let's help him with his problem, but print it modulo 10^{9} + 7.\n\nInput\n\nThe first line contains two integers n and p (1 \u2264 n \u2264 50, 0 \u2264 p \u2264 1) \u2014 the number of pieces and Kuro's wanted parity.\n\nThe second line contains n integers c_{1}, c_{2}, ..., c_{n} (-1 \u2264 c_{i} \u2264 1) \u2014 the colors of the pieces.\n\nOutput\n\nPrint a single integer \u2014 the number of ways to put the arrows and choose colors so the number of valid paths of alternating colors has the parity of p.\n\nExamples\n\nInput\n\n3 1\n-1 0 1\n\n\nOutput\n\n6\n\nInput\n\n2 1\n1 0\n\n\nOutput\n\n1\n\nInput\n\n1 1\n-1\n\n\nOutput\n\n2\n\nNote\n\nIn the first example, there are 6 ways to color the pieces and add the arrows, as are shown in the figure below. The scores are 3, 3, 5 for the first row and 5, 3, 3 for the second row, both from left to right.\n\n<image>",
    "difficulty": "E",
    "tags": [
        "dp"
    ],
    "rating": 2400,
    "public_test": [
        {
            "input": "3 1\n-1 0 1\n",
            "output": "6\n"
        },
        {
            "input": "2 1\n1 0\n",
            "output": "1\n"
        },
        {
            "input": "1 1\n-1\n",
            "output": "2\n"
        }
    ],
    "generated_test": [
        {
            "input": "9 0\n0 1 -1 -1 -1 -1 1 1 1\n",
            "output": "755810045\n"
        },
        {
            "input": "37 0\n0 -1 0 0 0 -1 0 1 -1 0 -1 0 -1 -1 0 1 1 0 -1 -1 -1 -1 1 -1 0 0 0 1 -1 -1 1 -1 1 1 -1 -1 -1\n",
            "output": "856019167\n"
        },
        {
            "input": "10 0\n1 0 0 1 1 -1 -1 0 1 0\n",
            "output": "743685088\n"
        },
        {
            "input": "41 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 -1 0 0\n",
            "output": "681095711\n"
        },
        {
            "input": "2 0\n1 -1 1 0\n",
            "output": "3\n"
        },
        {
            "input": "26 1\n1 -1 1 1 1 1 -1 1 -1 1 0 -1 0 -1 -1 -1 1 0 -1 -1 0 1 -1 0 1 0\n",
            "output": "498381559\n"
        },
        {
            "input": "34 0\n1 1 1 0 0 0 0 1 0 0 1 -1 0 1 -1 0 -1 1 1 1 0 1 1 -1 0 0 1 -1 -1 0 0 0 -1 -1\n",
            "output": "194552344\n"
        },
        {
            "input": "5 0\n-1 0 -1 0 1\n",
            "output": "1984\n"
        },
        {
            "input": "32 1\n0 0 1 0 -1 0 1 -1 -1 -1 0 1 0 0 1 0 -1 -1 1 1 1 0 -1 1 -1 -1 1 0 0 -1 0 1\n",
            "output": "495456140\n"
        },
        {
            "input": "17 0\n0 -1 -1 0 1 -1 0 -1 -1 -1 0 -1 -1 -1 0 0 0\n",
            "output": "640731229\n"
        },
        {
            "input": "7 0\n1 0 -1 1 -1 1 1\n",
            "output": "4325376\n"
        },
        {
            "input": "20 1\n1 -1 1 -1 -1 -1 0 1 1 0 1 0 -1 1 1 -1 1 0 1 1\n",
            "output": "189946716\n"
        },
        {
            "input": "2 0\n0 0 0\n",
            "output": "2\n"
        },
        {
            "input": "18 1\n1 1 1 -1 0 -1 -1 0 -1 -1 0 0 -1 0 -1 0 -1 1\n",
            "output": "870483021\n"
        },
        {
            "input": "30 0\n1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1\n",
            "output": "387447621\n"
        },
        {
            "input": "50 1\n-1 -1 -1 -1 -1 0 -1 -1 -1 0 1 0 -1 0 1 -1 -1 -1 1 0 1 -1 0 1 0 1 0 0 0 1 -1 1 -1 -1 1 1 -1 -1 0 -1 -1 1 -1 1 -1 1 1 0 0 -1\n",
            "output": "260843480\n"
        },
        {
            "input": "5 1\n0 1 0 0 -1\n",
            "output": "768\n"
        },
        {
            "input": "4 1\n0 0 1 1 -1 1 -1 1 0 -1 -1 -1 0 -1 0 -1 1 0 -1 1 0 -1 -1 0 -1 1 1 -1\n",
            "output": "32\n"
        },
        {
            "input": "24 1\n0 0 0 1 1 -1 -1 0 -1 1 -1 -1 0 0 1 1 0 -1 0 0 0 0 1 1\n",
            "output": "378294608\n"
        },
        {
            "input": "9 1\n-1 -1 0 1 1 -1 -1 0 1\n",
            "output": "829551862\n"
        },
        {
            "input": "5 0\n0 -1 0 0 -1\n",
            "output": "1792\n"
        },
        {
            "input": "30 0\n1 0 1 1 0 -1 0 1 -1 -1 1 -1 0 -1 1 1 -1 1 0 1 0 -1 1 1 0 1 -1 0 1 1\n",
            "output": "519096932\n"
        },
        {
            "input": "1 0\n0\n",
            "output": "0\n"
        },
        {
            "input": "6 1\n0 -1 -1 0 0 -1\n",
            "output": "126976\n"
        },
        {
            "input": "38 0\n-1 -1 1 1 -1 -1 1 -1 0 1 -1 1 1 1 -1 1 0 1 -1 -1 1 -1 -1 0 0 1 -1 -1 0 -1 0 -1 -1 0 1 0 -1 0\n",
            "output": "388948587\n"
        },
        {
            "input": "27 1\n-1 0 -1 -1 -1 0 1 -1 1 0 0 -1 -1 1 0 0 0 -1 -1 1 -1 -1 -1 0 1 0 0\n",
            "output": "617291392\n"
        },
        {
            "input": "46 0\n1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1\n",
            "output": "120108192\n"
        },
        {
            "input": "31 1\n-1 1 1 1 0 -1 -1 1 1 -1 1 1 1 0 0 -1 1 0 1 -1 -1 1 0 1 1 0 1 0 0 -1 -1 1 -1 1 1 1 1 0 -1 0\n",
            "output": "140063906\n"
        },
        {
            "input": "4 1\n0 1 0 -1\n",
            "output": "80\n"
        },
        {
            "input": "3 1\n1 -1 -1\n",
            "output": "18\n"
        },
        {
            "input": "38 1\n1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1\n",
            "output": "84306913\n"
        },
        {
            "input": "5 1\n1 1 0 -1 -1 -1\n",
            "output": "1920\n"
        },
        {
            "input": "25 1\n1 0 0 -1 -1 0 1 0 -1 1 0 0 0 -1 0 0 1 -1 -1 0 -1 -1 -1 1 1\n",
            "output": "634141034\n"
        },
        {
            "input": "21 0\n0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0\n",
            "output": "573812615\n"
        },
        {
            "input": "14 1\n-1 0 -1 1 -1 0 0 0 -1 -1 0 -1 0 0\n",
            "output": "819781395\n"
        },
        {
            "input": "8 0\n0 0 1 -1 1 -1 1 1\n",
            "output": "536870912\n"
        },
        {
            "input": "2 1\n-1 1\n",
            "output": "1\n"
        },
        {
            "input": "29 1\n0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n",
            "output": "183480587\n"
        },
        {
            "input": "13 1\n-1 1 0 0 0 0 -1 1 -1 -1 1 1 0\n",
            "output": "263298526\n"
        },
        {
            "input": "48 1\n1 0 0 0 1 -1 1 1 1 -1 0 -1 1 1 0 -1 -1 -1 0 0 0 1 0 1 0 -1 -1 -1 -1 1 0 1 -1 -1 -1 1 -1 0 1 0 0 1 -1 0 -1 0 0 0\n",
            "output": "763606955\n"
        },
        {
            "input": "37 1\n1 -1 1 -1 -1 -1 0 1 -1 -1 1 0 0 0 1 0 -1 0 -1 1 -1 0 1 -1 -1 -1 -1 -1 0 -1 0 0 -1 0 -1 -1 -1\n",
            "output": "228356749\n"
        },
        {
            "input": "47 1\n0 -1 0 1 1 -1 1 -1 1 -1 1 -1 0 0 -1 0 -1 1 -1 -1 0 1 -1 1 0 0 1 -1 0 1 0 1 0 1 0 1 -1 -1 1 -1 -1 -1 0 1 1 0 1\n",
            "output": "716651774\n"
        },
        {
            "input": "36 1\n-1 0 -1 -1 1 0 0 -1 1 0 0 -1 1 -1 1 0 1 -1 0 0 1 1 1 0 1 1 0 -1 1 -1 0 0 0 1 1 -1\n",
            "output": "155907746\n"
        },
        {
            "input": "3 1\n-1 1 1\n",
            "output": "12\n"
        },
        {
            "input": "9 0\n0 1 -1 -1 0 -1 1 1 1\n",
            "output": "877905026\n"
        },
        {
            "input": "37 0\n0 -1 0 0 0 -1 0 1 -1 0 -1 0 -1 -1 0 1 1 0 -1 -1 -1 -1 1 -1 0 0 0 1 -1 -1 1 0 1 1 -1 -1 -1\n",
            "output": "915368288\n"
        },
        {
            "input": "41 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 -1 0 0\n",
            "output": "521643563\n"
        },
        {
            "input": "34 0\n1 1 1 1 0 0 0 1 0 0 1 -1 0 1 -1 0 -1 1 1 1 0 1 1 -1 0 0 1 -1 -1 0 0 0 -1 -1\n",
            "output": "115086916\n"
        },
        {
            "input": "5 1\n-1 0 -1 0 1\n",
            "output": "2112\n"
        },
        {
            "input": "32 1\n0 0 1 0 -1 0 1 -1 -1 -1 0 1 -1 0 1 0 -1 -1 1 1 1 0 -1 1 -1 -1 1 0 0 -1 0 1\n",
            "output": "990912280\n"
        },
        {
            "input": "17 0\n0 -1 -1 0 1 -1 -1 -1 -1 -1 0 -1 -1 -1 0 0 0\n",
            "output": "791531403\n"
        },
        {
            "input": "18 1\n1 1 1 -1 0 -1 -1 0 -1 -1 0 -1 -1 0 -1 0 -1 1\n",
            "output": "771314966\n"
        },
        {
            "input": "5 0\n0 -1 1 0 -1\n",
            "output": "2176\n"
        },
        {
            "input": "30 0\n1 0 0 1 0 -1 0 1 -1 -1 1 -1 0 -1 1 1 -1 1 0 1 0 -1 1 1 0 1 -1 0 1 1\n",
            "output": "300222383\n"
        },
        {
            "input": "6 1\n0 -1 -1 1 0 -1\n",
            "output": "133120\n"
        },
        {
            "input": "50 1\n-1 -1 1 0 1 1 0 -1 1 0 -1 -1 0 -1 -1 -1 0 1 1 -1 1 0 -1 1 1 -1 -1 -1 1 -1 -1 0 -1 0 -1 0 1 -1 -1 0 1 -1 0 1 -1 1 0 -1 -1 1\n",
            "output": "606627495\n"
        },
        {
            "input": "46 0\n1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1\n",
            "output": "300270480\n"
        },
        {
            "input": "50 1\n-1 -1 1 0 1 1 0 -1 1 0 -1 -1 0 -1 -1 -1 0 1 1 -1 1 0 -1 1 1 -1 -1 -1 1 -1 -1 0 -1 0 -1 0 0 -1 -1 0 1 -1 0 1 -1 1 0 -1 -1 1\n",
            "output": "260843480\n"
        },
        {
            "input": "2 1\n-1 0\n",
            "output": "1\n"
        },
        {
            "input": "10 0\n1 0 1 1 1 -1 -1 0 1 0\n",
            "output": "743685088\n"
        },
        {
            "input": "2 0\n1 -1 2 0\n",
            "output": "3\n"
        },
        {
            "input": "2 0\n1 0 0\n",
            "output": "1\n"
        },
        {
            "input": "4 1\n0 0 1 1 -1 1 -1 1 0 -1 -1 -1 0 -1 0 -1 1 0 -1 1 0 -1 0 0 -1 1 1 -1\n",
            "output": "32\n"
        },
        {
            "input": "24 1\n0 0 1 1 1 -1 -1 0 -1 1 -1 -1 0 0 1 1 0 -1 0 0 0 0 1 1\n",
            "output": "378294608\n"
        },
        {
            "input": "1 0\n1\n",
            "output": "0\n"
        },
        {
            "input": "31 1\n-1 1 1 1 0 -1 -1 1 1 -1 1 1 1 0 0 -1 1 0 1 -1 -1 1 0 1 1 0 1 0 0 -1 -1 1 -1 0 1 1 1 0 -1 0\n",
            "output": "140063906\n"
        }
    ]
}